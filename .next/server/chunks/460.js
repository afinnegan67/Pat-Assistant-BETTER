exports.id=460,exports.ids=[460],exports.modules={2311:e=>{"use strict";var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i={};((e,r)=>{for(var a in r)t(e,a,{get:r[a],enumerable:!0})})(i,{SYMBOL_FOR_REQ_CONTEXT:()=>s,getContext:()=>o}),e.exports=((e,i,s,o)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let l of a(i))n.call(e,l)||l===s||t(e,l,{get:()=>i[l],enumerable:!(o=r(i,l))||o.enumerable});return e})(t({},"__esModule",{value:!0}),i);let s=Symbol.for("@vercel/request-context");function o(){let e=globalThis;return e[s]?.get?.()??{}}},4850:(e,t,r)=>{"use strict";Object.create;var a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=(Object.getPrototypeOf,Object.prototype.hasOwnProperty),o={};((e,t)=>{for(var r in t)a(e,r,{get:t[r],enumerable:!0})})(o,{getVercelOidcToken:()=>c,getVercelOidcTokenSync:()=>d}),e.exports=((e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of i(t))s.call(e,l)||l===r||a(e,l,{get:()=>t[l],enumerable:!(o=n(t,l))||o.enumerable});return e})(a({},"__esModule",{value:!0}),o);var l=r(2311),u=r(9848);async function c(){let e,t="";try{t=d()}catch(t){e=t}try{let[{getTokenPayload:e,isExpired:a},{refreshToken:n}]=await Promise.all([await r.e(77).then(r.t.bind(r,5349,23)),await r.e(447).then(r.t.bind(r,7447,23))]);(!t||a(e(t)))&&(await n(),t=d())}catch(r){let t=e instanceof Error?e.message:"";if(r instanceof Error&&(t=`${t}
${r.message}`),t)throw new u.VercelOidcTokenError(t);throw r}return t}function d(){let e=l.getContext().headers?.["x-vercel-oidc-token"]??process.env.VERCEL_OIDC_TOKEN;if(!e)throw Error("The 'x-vercel-oidc-token' header is missing from the request. Do you have the OIDC option enabled in the Vercel project settings?");return e}},1858:(e,t,r)=>{"use strict";var a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,o={};((e,t)=>{for(var r in t)a(e,r,{get:t[r],enumerable:!0})})(o,{getContext:()=>u.getContext,getVercelOidcToken:()=>l.getVercelOidcToken,getVercelOidcTokenSync:()=>l.getVercelOidcTokenSync}),e.exports=((e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of i(t))s.call(e,l)||l===r||a(e,l,{get:()=>t[l],enumerable:!(o=n(t,l))||o.enumerable});return e})(a({},"__esModule",{value:!0}),o);var l=r(4850),u=r(2311)},9848:e=>{"use strict";var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i={};((e,r)=>{for(var a in r)t(e,a,{get:r[a],enumerable:!0})})(i,{VercelOidcTokenError:()=>s}),e.exports=((e,i,s,o)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let l of a(i))n.call(e,l)||l===s||t(e,l,{get:()=>i[l],enumerable:!(o=r(i,l))||o.enumerable});return e})(t({},"__esModule",{value:!0}),i);class s extends Error{constructor(e,t){super(e),this.name="VercelOidcTokenError",this.cause=t}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},7070:(e,t,r)=>{"use strict";var a=r(8277);r.o(a,"NextResponse")&&r.d(t,{NextResponse:function(){return a.NextResponse}})},9925:e=>{"use strict";var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i={};function s(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),a=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===r.length?a:`${a}; ${r.join("; ")}`}function o(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[a,n]=[r.slice(0,e),r.slice(e+1)];try{t.set(a,decodeURIComponent(null!=n?n:"true"))}catch{}}return t}function l(e){var t,r;if(!e)return;let[[a,n],...i]=o(e),{domain:s,expires:l,httponly:d,maxage:h,path:p,samesite:f,secure:m,partitioned:y,priority:g}=Object.fromEntries(i.map(([e,t])=>[e.toLowerCase(),t]));return function(e){let t={};for(let r in e)e[r]&&(t[r]=e[r]);return t}({name:a,value:decodeURIComponent(n),domain:s,...l&&{expires:new Date(l)},...d&&{httpOnly:!0},..."string"==typeof h&&{maxAge:Number(h)},path:p,...f&&{sameSite:u.includes(t=(t=f).toLowerCase())?t:void 0},...m&&{secure:!0},...g&&{priority:c.includes(r=(r=g).toLowerCase())?r:void 0},...y&&{partitioned:!0}})}((e,r)=>{for(var a in r)t(e,a,{get:r[a],enumerable:!0})})(i,{RequestCookies:()=>d,ResponseCookies:()=>h,parseCookie:()=>o,parseSetCookie:()=>l,stringifyCookie:()=>s}),e.exports=((e,i,s,o)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let l of a(i))n.call(e,l)||l===s||t(e,l,{get:()=>i[l],enumerable:!(o=r(i,l))||o.enumerable});return e})(t({},"__esModule",{value:!0}),i);var u=["strict","lax","none"],c=["low","medium","high"],d=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t)for(let[e,r]of o(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===a).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,a=this._parsed;return a.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(a).map(([e,t])=>s(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>s(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},h=class{constructor(e){var t,r,a;this._parsed=new Map,this._headers=e;let n=null!=(a=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?a:[];for(let e of Array.isArray(n)?n:function(e){if(!e)return[];var t,r,a,n,i,s=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,i=!1;l();)if(","===(r=e.charAt(o))){for(a=o,o+=1,l(),n=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(i=!0,o=n,s.push(e.substring(t,a)),t=o):o=a+1}else o+=1;(!i||o>=e.length)&&s.push(e.substring(t,e.length))}return s}(n)){let t=l(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===a)}has(e){return this._parsed.has(e)}set(...e){let[t,r,a]=1===e.length?[e[0].name,e[0].value,e[0]]:e,n=this._parsed;return n.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...a})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=s(r);t.append("set-cookie",e)}}(n,this._headers),this}delete(...e){let[t,r,a]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0].path,e[0].domain];return this.set({name:t,path:r,domain:a,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(s).join("; ")}}},8346:(e,t,r)=>{var a;(()=>{var n={226:function(n,i){!function(s,o){"use strict";var l="function",u="undefined",c="object",d="string",h="major",p="model",f="name",m="type",y="vendor",g="version",v="architecture",_="console",b="mobile",w="tablet",k="smarttv",T="wearable",x="embedded",S="Amazon",I="Apple",A="ASUS",E="BlackBerry",O="Browser",R="Chrome",P="Firefox",$="Google",C="Huawei",j="Microsoft",N="Motorola",Z="Opera",z="Samsung",F="Sharp",M="Sony",U="Xiaomi",L="Zebra",D="Facebook",q="Chromium OS",B="Mac OS",V=function(e,t){var r={};for(var a in e)t[a]&&t[a].length%2==0?r[a]=t[a].concat(e[a]):r[a]=e[a];return r},K=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},W=function(e,t){return typeof e===d&&-1!==G(t).indexOf(G(e))},G=function(e){return e.toLowerCase()},J=function(e,t){if(typeof e===d)return e=e.replace(/^\s\s*/,""),typeof t===u?e:e.substring(0,350)},H=function(e,t){for(var r,a,n,i,s,u,d=0;d<t.length&&!s;){var h=t[d],p=t[d+1];for(r=a=0;r<h.length&&!s&&h[r];)if(s=h[r++].exec(e))for(n=0;n<p.length;n++)u=s[++a],typeof(i=p[n])===c&&i.length>0?2===i.length?typeof i[1]==l?this[i[0]]=i[1].call(this,u):this[i[0]]=i[1]:3===i.length?typeof i[1]!==l||i[1].exec&&i[1].test?this[i[0]]=u?u.replace(i[1],i[2]):void 0:this[i[0]]=u?i[1].call(this,u,i[2]):void 0:4===i.length&&(this[i[0]]=u?i[3].call(this,u.replace(i[1],i[2])):void 0):this[i]=u||o;d+=2}},X=function(e,t){for(var r in t)if(typeof t[r]===c&&t[r].length>0){for(var a=0;a<t[r].length;a++)if(W(t[r][a],e))return"?"===r?o:r}else if(W(t[r],e))return"?"===r?o:r;return e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,g],[/opios[\/ ]+([\w\.]+)/i],[g,[f,Z+" Mini"]],[/\bopr\/([\w\.]+)/i],[g,[f,Z]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,g],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[f,"UC"+O]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[g,[f,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[g,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[f,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+O],g],[/\bfocus\/([\w\.]+)/i],[g,[f,P+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[f,Z+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[f,Z+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[f,"MIUI "+O]],[/fxios\/([-\w\.]+)/i],[g,[f,P]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+O]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+O],g],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[f,g],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,D],g],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[f,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[f,R+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,R+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[f,"Android "+O]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[g,X,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[f,P+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[f,g],[/(cobalt)\/([\w\.]+)/i],[f,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[v,"amd64"]],[/(ia32(?=;))/i],[[v,G]],[/((?:i[346]|x)86)[;\)]/i],[[v,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[v,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[v,"armhf"]],[/windows (ce|mobile); ppc;/i],[[v,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[v,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[v,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[v,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[y,z],[m,w]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[p,[y,z],[m,b]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[y,I],[m,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[y,I],[m,w]],[/(macintosh);/i],[p,[y,I]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[y,F],[m,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[p,[y,C],[m,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[y,C],[m,b]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[p,/_/g," "],[y,U],[m,b]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[p,/_/g," "],[y,U],[m,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[y,"OPPO"],[m,b]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[y,"Vivo"],[m,b]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[p,[y,"Realme"],[m,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[y,N],[m,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[y,N],[m,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[y,"LG"],[m,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[y,"LG"],[m,b]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[p,[y,"Lenovo"],[m,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[p,/_/g," "],[y,"Nokia"],[m,b]],[/(pixel c)\b/i],[p,[y,$],[m,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[y,$],[m,b]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[y,M],[m,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[y,M],[m,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[y,"OnePlus"],[m,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[y,S],[m,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[y,S],[m,b]],[/(playbook);[-\w\),; ]+(rim)/i],[p,y,[m,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[y,E],[m,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[y,A],[m,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[y,A],[m,b]],[/(nexus 9)/i],[p,[y,"HTC"],[m,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[y,[p,/_/g," "],[m,b]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[y,"Acer"],[m,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[y,"Meizu"],[m,b]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[y,p,[m,b]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[y,p,[m,w]],[/(surface duo)/i],[p,[y,j],[m,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[y,"Fairphone"],[m,b]],[/(u304aa)/i],[p,[y,"AT&T"],[m,b]],[/\bsie-(\w*)/i],[p,[y,"Siemens"],[m,b]],[/\b(rct\w+) b/i],[p,[y,"RCA"],[m,w]],[/\b(venue[\d ]{2,7}) b/i],[p,[y,"Dell"],[m,w]],[/\b(q(?:mv|ta)\w+) b/i],[p,[y,"Verizon"],[m,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[y,"Barnes & Noble"],[m,w]],[/\b(tm\d{3}\w+) b/i],[p,[y,"NuVision"],[m,w]],[/\b(k88) b/i],[p,[y,"ZTE"],[m,w]],[/\b(nx\d{3}j) b/i],[p,[y,"ZTE"],[m,b]],[/\b(gen\d{3}) b.+49h/i],[p,[y,"Swiss"],[m,b]],[/\b(zur\d{3}) b/i],[p,[y,"Swiss"],[m,w]],[/\b((zeki)?tb.*\b) b/i],[p,[y,"Zeki"],[m,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[y,"Dragon Touch"],p,[m,w]],[/\b(ns-?\w{0,9}) b/i],[p,[y,"Insignia"],[m,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[y,"NextBook"],[m,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[y,"Voice"],p,[m,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[y,"LvTel"],p,[m,b]],[/\b(ph-1) /i],[p,[y,"Essential"],[m,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[y,"Envizen"],[m,w]],[/\b(trio[-\w\. ]+) b/i],[p,[y,"MachSpeed"],[m,w]],[/\btu_(1491) b/i],[p,[y,"Rotor"],[m,w]],[/(shield[\w ]+) b/i],[p,[y,"Nvidia"],[m,w]],[/(sprint) (\w+)/i],[y,p,[m,b]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[y,j],[m,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[y,L],[m,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[y,L],[m,b]],[/smart-tv.+(samsung)/i],[y,[m,k]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[y,z],[m,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[y,"LG"],[m,k]],[/(apple) ?tv/i],[y,[p,I+" TV"],[m,k]],[/crkey/i],[[p,R+"cast"],[y,$],[m,k]],[/droid.+aft(\w)( bui|\))/i],[p,[y,S],[m,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[y,F],[m,k]],[/(bravia[\w ]+)( bui|\))/i],[p,[y,M],[m,k]],[/(mitv-\w{5}) bui/i],[p,[y,U],[m,k]],[/Hbbtv.*(technisat) (.*);/i],[y,p,[m,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[y,J],[p,J],[m,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[y,p,[m,_]],[/droid.+; (shield) bui/i],[p,[y,"Nvidia"],[m,_]],[/(playstation [345portablevi]+)/i],[p,[y,M],[m,_]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[y,j],[m,_]],[/((pebble))app/i],[y,p,[m,T]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[y,I],[m,T]],[/droid.+; (glass) \d/i],[p,[y,$],[m,T]],[/droid.+; (wt63?0{2,3})\)/i],[p,[y,L],[m,T]],[/(quest( 2| pro)?)/i],[p,[y,D],[m,T]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[y,[m,x]],[/(aeobc)\b/i],[p,[y,S],[m,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[p,[m,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[m,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,w]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,b]],[/(android[-\w\. ]{0,9});.+buil/i],[p,[y,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,g],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[f,[g,X,Y]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,"Windows"],[g,X,Y]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,B],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,g],[/\(bb(10);/i],[g,[f,E]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[f,P+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[f,R+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,q],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,g],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,g]]},ee=function(e,t){if(typeof e===c&&(t=e,e=o),!(this instanceof ee))return new ee(e,t).getResult();var r=typeof s!==u&&s.navigator?s.navigator:o,a=e||(r&&r.userAgent?r.userAgent:""),n=r&&r.userAgentData?r.userAgentData:o,i=t?V(Q,t):Q,_=r&&r.userAgent==a;return this.getBrowser=function(){var e,t={};return t[f]=o,t[g]=o,H.call(t,a,i.browser),t[h]=typeof(e=t[g])===d?e.replace(/[^\d\.]/g,"").split(".")[0]:o,_&&r&&r.brave&&typeof r.brave.isBrave==l&&(t[f]="Brave"),t},this.getCPU=function(){var e={};return e[v]=o,H.call(e,a,i.cpu),e},this.getDevice=function(){var e={};return e[y]=o,e[p]=o,e[m]=o,H.call(e,a,i.device),_&&!e[m]&&n&&n.mobile&&(e[m]=b),_&&"Macintosh"==e[p]&&r&&typeof r.standalone!==u&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[p]="iPad",e[m]=w),e},this.getEngine=function(){var e={};return e[f]=o,e[g]=o,H.call(e,a,i.engine),e},this.getOS=function(){var e={};return e[f]=o,e[g]=o,H.call(e,a,i.os),_&&!e[f]&&n&&"Unknown"!=n.platform&&(e[f]=n.platform.replace(/chrome os/i,q).replace(/macos/i,B)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return a},this.setUA=function(e){return a=typeof e===d&&e.length>350?J(e,350):e,this},this.setUA(a),this};ee.VERSION="1.0.35",ee.BROWSER=K([f,g,h]),ee.CPU=K([v]),ee.DEVICE=K([p,y,m,_,b,k,w,T,x]),ee.ENGINE=ee.OS=K([f,g]),typeof i!==u?(n.exports&&(i=n.exports=ee),i.UAParser=ee):r.amdO?void 0!==(a=(function(){return ee}).call(t,r,t,e))&&(e.exports=a):typeof s!==u&&(s.UAParser=ee);var et=typeof s!==u&&(s.jQuery||s.Zepto);if(et&&!et.ua){var er=new ee;et.ua=er.getResult(),et.ua.get=function(){return er.getUA()},et.ua.set=function(e){er.setUA(e);var t=er.getResult();for(var r in t)et.ua[r]=t[r]}}}("object"==typeof window?window:this)}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}},a=!0;try{n[e].call(r.exports,r,r.exports,s),a=!1}finally{a&&delete i[e]}return r.exports}s.ab=__dirname+"/";var o=s(226);e.exports=o})()},9303:(e,t,r)=>{"use strict";e.exports=r(517)},44:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{PageSignatureError:function(){return r},RemovedPageError:function(){return a},RemovedUAError:function(){return n}});class r extends Error{constructor({page:e}){super(`The middleware "${e}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class a extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class n extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}},8277:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ImageResponse:function(){return a.ImageResponse},NextRequest:function(){return n.NextRequest},NextResponse:function(){return i.NextResponse},URLPattern:function(){return o.URLPattern},userAgent:function(){return s.userAgent},userAgentFromString:function(){return s.userAgentFromString}});let a=r(6),n=r(9745),i=r(9211),s=r(8471),o=r(2433)},6109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextURL",{enumerable:!0,get:function(){return c}});let a=r(3777),n=r(3817),i=r(1675),s=r(6111),o=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function l(e,t){return new URL(String(e).replace(o,"localhost"),t&&String(t).replace(o,"localhost"))}let u=Symbol("NextURLInternal");class c{constructor(e,t,r){let a,n;"object"==typeof t&&"pathname"in t||"string"==typeof t?(a=t,n=r||{}):n=r||t||{},this[u]={url:l(e,a??n.base),options:n,basePath:""},this.analyze()}analyze(){var e,t,r,n,o;let l=(0,s.getNextPathnameInfo)(this[u].url.pathname,{nextConfig:this[u].options.nextConfig,parseData:!0,i18nProvider:this[u].options.i18nProvider}),c=(0,i.getHostname)(this[u].url,this[u].options.headers);this[u].domainLocale=this[u].options.i18nProvider?this[u].options.i18nProvider.detectDomainLocale(c):(0,a.detectDomainLocale)(null==(t=this[u].options.nextConfig)?void 0:null==(e=t.i18n)?void 0:e.domains,c);let d=(null==(r=this[u].domainLocale)?void 0:r.defaultLocale)||(null==(o=this[u].options.nextConfig)?void 0:null==(n=o.i18n)?void 0:n.defaultLocale);this[u].url.pathname=l.pathname,this[u].defaultLocale=d,this[u].basePath=l.basePath??"",this[u].buildId=l.buildId,this[u].locale=l.locale??d,this[u].trailingSlash=l.trailingSlash}formatPathname(){return(0,n.formatNextPathnameInfo)({basePath:this[u].basePath,buildId:this[u].buildId,defaultLocale:this[u].options.forceLocale?void 0:this[u].defaultLocale,locale:this[u].locale,pathname:this[u].url.pathname,trailingSlash:this[u].trailingSlash})}formatSearch(){return this[u].url.search}get buildId(){return this[u].buildId}set buildId(e){this[u].buildId=e}get locale(){return this[u].locale??""}set locale(e){var t,r;if(!this[u].locale||!(null==(r=this[u].options.nextConfig)?void 0:null==(t=r.i18n)?void 0:t.locales.includes(e)))throw TypeError(`The NextURL configuration includes no locale "${e}"`);this[u].locale=e}get defaultLocale(){return this[u].defaultLocale}get domainLocale(){return this[u].domainLocale}get searchParams(){return this[u].url.searchParams}get host(){return this[u].url.host}set host(e){this[u].url.host=e}get hostname(){return this[u].url.hostname}set hostname(e){this[u].url.hostname=e}get port(){return this[u].url.port}set port(e){this[u].url.port=e}get protocol(){return this[u].url.protocol}set protocol(e){this[u].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[u].url=l(e),this.analyze()}get origin(){return this[u].url.origin}get pathname(){return this[u].url.pathname}set pathname(e){this[u].url.pathname=e}get hash(){return this[u].url.hash}set hash(e){this[u].url.hash=e}get search(){return this[u].url.search}set search(e){this[u].url.search=e}get password(){return this[u].url.password}set password(e){this[u].url.password=e}get username(){return this[u].url.username}set username(e){this[u].url.username=e}get basePath(){return this[u].basePath}set basePath(e){this[u].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new c(String(this),this[u].options)}}},2044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RequestCookies:function(){return a.RequestCookies},ResponseCookies:function(){return a.ResponseCookies},stringifyCookie:function(){return a.stringifyCookie}});let a=r(9925)},6:(e,t)=>{"use strict";function r(){throw Error('ImageResponse moved from "next/server" to "next/og" since Next.js 14, please import from "next/og" instead')}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ImageResponse",{enumerable:!0,get:function(){return r}})},9745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{INTERNALS:function(){return o},NextRequest:function(){return l}});let a=r(6109),n=r(7636),i=r(44),s=r(2044),o=Symbol("internal request");class l extends Request{constructor(e,t={}){let r="string"!=typeof e&&"url"in e?e.url:String(e);(0,n.validateURL)(r),e instanceof Request?super(e,t):super(r,t);let i=new a.NextURL(r,{headers:(0,n.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:t.nextConfig});this[o]={cookies:new s.RequestCookies(this.headers),geo:t.geo||{},ip:t.ip,nextUrl:i,url:i.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[o].cookies}get geo(){return this[o].geo}get ip(){return this[o].ip}get nextUrl(){return this[o].nextUrl}get page(){throw new i.RemovedPageError}get ua(){throw new i.RemovedUAError}get url(){return this[o].url}}},9211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextResponse",{enumerable:!0,get:function(){return d}});let a=r(2044),n=r(6109),i=r(7636),s=r(8238),o=r(2044),l=Symbol("internal response"),u=new Set([301,302,303,307,308]);function c(e,t){var r;if(null==e?void 0:null==(r=e.request)?void 0:r.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let r=[];for(let[a,n]of e.request.headers)t.set("x-middleware-request-"+a,n),r.push(a);t.set("x-middleware-override-headers",r.join(","))}}class d extends Response{constructor(e,t={}){super(e,t);let r=this.headers,u=new Proxy(new o.ResponseCookies(r),{get(e,n,i){switch(n){case"delete":case"set":return(...i)=>{let s=Reflect.apply(e[n],e,i),l=new Headers(r);return s instanceof o.ResponseCookies&&r.set("x-middleware-set-cookie",s.getAll().map(e=>(0,a.stringifyCookie)(e)).join(",")),c(t,l),s};default:return s.ReflectAdapter.get(e,n,i)}}});this[l]={cookies:u,url:t.url?new n.NextURL(t.url,{headers:(0,i.toNodeOutgoingHttpHeaders)(r),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[l].cookies}static json(e,t){let r=Response.json(e,t);return new d(r.body,r)}static redirect(e,t){let r="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!u.has(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let a="object"==typeof t?t:{},n=new Headers(null==a?void 0:a.headers);return n.set("Location",(0,i.validateURL)(e)),new d(null,{...a,headers:n,status:r})}static rewrite(e,t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-rewrite",(0,i.validateURL)(e)),c(t,r),new d(null,{...t,headers:r})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),c(e,t),new d(null,{...e,headers:t})}}},2433:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"URLPattern",{enumerable:!0,get:function(){return r}});let r="undefined"==typeof URLPattern?void 0:URLPattern},8471:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isBot:function(){return n},userAgent:function(){return s},userAgentFromString:function(){return i}});let a=function(e){return e&&e.__esModule?e:{default:e}}(r(8346));function n(e){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Google-InspectionTool|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(e)}function i(e){return{...(0,a.default)(e),isBot:void 0!==e&&n(e)}}function s({headers:e}){return i(e.get("user-agent")||void 0)}},7636:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{fromNodeOutgoingHttpHeaders:function(){return n},normalizeNextQueryParam:function(){return l},splitCookiesString:function(){return i},toNodeOutgoingHttpHeaders:function(){return s},validateURL:function(){return o}});let a=r(1943);function n(e){let t=new Headers;for(let[r,a]of Object.entries(e))for(let e of Array.isArray(a)?a:[a])void 0!==e&&("number"==typeof e&&(e=e.toString()),t.append(r,e));return t}function i(e){var t,r,a,n,i,s=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,i=!1;l();)if(","===(r=e.charAt(o))){for(a=o,o+=1,l(),n=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(i=!0,o=n,s.push(e.substring(t,a)),t=o):o=a+1}else o+=1;(!i||o>=e.length)&&s.push(e.substring(t,e.length))}return s}function s(e){let t={},r=[];if(e)for(let[a,n]of e.entries())"set-cookie"===a.toLowerCase()?(r.push(...i(n)),t[a]=1===r.length?r[0]:r):t[a]=n;return t}function o(e){try{return String(new URL(String(e)))}catch(t){throw Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t})}}function l(e,t){for(let r of[a.NEXT_QUERY_PARAM_PREFIX,a.NEXT_INTERCEPTION_MARKER_PREFIX])e!==r&&e.startsWith(r)&&t(e.substring(r.length))}},1675:(e,t)=>{"use strict";function r(e,t){let r;if((null==t?void 0:t.host)&&!Array.isArray(t.host))r=t.host.toString().split(":",1)[0];else{if(!e.hostname)return;r=e.hostname}return r.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getHostname",{enumerable:!0,get:function(){return r}})},3777:(e,t)=>{"use strict";function r(e,t,r){if(e)for(let i of(r&&(r=r.toLowerCase()),e)){var a,n;if(t===(null==(a=i.domain)?void 0:a.split(":",1)[0].toLowerCase())||r===i.defaultLocale.toLowerCase()||(null==(n=i.locales)?void 0:n.some(e=>e.toLowerCase()===r)))return i}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"detectDomainLocale",{enumerable:!0,get:function(){return r}})},5014:(e,t)=>{"use strict";function r(e,t){let r;let a=e.split("/");return(t||[]).some(t=>!!a[1]&&a[1].toLowerCase()===t.toLowerCase()&&(r=t,a.splice(1,1),e=a.join("/")||"/",!0)),{pathname:e,detectedLocale:r}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizeLocalePath",{enumerable:!0,get:function(){return r}})},225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLocale",{enumerable:!0,get:function(){return i}});let a=r(1041),n=r(4329);function i(e,t,r,i){if(!t||t===r)return e;let s=e.toLowerCase();return!i&&((0,n.pathHasPrefix)(s,"/api")||(0,n.pathHasPrefix)(s,"/"+t.toLowerCase()))?e:(0,a.addPathPrefix)(e,"/"+t)}},1041:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathPrefix",{enumerable:!0,get:function(){return n}});let a=r(1693);function n(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=(0,a.parsePath)(e);return""+t+r+n+i}},8166:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathSuffix",{enumerable:!0,get:function(){return n}});let a=r(1693);function n(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=(0,a.parsePath)(e);return""+r+t+n+i}},3817:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"formatNextPathnameInfo",{enumerable:!0,get:function(){return o}});let a=r(7847),n=r(1041),i=r(8166),s=r(225);function o(e){let t=(0,s.addLocale)(e.pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix);return(e.buildId||!e.trailingSlash)&&(t=(0,a.removeTrailingSlash)(t)),e.buildId&&(t=(0,i.addPathSuffix)((0,n.addPathPrefix)(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=(0,n.addPathPrefix)(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:(0,i.addPathSuffix)(t,"/"):(0,a.removeTrailingSlash)(t)}},6111:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getNextPathnameInfo",{enumerable:!0,get:function(){return s}});let a=r(5014),n=r(9529),i=r(4329);function s(e,t){var r,s;let{basePath:o,i18n:l,trailingSlash:u}=null!=(r=t.nextConfig)?r:{},c={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):u};o&&(0,i.pathHasPrefix)(c.pathname,o)&&(c.pathname=(0,n.removePathPrefix)(c.pathname,o),c.basePath=o);let d=c.pathname;if(c.pathname.startsWith("/_next/data/")&&c.pathname.endsWith(".json")){let e=c.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),r=e[0];c.buildId=r,d="index"!==e[1]?"/"+e.slice(1).join("/"):"/",!0===t.parseData&&(c.pathname=d)}if(l){let e=t.i18nProvider?t.i18nProvider.analyze(c.pathname):(0,a.normalizeLocalePath)(c.pathname,l.locales);c.locale=e.detectedLocale,c.pathname=null!=(s=e.pathname)?s:c.pathname,!e.detectedLocale&&c.buildId&&(e=t.i18nProvider?t.i18nProvider.analyze(d):(0,a.normalizeLocalePath)(d,l.locales)).detectedLocale&&(c.locale=e.detectedLocale)}return c}},1693:(e,t)=>{"use strict";function r(e){let t=e.indexOf("#"),r=e.indexOf("?"),a=r>-1&&(t<0||r<t);return a||t>-1?{pathname:e.substring(0,a?r:t),query:a?e.substring(r,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parsePath",{enumerable:!0,get:function(){return r}})},4329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"pathHasPrefix",{enumerable:!0,get:function(){return n}});let a=r(1693);function n(e,t){if("string"!=typeof e)return!1;let{pathname:r}=(0,a.parsePath)(e);return r===t||r.startsWith(t+"/")}},9529:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removePathPrefix",{enumerable:!0,get:function(){return n}});let a=r(4329);function n(e,t){if(!(0,a.pathHasPrefix)(e,t))return e;let r=e.slice(t.length);return r.startsWith("/")?r:"/"+r}},7847:(e,t)=>{"use strict";function r(e){return e.replace(/\/$/,"")||"/"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removeTrailingSlash",{enumerable:!0,get:function(){return r}})},5815:(e,t,r)=>{"use strict";r.d(t,{cZ:()=>t_});var a,n,i,s,o,l,u,c,d,h,p,f,m,y,g,v,_,b,w,k,T="vercel.ai.error",x=Symbol.for(T),S=class e extends(n=Error,a=x,n){constructor({name:e,message:t,cause:r}){super(t),this[a]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,T)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}},I="AI_APICallError",A=`vercel.ai.error.${I}`,E=Symbol.for(A),O=class extends(s=S,i=E,s){constructor({message:e,url:t,requestBodyValues:r,statusCode:a,responseHeaders:n,responseBody:s,cause:o,isRetryable:l=null!=a&&(408===a||409===a||429===a||a>=500),data:u}){super({name:I,message:e,cause:o}),this[i]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=a,this.responseHeaders=n,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(e){return S.hasMarker(e,A)}},R="AI_EmptyResponseBodyError",P=`vercel.ai.error.${R}`,$=Symbol.for(P),C=class extends(l=S,o=$,l){constructor({message:e="Empty response body"}={}){super({name:R,message:e}),this[o]=!0}static isInstance(e){return S.hasMarker(e,P)}};function j(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}var N="AI_InvalidArgumentError",Z=`vercel.ai.error.${N}`,z=Symbol.for(Z),F=class extends(c=S,u=z,c){constructor({message:e,cause:t,argument:r}){super({name:N,message:e,cause:t}),this[u]=!0,this.argument=r}static isInstance(e){return S.hasMarker(e,Z)}},M="AI_InvalidPromptError",U=`vercel.ai.error.${M}`,L=Symbol.for(U),D=class extends(h=S,d=L,h){constructor({prompt:e,message:t,cause:r}){super({name:M,message:`Invalid prompt: ${t}`,cause:r}),this[d]=!0,this.prompt=e}static isInstance(e){return S.hasMarker(e,U)}},q="AI_InvalidResponseDataError",B=`vercel.ai.error.${q}`,V=Symbol.for(B),K=class extends(f=S,p=V,f){constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:q,message:t}),this[p]=!0,this.data=e}static isInstance(e){return S.hasMarker(e,B)}},W="AI_JSONParseError",G=`vercel.ai.error.${W}`,J=Symbol.for(G),H=class extends(y=S,m=J,y){constructor({text:e,cause:t}){super({name:W,message:`JSON parsing failed: Text: ${e}.
Error message: ${j(t)}`,cause:t}),this[m]=!0,this.text=e}static isInstance(e){return S.hasMarker(e,G)}},X=(Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchModelError"),"AI_TooManyEmbeddingValuesForCallError"),Y=`vercel.ai.error.${X}`,Q=Symbol.for(Y),ee=class extends(v=S,g=Q,v){constructor(e){super({name:X,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[g]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return S.hasMarker(e,Y)}},et="AI_TypeValidationError",er=`vercel.ai.error.${et}`,ea=Symbol.for(er),en=class e extends(b=S,_=ea,b){constructor({value:e,cause:t}){super({name:et,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${j(t)}`,cause:t}),this[_]=!0,this.value=e}static isInstance(e){return S.hasMarker(e,er)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}},ei="AI_UnsupportedFunctionalityError",es=`vercel.ai.error.${ei}`,eo=Symbol.for(es),el=class extends(k=S,w=eo,k){constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:ei,message:t}),this[w]=!0,this.functionality=e}static isInstance(e){return S.hasMarker(e,es)}};function eu(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(eu):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&eu(t)))}var ec=r(1536);function ed(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function eh(e){return Object.fromEntries([...e.headers])}var ep=(({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{let n=()=>{let e=r.length,a=Array(t);for(let n=0;n<t;n++)a[n]=r[Math.random()*e|0];return a.join("")};if(null==e)return n;if(r.includes(a))throw new F({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return()=>`${e}${a}${n()}`})();function ef(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}var em=["fetch failed","failed to fetch"];function ey(e,...t){let r=new Headers(function(e){if(null==e)return{};let t={};if(e instanceof Headers)e.forEach((e,r)=>{t[r.toLowerCase()]=e});else for(let[r,a]of(Array.isArray(e)||(e=Object.entries(e)),e))null!=a&&(t[r.toLowerCase()]=a);return t}(e)),a=r.get("user-agent")||"";return r.set("user-agent",[a,...t].filter(Boolean).join(" ")),Object.fromEntries(r.entries())}var eg=/"__proto__"\s*:/,ev=/"constructor"\s*:/;function e_(e){let t=JSON.parse(e);return null===t||"object"!=typeof t||!1===eg.test(e)&&!1===ev.test(e)?t:function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let a=r[e];a&&"object"==typeof a&&t.push(a)}}}return e}(t)}function eb(e){let{stackTraceLimit:t}=Error;try{Error.stackTraceLimit=0}catch(t){return e_(e)}try{return e_(e)}finally{Error.stackTraceLimit=t}}var ew=Symbol.for("vercel.ai.validator");async function ek({value:e,schema:t}){let r=await eT({value:e,schema:t});if(!r.success)throw en.wrap({value:e,cause:r.error});return r.value}async function eT({value:e,schema:t}){let r="object"==typeof t&&null!==t&&ew in t&&!0===t[ew]&&"validate"in t?t:"function"==typeof t?t():{[ew]:!0,validate:async e=>{let r=await t["~standard"].validate(e);return null==r.issues?{success:!0,value:r.value}:{success:!1,error:new en({value:e,cause:r.issues})}}};try{if(null==r.validate)return{success:!0,value:e,rawValue:e};let t=await r.validate(e);if(t.success)return{success:!0,value:t.value,rawValue:e};return{success:!1,error:en.wrap({value:e,cause:t.error}),rawValue:e}}catch(t){return{success:!1,error:en.wrap({value:e,cause:t}),rawValue:e}}}async function ex({text:e,schema:t}){try{let r=eb(e);if(null==t)return r;return ek({value:r,schema:t})}catch(t){if(H.isInstance(t)||en.isInstance(t))throw t;throw new H({text:e,cause:t})}}async function eS({text:e,schema:t}){try{let r=eb(e);if(null==t)return{success:!0,value:r,rawValue:r};return await eT({value:r,schema:t})}catch(t){return{success:!1,error:H.isInstance(t)?t:new H({text:e,cause:t}),rawValue:void 0}}}function eI(e){try{return eb(e),!0}catch(e){return!1}}async function eA({provider:e,providerOptions:t,schema:r}){if((null==t?void 0:t[e])==null)return;let a=await eT({value:t[e],schema:r});if(!a.success)throw new F({argument:"providerOptions",message:`invalid ${e} provider options`,cause:a.error});return a.value}var eE=()=>globalThis.fetch,eO=async({url:e,headers:t,body:r,failedResponseHandler:a,successfulResponseHandler:n,abortSignal:i,fetch:s})=>eR({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:a,successfulResponseHandler:n,abortSignal:i,fetch:s}),eR=async({url:e,headers:t={},body:r,successfulResponseHandler:a,failedResponseHandler:n,abortSignal:i,fetch:s=eE()})=>{try{let o=await s(e,{method:"POST",headers:ey(t,"ai-sdk/provider-utils/3.0.20",function(e=globalThis){var t,r,a;return e.window?"runtime/browser":(null==(t=e.navigator)?void 0:t.userAgent)?`runtime/${e.navigator.userAgent.toLowerCase()}`:(null==(a=null==(r=e.process)?void 0:r.versions)?void 0:a.node)?`runtime/node.js/${e.process.version.substring(0)}`:e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}()),body:r.content,signal:i}),l=eh(o);if(!o.ok){let t;try{t=await n({response:o,url:e,requestBodyValues:r.values})}catch(t){if(ef(t)||O.isInstance(t))throw t;throw new O({message:"Failed to process error response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:r.values})}throw t.value}try{return await a({response:o,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(ef(t)||O.isInstance(t)))throw t;throw new O({message:"Failed to process successful response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:r.values})}}catch(t){throw function({error:e,url:t,requestBodyValues:r}){if(ef(e))return e;if(e instanceof TypeError&&em.includes(e.message.toLowerCase())){let a=e.cause;if(null!=a)return new O({message:`Cannot connect to API: ${a.message}`,cause:a,url:t,requestBodyValues:r,isRetryable:!0})}return e}({error:t,url:e,requestBodyValues:r.values})}},eP=({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:a,url:n,requestBodyValues:i})=>{let s=await a.text(),o=eh(a);if(""===s.trim())return{responseHeaders:o,value:new O({message:a.statusText,url:n,requestBodyValues:i,statusCode:a.status,responseHeaders:o,responseBody:s,isRetryable:null==r?void 0:r(a)})};try{let l=await ex({text:s,schema:e});return{responseHeaders:o,value:new O({message:t(l),url:n,requestBodyValues:i,statusCode:a.status,responseHeaders:o,responseBody:s,data:l,isRetryable:null==r?void 0:r(a,l)})}}catch(e){return{responseHeaders:o,value:new O({message:a.statusText,url:n,requestBodyValues:i,statusCode:a.status,responseHeaders:o,responseBody:s,isRetryable:null==r?void 0:r(a)})}}},e$=e=>async({response:t})=>{let r=eh(t);if(null==t.body)throw new C({});return{responseHeaders:r,value:function({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new ec.m).pipeThrough(new TransformStream({async transform({data:e},r){"[DONE]"!==e&&r.enqueue(await eS({text:e,schema:t}))}}))}({stream:t.body,schema:e})}},eC=e=>async({response:t,url:r,requestBodyValues:a})=>{let n=await t.text(),i=await eS({text:n,schema:e}),s=eh(t);if(!i.success)throw new O({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:s,responseBody:n,url:r,requestBodyValues:a});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},ej=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},eN=Symbol("Let zodToJsonSchema decide on which parser to use"),eZ={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function ez(e,t){return e4(e.type._def,t)}var eF=(e,t)=>e4(e.innerType._def,t),eM=e=>{let t={type:"integer",format:"unix-time"};for(let r of e.checks)switch(r.kind){case"min":t.minimum=r.value;break;case"max":t.maximum=r.value}return t},eU=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,eL=void 0,eD={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===eL&&(eL=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),eL),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function eq(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value;break;case"max":r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"email":switch(t.emailStrategy){case"format:email":eK(r,"email",a.message,t);break;case"format:idn-email":eK(r,"idn-email",a.message,t);break;case"pattern:zod":eW(r,eD.email,a.message,t)}break;case"url":eK(r,"uri",a.message,t);break;case"uuid":eK(r,"uuid",a.message,t);break;case"regex":eW(r,a.regex,a.message,t);break;case"cuid":eW(r,eD.cuid,a.message,t);break;case"cuid2":eW(r,eD.cuid2,a.message,t);break;case"startsWith":eW(r,RegExp(`^${eB(a.value,t)}`),a.message,t);break;case"endsWith":eW(r,RegExp(`${eB(a.value,t)}$`),a.message,t);break;case"datetime":eK(r,"date-time",a.message,t);break;case"date":eK(r,"date",a.message,t);break;case"time":eK(r,"time",a.message,t);break;case"duration":eK(r,"duration",a.message,t);break;case"length":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"includes":eW(r,RegExp(eB(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&eK(r,"ipv4",a.message,t),"v4"!==a.version&&eK(r,"ipv6",a.message,t);break;case"base64url":eW(r,eD.base64url,a.message,t);break;case"jwt":eW(r,eD.jwt,a.message,t);break;case"cidr":"v6"!==a.version&&eW(r,eD.ipv4Cidr,a.message,t),"v4"!==a.version&&eW(r,eD.ipv6Cidr,a.message,t);break;case"emoji":eW(r,eD.emoji(),a.message,t);break;case"ulid":eW(r,eD.ulid,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":eK(r,"binary",a.message,t);break;case"contentEncoding:base64":r.contentEncoding="base64";break;case"pattern:zod":eW(r,eD.base64,a.message,t)}break;case"nanoid":eW(r,eD.nanoid,a.message,t)}return r}function eB(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)eV.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}var eV=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function eK(e,t,r,a){var n;e.format||(null==(n=e.anyOf)?void 0:n.some(e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function eW(e,t,r,a){var n;e.pattern||(null==(n=e.allOf)?void 0:n.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:eG(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=eG(t,a)}function eG(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;let a={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=a.i?e.source.toLowerCase():e.source,i="",s=!1,o=!1,l=!1;for(let e=0;e<n.length;e++){if(s){i+=n[e],s=!1;continue}if(a.i){if(o){if(n[e].match(/[a-z]/)){l?(i+=n[e]+`${n[e-2]}-${n[e]}`.toUpperCase(),l=!1):"-"===n[e+1]&&(null==(r=n[e+2])?void 0:r.match(/[a-z]/))?(i+=n[e],l=!0):i+=`${n[e]}${n[e].toUpperCase()}`;continue}}else if(n[e].match(/[a-z]/)){i+=`[${n[e]}${n[e].toUpperCase()}]`;continue}}if(a.m){if("^"===n[e]){i+=`(^|(?<=[\r
]))`;continue}if("$"===n[e]){i+=`($|(?=[\r
]))`;continue}}if(a.s&&"."===n[e]){i+=o?`${n[e]}\r
`:`[${n[e]}\r
]`;continue}i+=n[e],"\\"===n[e]?s=!0:o&&"]"===n[e]?o=!1:o||"["!==n[e]||(o=!0)}try{new RegExp(i)}catch(r){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return i}function eJ(e,t){var r,a,n,i,s,o;let l={type:"object",additionalProperties:null!=(r=e4(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))?r:t.allowedAdditionalProperties};if((null==(a=e.keyType)?void 0:a._def.typeName)===ZodFirstPartyTypeKind2.ZodString&&(null==(n=e.keyType._def.checks)?void 0:n.length)){let{type:r,...a}=eq(e.keyType._def,t);return{...l,propertyNames:a}}if((null==(i=e.keyType)?void 0:i._def.typeName)===ZodFirstPartyTypeKind2.ZodEnum)return{...l,propertyNames:{enum:e.keyType._def.values}};if((null==(s=e.keyType)?void 0:s._def.typeName)===ZodFirstPartyTypeKind2.ZodBranded&&e.keyType._def.type._def.typeName===ZodFirstPartyTypeKind2.ZodString&&(null==(o=e.keyType._def.type._def.checks)?void 0:o.length)){let{type:r,...a}=ez(e.keyType._def,t);return{...l,propertyNames:a}}return l}var eH={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},eX=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>e4(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},eY=(e,t)=>{var r;if(t.currentPath.toString()===(null==(r=t.propertyPath)?void 0:r.toString()))return e4(e.innerType._def,t);let a=e4(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return a?{anyOf:[{not:{}},a]}:{}},eQ=(e,t)=>{if("input"===t.pipeStrategy)return e4(e.in._def,t);if("output"===t.pipeStrategy)return e4(e.out._def,t);let r=e4(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),a=e4(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(e=>void 0!==e)}},e0=(e,t)=>e4(e.innerType._def,t),e1=(e,t,r)=>{switch(t){case ZodFirstPartyTypeKind3.ZodString:return eq(e,r);case ZodFirstPartyTypeKind3.ZodNumber:return function(e){let t={type:"number"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"int":t.type="integer";break;case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case ZodFirstPartyTypeKind3.ZodObject:return function(e,t){let r={type:"object",properties:{}},a=[],n=e.shape();for(let e in n){let i=n[e];if(void 0===i||void 0===i._def)continue;let s=function(e){try{return e.isOptional()}catch(e){return!0}}(i),o=e4(i._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==o&&(r.properties[e]=o,s||a.push(e))}a.length&&(r.required=a);let i=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return e4(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==i&&(r.additionalProperties=i),r}(e,r);case ZodFirstPartyTypeKind3.ZodBigInt:return function(e){let t={type:"integer",format:"int64"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case ZodFirstPartyTypeKind3.ZodBoolean:return{type:"boolean"};case ZodFirstPartyTypeKind3.ZodDate:return function e(t,r,a){let n=null!=a?a:r.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((a,n)=>e(t,r,a))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return eM(t)}}(e,r);case ZodFirstPartyTypeKind3.ZodUndefined:return{not:{}};case ZodFirstPartyTypeKind3.ZodNull:return{type:"null"};case ZodFirstPartyTypeKind3.ZodArray:return function(e,t){var r,a,n;let i={type:"array"};return(null==(r=e.type)?void 0:r._def)&&(null==(n=null==(a=e.type)?void 0:a._def)?void 0:n.typeName)!==ZodFirstPartyTypeKind.ZodAny&&(i.items=e4(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(i.minItems=e.minLength.value),e.maxLength&&(i.maxItems=e.maxLength.value),e.exactLength&&(i.minItems=e.exactLength.value,i.maxItems=e.exactLength.value),i}(e,r);case ZodFirstPartyTypeKind3.ZodUnion:case ZodFirstPartyTypeKind3.ZodDiscriminatedUnion:return function(e,t){let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in eH&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=eH[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return eX(e,t)}(e,r);case ZodFirstPartyTypeKind3.ZodIntersection:return function(e,t){let r=[e4(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),e4(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),a=[];return r.forEach(e=>{if(eU(e))a.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}a.push(t)}}),a.length?{allOf:a}:void 0}(e,r);case ZodFirstPartyTypeKind3.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>e4(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:e4(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>e4(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case ZodFirstPartyTypeKind3.ZodRecord:return eJ(e,r);case ZodFirstPartyTypeKind3.ZodLiteral:return function(e){let t=typeof e.value;return"bigint"!==t&&"number"!==t&&"boolean"!==t&&"string"!==t?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===t?"integer":t,const:e.value}}(e);case ZodFirstPartyTypeKind3.ZodEnum:return{type:"string",enum:Array.from(e.values)};case ZodFirstPartyTypeKind3.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),a=Array.from(new Set(r.map(e=>typeof e)));return{type:1===a.length?"string"===a[0]?"string":"number":["string","number"],enum:r}}(e);case ZodFirstPartyTypeKind3.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[eH[e.innerType._def.typeName],"null"]};let r=e4(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case ZodFirstPartyTypeKind3.ZodOptional:return eY(e,r);case ZodFirstPartyTypeKind3.ZodMap:return function(e,t){return"record"===t.mapStrategy?eJ(e,t):{type:"array",maxItems:125,items:{type:"array",items:[e4(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},e4(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case ZodFirstPartyTypeKind3.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:e4(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(r.minItems=e.minSize.value),e.maxSize&&(r.maxItems=e.maxSize.value),r}(e,r);case ZodFirstPartyTypeKind3.ZodLazy:return()=>e.getter()._def;case ZodFirstPartyTypeKind3.ZodPromise:return e4(e.type._def,r);case ZodFirstPartyTypeKind3.ZodNaN:case ZodFirstPartyTypeKind3.ZodNever:return{not:{}};case ZodFirstPartyTypeKind3.ZodEffects:return function(e,t){return"input"===t.effectStrategy?e4(e.schema._def,t):{}}(e,r);case ZodFirstPartyTypeKind3.ZodAny:case ZodFirstPartyTypeKind3.ZodUnknown:return{};case ZodFirstPartyTypeKind3.ZodDefault:return function(e,t){return{...e4(e.innerType._def,t),default:e.defaultValue()}}(e,r);case ZodFirstPartyTypeKind3.ZodBranded:return ez(e,r);case ZodFirstPartyTypeKind3.ZodReadonly:return e0(e,r);case ZodFirstPartyTypeKind3.ZodCatch:return eF(e,r);case ZodFirstPartyTypeKind3.ZodPipeline:return eQ(e,r);case ZodFirstPartyTypeKind3.ZodFunction:case ZodFirstPartyTypeKind3.ZodVoid:case ZodFirstPartyTypeKind3.ZodSymbol:default:return}};function e4(e,t,r=!1){var a;let n=t.seen.get(e);if(t.override){let i=null==(a=t.override)?void 0:a.call(t,e,t,n,r);if(i!==eN)return i}if(n&&!r){let e=e2(n,t);if(void 0!==e)return e}let i={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,i);let s=e1(e,e.typeName,t),o="function"==typeof s?e4(s(),t):s;if(o&&e9(e,t,o),t.postProcess){let r=t.postProcess(o,e,t);return i.jsonSchema=o,r}return i.jsonSchema=o,o}var e2=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:ej(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},e9=(e,t,r)=>(e.description&&(r.description=e.description),r),{btoa:e3,atob:e6}=(Symbol.for("vercel.ai.schema"),globalThis),e5=r(9411);function e8(e){var t,r;return null!=(r=null==(t=null==e?void 0:e.providerOptions)?void 0:t.openaiCompatible)?r:{}}function e7({id:e,model:t,created:r}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function te(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var tt=e5.Ry({user:e5.Z_().optional(),reasoningEffort:e5.Z_().optional(),textVerbosity:e5.Z_().optional()}),tr={errorSchema:e5.Ry({error:e5.Ry({message:e5.Z_(),type:e5.Z_().nullish(),param:e5.Yj().nullish(),code:e5.G0([e5.Z_(),e5.Rx()]).nullish()})}),errorToMessage:e=>e.error.message},ta=class{constructor(e,t){var r,a;this.specificationVersion="v2",this.modelId=e,this.config=t;let n=null!=(r=t.errorStructure)?r:tr;this.chunkSchema=ts(n.errorSchema),this.failedResponseHandler=eP(n),this.supportsStructuredOutputs=null!=(a=t.supportsStructuredOutputs)&&a}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}get supportedUrls(){var e,t,r;return null!=(r=null==(t=(e=this.config).supportedUrls)?void 0:t.call(e))?r:{}}async getArgs({prompt:e,maxOutputTokens:t,temperature:r,topP:a,topK:n,frequencyPenalty:i,presencePenalty:s,providerOptions:o,stopSequences:l,responseFormat:u,seed:c,toolChoice:d,tools:h}){var p,f,m,y;let g=[],v=Object.assign(null!=(p=await eA({provider:"openai-compatible",providerOptions:o,schema:tt}))?p:{},null!=(f=await eA({provider:this.providerOptionsName,providerOptions:o,schema:tt}))?f:{});null!=n&&g.push({type:"unsupported-setting",setting:"topK"}),(null==u?void 0:u.type)!=="json"||null==u.schema||this.supportsStructuredOutputs||g.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let{tools:_,toolChoice:b,toolWarnings:w}=function({tools:e,toolChoice:t}){e=(null==e?void 0:e.length)?e:void 0;let r=[];if(null==e)return{tools:void 0,toolChoice:void 0,toolWarnings:r};let a=[];for(let t of e)"provider-defined"===t.type?r.push({type:"unsupported-tool",tool:t}):a.push({type:"function",function:{name:t.name,description:t.description,parameters:t.inputSchema}});if(null==t)return{tools:a,toolChoice:void 0,toolWarnings:r};let n=t.type;switch(n){case"auto":case"none":case"required":return{tools:a,toolChoice:n,toolWarnings:r};case"tool":return{tools:a,toolChoice:{type:"function",function:{name:t.toolName}},toolWarnings:r};default:throw new el({functionality:`tool choice type: ${n}`})}}({tools:h,toolChoice:d});return{args:{model:this.modelId,user:v.user,max_tokens:t,temperature:r,top_p:a,frequency_penalty:i,presence_penalty:s,response_format:(null==u?void 0:u.type)==="json"?!0===this.supportsStructuredOutputs&&null!=u.schema?{type:"json_schema",json_schema:{schema:u.schema,name:null!=(m=u.name)?m:"response",description:u.description}}:{type:"json_object"}:void 0,stop:l,seed:c,...Object.fromEntries(Object.entries(null!=(y=null==o?void 0:o[this.providerOptionsName])?y:{}).filter(([e])=>!Object.keys(tt.shape).includes(e))),reasoning_effort:v.reasoningEffort,verbosity:v.textVerbosity,messages:function(e){let t=[];for(let{role:r,content:a,...n}of e){let e=e8({...n});switch(r){case"system":t.push({role:"system",content:a,...e});break;case"user":if(1===a.length&&"text"===a[0].type){t.push({role:"user",content:a[0].text,...e8(a[0])});break}t.push({role:"user",content:a.map(e=>{let t=e8(e);switch(e.type){case"text":return{type:"text",text:e.text,...t};case"file":if(e.mediaType.startsWith("image/")){var r;let a="image/*"===e.mediaType?"image/jpeg":e.mediaType;return{type:"image_url",image_url:{url:e.data instanceof URL?e.data.toString():`data:${a};base64,${(r=e.data)instanceof Uint8Array?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return e3(t)}(r):r}`},...t}}throw new el({functionality:`file part media type ${e.mediaType}`})}}),...e});break;case"assistant":{let r="",n="",i=[];for(let e of a){let t=e8(e);switch(e.type){case"text":r+=e.text;break;case"reasoning":n+=e.text;break;case"tool-call":i.push({id:e.toolCallId,type:"function",function:{name:e.toolName,arguments:JSON.stringify(e.input)},...t})}}t.push({role:"assistant",content:r,...n.length>0?{reasoning_content:n}:{},tool_calls:i.length>0?i:void 0,...e});break}case"tool":for(let e of a){let r;let a=e.output;switch(a.type){case"text":case"error-text":r=a.value;break;case"content":case"json":case"error-json":r=JSON.stringify(a.value)}let n=e8(e);t.push({role:"tool",tool_call_id:e.toolCallId,content:r,...n})}break;default:throw Error(`Unsupported role: ${r}`)}}return t}(e),tools:_,tool_choice:b},warnings:[...g,...w]}}async doGenerate(e){var t,r,a,n,i,s,o,l,u,c,d,h,p,f,m,y,g;let{args:v,warnings:_}=await this.getArgs({...e}),b=JSON.stringify(v),{responseHeaders:w,value:k,rawValue:T}=await eO({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:ed(this.config.headers(),e.headers),body:v,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:eC(ti),abortSignal:e.abortSignal,fetch:this.config.fetch}),x=k.choices[0],S=[],I=x.message.content;null!=I&&I.length>0&&S.push({type:"text",text:I});let A=null!=(t=x.message.reasoning_content)?t:x.message.reasoning;if(null!=A&&A.length>0&&S.push({type:"reasoning",text:A}),null!=x.message.tool_calls)for(let e of x.message.tool_calls)S.push({type:"tool-call",toolCallId:null!=(r=e.id)?r:ep(),toolName:e.function.name,input:e.function.arguments});let E={[this.providerOptionsName]:{},...await (null==(n=null==(a=this.config.metadataExtractor)?void 0:a.extractMetadata)?void 0:n.call(a,{parsedBody:T}))},O=null==(i=k.usage)?void 0:i.completion_tokens_details;return(null==O?void 0:O.accepted_prediction_tokens)!=null&&(E[this.providerOptionsName].acceptedPredictionTokens=null==O?void 0:O.accepted_prediction_tokens),(null==O?void 0:O.rejected_prediction_tokens)!=null&&(E[this.providerOptionsName].rejectedPredictionTokens=null==O?void 0:O.rejected_prediction_tokens),{content:S,finishReason:te(x.finish_reason),usage:{inputTokens:null!=(o=null==(s=k.usage)?void 0:s.prompt_tokens)?o:void 0,outputTokens:null!=(u=null==(l=k.usage)?void 0:l.completion_tokens)?u:void 0,totalTokens:null!=(d=null==(c=k.usage)?void 0:c.total_tokens)?d:void 0,reasoningTokens:null!=(f=null==(p=null==(h=k.usage)?void 0:h.completion_tokens_details)?void 0:p.reasoning_tokens)?f:void 0,cachedInputTokens:null!=(g=null==(y=null==(m=k.usage)?void 0:m.prompt_tokens_details)?void 0:y.cached_tokens)?g:void 0},providerMetadata:E,request:{body:b},response:{...e7(k),headers:w,body:T},warnings:_}}async doStream(e){var t;let{args:r,warnings:a}=await this.getArgs({...e}),n={...r,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=null==(t=this.config.metadataExtractor)?void 0:t.createStreamExtractor(),{responseHeaders:s,value:o}=await eO({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:ed(this.config.headers(),e.headers),body:n,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:e$(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),l=[],u="unknown",c={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0},totalTokens:void 0},d=!0,h=this.providerOptionsName,p=!1,f=!1;return{stream:o.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:a})},transform(t,r){var a,n,s,o,h,m,y,g,v,_,b,w,k;if(e.includeRawChunks&&r.enqueue({type:"raw",rawValue:t.rawValue}),!t.success){u="error",r.enqueue({type:"error",error:t.error});return}let T=t.value;if(null==i||i.processChunk(t.rawValue),"error"in T){u="error",r.enqueue({type:"error",error:T.error.message});return}if(d&&(d=!1,r.enqueue({type:"response-metadata",...e7(T)})),null!=T.usage){let{prompt_tokens:e,completion_tokens:t,total_tokens:r,prompt_tokens_details:a,completion_tokens_details:n}=T.usage;c.promptTokens=null!=e?e:void 0,c.completionTokens=null!=t?t:void 0,c.totalTokens=null!=r?r:void 0,(null==n?void 0:n.reasoning_tokens)!=null&&(c.completionTokensDetails.reasoningTokens=null==n?void 0:n.reasoning_tokens),(null==n?void 0:n.accepted_prediction_tokens)!=null&&(c.completionTokensDetails.acceptedPredictionTokens=null==n?void 0:n.accepted_prediction_tokens),(null==n?void 0:n.rejected_prediction_tokens)!=null&&(c.completionTokensDetails.rejectedPredictionTokens=null==n?void 0:n.rejected_prediction_tokens),(null==a?void 0:a.cached_tokens)!=null&&(c.promptTokensDetails.cachedTokens=null==a?void 0:a.cached_tokens)}let x=T.choices[0];if((null==x?void 0:x.finish_reason)!=null&&(u=te(x.finish_reason)),(null==x?void 0:x.delta)==null)return;let S=x.delta,I=null!=(a=S.reasoning_content)?a:S.reasoning;if(I&&(p||(r.enqueue({type:"reasoning-start",id:"reasoning-0"}),p=!0),r.enqueue({type:"reasoning-delta",id:"reasoning-0",delta:I})),S.content&&(f||(r.enqueue({type:"text-start",id:"txt-0"}),f=!0),r.enqueue({type:"text-delta",id:"txt-0",delta:S.content})),null!=S.tool_calls)for(let e of S.tool_calls){let t=e.index;if(null==l[t]){if(null==e.id)throw new K({data:e,message:"Expected 'id' to be a string."});if((null==(n=e.function)?void 0:n.name)==null)throw new K({data:e,message:"Expected 'function.name' to be a string."});r.enqueue({type:"tool-input-start",id:e.id,toolName:e.function.name}),l[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(s=e.function.arguments)?s:""},hasFinished:!1};let a=l[t];(null==(o=a.function)?void 0:o.name)!=null&&(null==(h=a.function)?void 0:h.arguments)!=null&&(a.function.arguments.length>0&&r.enqueue({type:"tool-input-delta",id:a.id,delta:a.function.arguments}),eI(a.function.arguments)&&(r.enqueue({type:"tool-input-end",id:a.id}),r.enqueue({type:"tool-call",toolCallId:null!=(m=a.id)?m:ep(),toolName:a.function.name,input:a.function.arguments}),a.hasFinished=!0));continue}let a=l[t];!a.hasFinished&&((null==(y=e.function)?void 0:y.arguments)!=null&&(a.function.arguments+=null!=(v=null==(g=e.function)?void 0:g.arguments)?v:""),r.enqueue({type:"tool-input-delta",id:a.id,delta:null!=(_=e.function.arguments)?_:""}),(null==(b=a.function)?void 0:b.name)!=null&&(null==(w=a.function)?void 0:w.arguments)!=null&&eI(a.function.arguments)&&(r.enqueue({type:"tool-input-end",id:a.id}),r.enqueue({type:"tool-call",toolCallId:null!=(k=a.id)?k:ep(),toolName:a.function.name,input:a.function.arguments}),a.hasFinished=!0))}},flush(e){var t,r,a,n,s,o;for(let r of(p&&e.enqueue({type:"reasoning-end",id:"reasoning-0"}),f&&e.enqueue({type:"text-end",id:"txt-0"}),l.filter(e=>!e.hasFinished)))e.enqueue({type:"tool-input-end",id:r.id}),e.enqueue({type:"tool-call",toolCallId:null!=(t=r.id)?t:ep(),toolName:r.function.name,input:r.function.arguments});let d={[h]:{},...null==i?void 0:i.buildMetadata()};null!=c.completionTokensDetails.acceptedPredictionTokens&&(d[h].acceptedPredictionTokens=c.completionTokensDetails.acceptedPredictionTokens),null!=c.completionTokensDetails.rejectedPredictionTokens&&(d[h].rejectedPredictionTokens=c.completionTokensDetails.rejectedPredictionTokens),e.enqueue({type:"finish",finishReason:u,usage:{inputTokens:null!=(r=c.promptTokens)?r:void 0,outputTokens:null!=(a=c.completionTokens)?a:void 0,totalTokens:null!=(n=c.totalTokens)?n:void 0,reasoningTokens:null!=(s=c.completionTokensDetails.reasoningTokens)?s:void 0,cachedInputTokens:null!=(o=c.promptTokensDetails.cachedTokens)?o:void 0},providerMetadata:d})}})),request:{body:n},response:{headers:s}}}},tn=e5.Ry({prompt_tokens:e5.Rx().nullish(),completion_tokens:e5.Rx().nullish(),total_tokens:e5.Rx().nullish(),prompt_tokens_details:e5.Ry({cached_tokens:e5.Rx().nullish()}).nullish(),completion_tokens_details:e5.Ry({reasoning_tokens:e5.Rx().nullish(),accepted_prediction_tokens:e5.Rx().nullish(),rejected_prediction_tokens:e5.Rx().nullish()}).nullish()}).nullish(),ti=e5.Ry({id:e5.Z_().nullish(),created:e5.Rx().nullish(),model:e5.Z_().nullish(),choices:e5.IX(e5.Ry({message:e5.Ry({role:e5.i0("assistant").nullish(),content:e5.Z_().nullish(),reasoning_content:e5.Z_().nullish(),reasoning:e5.Z_().nullish(),tool_calls:e5.IX(e5.Ry({id:e5.Z_().nullish(),function:e5.Ry({name:e5.Z_(),arguments:e5.Z_()})})).nullish()}),finish_reason:e5.Z_().nullish()})),usage:tn}),ts=e=>e5.G0([e5.Ry({id:e5.Z_().nullish(),created:e5.Rx().nullish(),model:e5.Z_().nullish(),choices:e5.IX(e5.Ry({delta:e5.Ry({role:e5.Km(["assistant"]).nullish(),content:e5.Z_().nullish(),reasoning_content:e5.Z_().nullish(),reasoning:e5.Z_().nullish(),tool_calls:e5.IX(e5.Ry({index:e5.Rx(),id:e5.Z_().nullish(),function:e5.Ry({name:e5.Z_().nullish(),arguments:e5.Z_().nullish()})})).nullish()}).nullish(),finish_reason:e5.Z_().nullish()})),usage:tn}),e]);function to({id:e,model:t,created:r}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function tl(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var tu=e5.Ry({echo:e5.O7().optional(),logitBias:e5.IM(e5.Z_(),e5.Rx()).optional(),suffix:e5.Z_().optional(),user:e5.Z_().optional()}),tc=class{constructor(e,t){var r;this.specificationVersion="v2",this.modelId=e,this.config=t;let a=null!=(r=t.errorStructure)?r:tr;this.chunkSchema=tp(a.errorSchema),this.failedResponseHandler=eP(a)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}get supportedUrls(){var e,t,r;return null!=(r=null==(t=(e=this.config).supportedUrls)?void 0:t.call(e))?r:{}}async getArgs({prompt:e,maxOutputTokens:t,temperature:r,topP:a,topK:n,frequencyPenalty:i,presencePenalty:s,stopSequences:o,responseFormat:l,seed:u,providerOptions:c,tools:d,toolChoice:h}){var p;let f=[],m=null!=(p=await eA({provider:this.providerOptionsName,providerOptions:c,schema:tu}))?p:{};null!=n&&f.push({type:"unsupported-setting",setting:"topK"}),(null==d?void 0:d.length)&&f.push({type:"unsupported-setting",setting:"tools"}),null!=h&&f.push({type:"unsupported-setting",setting:"toolChoice"}),null!=l&&"text"!==l.type&&f.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:y,stopSequences:g}=function({prompt:e,user:t="user",assistant:r="assistant"}){let a="";for(let{role:n,content:i}of("system"===e[0].role&&(a+=`${e[0].content}

`,e=e.slice(1)),e))switch(n){case"system":throw new D({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=i.map(e=>{if("text"===e.type)return e.text}).filter(Boolean).join("");a+=`${t}:
${e}

`;break}case"assistant":{let e=i.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new el({functionality:"tool-call messages"})}}).join("");a+=`${r}:
${e}

`;break}case"tool":throw new el({functionality:"tool messages"});default:throw Error(`Unsupported role: ${n}`)}return{prompt:a+=`${r}:
`,stopSequences:[`
${t}:`]}}({prompt:e}),v=[...null!=g?g:[],...null!=o?o:[]];return{args:{model:this.modelId,echo:m.echo,logit_bias:m.logitBias,suffix:m.suffix,user:m.user,max_tokens:t,temperature:r,top_p:a,frequency_penalty:i,presence_penalty:s,seed:u,...null==c?void 0:c[this.providerOptionsName],prompt:y,stop:v.length>0?v:void 0},warnings:f}}async doGenerate(e){var t,r,a,n,i,s;let{args:o,warnings:l}=await this.getArgs(e),{responseHeaders:u,value:c,rawValue:d}=await eO({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:ed(this.config.headers(),e.headers),body:o,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:eC(th),abortSignal:e.abortSignal,fetch:this.config.fetch}),h=c.choices[0],p=[];return null!=h.text&&h.text.length>0&&p.push({type:"text",text:h.text}),{content:p,usage:{inputTokens:null!=(r=null==(t=c.usage)?void 0:t.prompt_tokens)?r:void 0,outputTokens:null!=(n=null==(a=c.usage)?void 0:a.completion_tokens)?n:void 0,totalTokens:null!=(s=null==(i=c.usage)?void 0:i.total_tokens)?s:void 0},finishReason:tl(h.finish_reason),request:{body:o},response:{...to(c),headers:u,body:d},warnings:l}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),a={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:n,value:i}=await eO({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:ed(this.config.headers(),e.headers),body:a,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:e$(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),s="unknown",o={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},l=!0;return{stream:i.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:r})},transform(t,r){var a,n,i;if(e.includeRawChunks&&r.enqueue({type:"raw",rawValue:t.rawValue}),!t.success){s="error",r.enqueue({type:"error",error:t.error});return}let u=t.value;if("error"in u){s="error",r.enqueue({type:"error",error:u.error});return}l&&(l=!1,r.enqueue({type:"response-metadata",...to(u)}),r.enqueue({type:"text-start",id:"0"})),null!=u.usage&&(o.inputTokens=null!=(a=u.usage.prompt_tokens)?a:void 0,o.outputTokens=null!=(n=u.usage.completion_tokens)?n:void 0,o.totalTokens=null!=(i=u.usage.total_tokens)?i:void 0);let c=u.choices[0];(null==c?void 0:c.finish_reason)!=null&&(s=tl(c.finish_reason)),(null==c?void 0:c.text)!=null&&r.enqueue({type:"text-delta",id:"0",delta:c.text})},flush(e){l||e.enqueue({type:"text-end",id:"0"}),e.enqueue({type:"finish",finishReason:s,usage:o})}})),request:{body:a},response:{headers:n}}}},td=e5.Ry({prompt_tokens:e5.Rx(),completion_tokens:e5.Rx(),total_tokens:e5.Rx()}),th=e5.Ry({id:e5.Z_().nullish(),created:e5.Rx().nullish(),model:e5.Z_().nullish(),choices:e5.IX(e5.Ry({text:e5.Z_(),finish_reason:e5.Z_()})),usage:td.nullish()}),tp=e=>e5.G0([e5.Ry({id:e5.Z_().nullish(),created:e5.Rx().nullish(),model:e5.Z_().nullish(),choices:e5.IX(e5.Ry({text:e5.Z_(),finish_reason:e5.Z_().nullish(),index:e5.Rx()})),usage:td.nullish()}),e]),tf=e5.Ry({dimensions:e5.Rx().optional(),user:e5.Z_().optional()}),tm=class{constructor(e,t){this.specificationVersion="v2",this.modelId=e,this.config=t}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.config.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){var e;return null==(e=this.config.supportsParallelCalls)||e}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}async doEmbed({values:e,headers:t,abortSignal:r,providerOptions:a}){var n,i,s;let o=Object.assign(null!=(n=await eA({provider:"openai-compatible",providerOptions:a,schema:tf}))?n:{},null!=(i=await eA({provider:this.providerOptionsName,providerOptions:a,schema:tf}))?i:{});if(e.length>this.maxEmbeddingsPerCall)throw new ee({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:l,value:u,rawValue:c}=await eO({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:ed(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:o.dimensions,user:o.user},failedResponseHandler:eP(null!=(s=this.config.errorStructure)?s:tr),successfulResponseHandler:eC(ty),abortSignal:r,fetch:this.config.fetch});return{embeddings:u.data.map(e=>e.embedding),usage:u.usage?{tokens:u.usage.prompt_tokens}:void 0,providerMetadata:u.providerMetadata,response:{headers:l,body:c}}}},ty=e5.Ry({data:e5.IX(e5.Ry({embedding:e5.IX(e5.Rx())})),usage:e5.Ry({prompt_tokens:e5.Rx()}).nullish(),providerMetadata:e5.IM(e5.Z_(),e5.IM(e5.Z_(),e5.Yj())).optional()}),tg=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.maxImagesPerCall=10}get provider(){return this.config.provider}get providerOptionsKey(){return this.config.provider.split(".")[0].trim()}async doGenerate({prompt:e,n:t,size:r,aspectRatio:a,seed:n,providerOptions:i,headers:s,abortSignal:o}){var l,u,c,d;let h=[];null!=a&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=n&&h.push({type:"unsupported-setting",setting:"seed"});let p=null!=(c=null==(u=null==(l=this.config._internal)?void 0:l.currentDate)?void 0:u.call(l))?c:new Date,{value:f,responseHeaders:m}=await eO({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:ed(this.config.headers(),s),body:{model:this.modelId,prompt:e,n:t,size:r,...i[this.providerOptionsKey],response_format:"b64_json"},failedResponseHandler:eP(null!=(d=this.config.errorStructure)?d:tr),successfulResponseHandler:eC(tv),abortSignal:o,fetch:this.config.fetch});return{images:f.data.map(e=>e.b64_json),warnings:h,response:{timestamp:p,modelId:this.modelId,headers:m}}}},tv=e5.Ry({data:e5.IX(e5.Ry({b64_json:e5.Z_()}))});function t_(e){var t;let r=null==(t=e.baseURL)?void 0:t.replace(/\/$/,""),a=e.name,n={...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers},i=()=>ey(n,"ai-sdk/openai-compatible/1.0.32"),s=t=>({provider:`${a}.${t}`,url:({path:t})=>{let a=new URL(`${r}${t}`);return e.queryParams&&(a.search=new URLSearchParams(e.queryParams).toString()),a.toString()},headers:i,fetch:e.fetch}),o=e=>l(e),l=t=>new ta(t,{...s("chat"),includeUsage:e.includeUsage,supportsStructuredOutputs:e.supportsStructuredOutputs}),u=e=>o(e);return u.languageModel=o,u.chatModel=l,u.completionModel=t=>new tc(t,{...s("completion"),includeUsage:e.includeUsage}),u.textEmbeddingModel=e=>new tm(e,{...s("embedding")}),u.imageModel=e=>new tg(e,s("image")),u}},7857:(e,t,r)=>{"use strict";let a;function n(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)0>t.indexOf(a[n])&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r}r.d(t,{eI:()=>rp}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;let i=e=>e?(...t)=>e(...t):(...e)=>fetch(...e);class s extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class o extends s{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class l extends s{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class u extends s{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(d||(d={}));class c{constructor(e,{headers:t={},customFetch:r,region:a=d.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=i(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){var t,r,a,n;return t=this,r=arguments,a=void 0,n=function*(e,t={}){var r;let a,n;try{let i;let{headers:s,method:c,body:d,signal:h,timeout:p}=t,f={},{region:m}=t;m||(m=this.region);let y=new URL(`${this.url}/${e}`);m&&"any"!==m&&(f["x-region"]=m,y.searchParams.set("forceFunctionRegion",m)),d&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)?"undefined"!=typeof Blob&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",i=d):"string"==typeof d?(f["Content-Type"]="text/plain",i=d):"undefined"!=typeof FormData&&d instanceof FormData?i=d:(f["Content-Type"]="application/json",i=JSON.stringify(d)):!d||"string"==typeof d||"undefined"!=typeof Blob&&d instanceof Blob||d instanceof ArrayBuffer||"undefined"!=typeof FormData&&d instanceof FormData?i=d:i=JSON.stringify(d);let g=h;p&&(n=new AbortController,a=setTimeout(()=>n.abort(),p),h?(g=n.signal,h.addEventListener("abort",()=>n.abort())):g=n.signal);let v=yield this.fetch(y.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),s),body:i,signal:g}).catch(e=>{throw new o(e)}),_=v.headers.get("x-relay-error");if(_&&"true"===_)throw new l(v);if(!v.ok)throw new u(v);let b=(null!==(r=v.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===b?yield v.json():"application/octet-stream"===b||"application/pdf"===b?yield v.blob():"text/event-stream"===b?v:"multipart/form-data"===b?yield v.formData():yield v.text(),error:null,response:v}}catch(e){return{data:null,error:e,response:e instanceof u||e instanceof l?e.context:void 0}}finally{a&&clearTimeout(a)}},new(a||(a=Promise))(function(e,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof a?r:new a(function(e){e(r)})).then(s,o)}l((n=n.apply(t,r||[])).next())})}}var d,h,p,f,m,y,g,v,_,b,w,k=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},T=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let a=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,a,n,i;let s=null,o=null,l=null,u=e.status,c=e.statusText;if(e.ok){if("HEAD"!==r.method){let t=await e.text();""===t||(o="text/csv"===r.headers.get("Accept")?t:r.headers.get("Accept")&&(null===(n=r.headers.get("Accept"))||void 0===n?void 0:n.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}let i=null===(t=r.headers.get("Prefer"))||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),d=null===(a=e.headers.get("content-range"))||void 0===a?void 0:a.split("/");i&&d&&d.length>1&&(l=parseInt(d[1])),r.isMaybeSingle&&"GET"===r.method&&Array.isArray(o)&&(o.length>1?(s={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{let t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(o=[],s=null,u=200,c="OK")}catch(r){404===e.status&&""===t?(u=204,c="No Content"):s={message:t}}if(s&&r.isMaybeSingle&&(null==s||null===(i=s.details)||void 0===i?void 0:i.includes("0 rows"))&&(s=null,u=200,c="OK"),s&&r.shouldThrowOnError)throw new k(s)}return{error:s,data:o,count:l,status:u,statusText:c}});return this.shouldThrowOnError||(a=a.catch(e=>{var t,r,a,n,i,s;let o="",l=null==e?void 0:e.cause;if(l){let t=null!==(r=null==l?void 0:l.message)&&void 0!==r?r:"",s=null!==(a=null==l?void 0:l.code)&&void 0!==a?a:"";o=`${null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"FetchError"}: ${null==e?void 0:e.message}

Caused by: ${null!==(i=null==l?void 0:l.name)&&void 0!==i?i:"Error"}: ${t}`,s&&(o+=` (${s})`),(null==l?void 0:l.stack)&&(o+=`
${l.stack}`)}else o=null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:"";return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},x=class extends T{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:n=a}={}){let i=n?`${n}.order`:"order",s=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let a=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){let n=void 0===a?"offset":`${a}.offset`,i=void 0===a?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:n=!1,format:i="text"}={}){var s;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(s=this.headers.get("Accept"))&&void 0!==s?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};let S=RegExp("[,()]");var I=class extends x{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&S.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&S.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let n="";"plain"===a?n="pl":"phrase"===a?n="ph":"websearch"===a&&(n="w");let i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},A=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){let{head:r=!1,count:a}=null!=t?t:{},n=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join(""),{url:s,headers:o}=this.cloneRequestState();return s.searchParams.set("select",i),a&&o.append("Prefer",`count=${a}`),new I({method:r?"HEAD":"GET",url:s,headers:o,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;let{url:n,headers:i}=this.cloneRequestState();if(t&&i.append("Prefer",`count=${t}`),r||i.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);n.searchParams.set("columns",e.join(","))}}return new I({method:"POST",url:n,headers:i,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:n=!0}={}){var i;let{url:s,headers:o}=this.cloneRequestState();if(o.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&s.searchParams.set("on_conflict",t),a&&o.append("Prefer",`count=${a}`),n||o.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);s.searchParams.set("columns",e.join(","))}}return new I({method:"POST",url:s,headers:o,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e,{count:t}={}){var r;let{url:a,headers:n}=this.cloneRequestState();return t&&n.append("Prefer",`count=${t}`),new I({method:"PATCH",url:a,headers:n,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete({count:e}={}){var t;let{url:r,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new I({method:"DELETE",url:r,headers:a,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}},E=class e{constructor(e,{headers:t={},schema:r,fetch:a}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=a}from(e){if(!e||"string"!=typeof e||""===e.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new A(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:a=!1,count:n}={}){var i;let s,o;let l=new URL(`${this.url}/rpc/${e}`),u=e=>null!==e&&"object"==typeof e&&(!Array.isArray(e)||e.some(u)),c=r&&Object.values(t).some(u);c?(s="POST",o=t):r||a?(s=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(s="POST",o=t);let d=new Headers(this.headers);return c?d.set("Prefer",n?`count=${n},return=minimal`:"return=minimal"):n&&d.set("Prefer",`count=${n}`),new I({method:s,url:l,headers:d,schema:this.schemaName,body:o,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}};class O{constructor(){}static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};let t=globalThis.process;if(t){let e=t.versions;if(e&&e.node){let t=parseInt(e.node.replace(/^v/,"").split(".")[0]);return t>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}let R="2.0.0";(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(h||(h={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(p||(p={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(f||(f={})),(m||(m={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(y||(y={}));class P{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){return e.event!==this.BROADCAST_EVENT||e.payload instanceof ArrayBuffer||"string"!=typeof e.payload.event?t(JSON.stringify([e.join_ref,e.ref,e.topic,e.event,e.payload])):t(this._binaryEncodeUserBroadcastPush(e))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;let a=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,r;let a=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:{},n=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,n)}_encodeUserBroadcastPush(e,t,r){let a=e.topic,n=null!==(p=e.ref)&&void 0!==p?p:"",i=null!==(f=e.join_ref)&&void 0!==f?f:"",s=e.payload.event,o=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},l=0===Object.keys(o).length?"":JSON.stringify(o);if(i.length>255)throw Error(`joinRef length ${i.length} exceeds maximum of 255`);if(n.length>255)throw Error(`ref length ${n.length} exceeds maximum of 255`);if(a.length>255)throw Error(`topic length ${a.length} exceeds maximum of 255`);if(s.length>255)throw Error(`userEvent length ${s.length} exceeds maximum of 255`);if(l.length>255)throw Error(`metadata length ${l.length} exceeds maximum of 255`);let u=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+n.length+a.length+s.length+l.length,c=new ArrayBuffer(this.HEADER_LENGTH+u),d=new DataView(c),h=0;d.setUint8(h++,this.KINDS.userBroadcastPush),d.setUint8(h++,i.length),d.setUint8(h++,n.length),d.setUint8(h++,a.length),d.setUint8(h++,s.length),d.setUint8(h++,l.length),d.setUint8(h++,t),Array.from(i,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(n,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(a,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(s,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(l,e=>d.setUint8(h++,e.charCodeAt(0)));var p,f,m=new Uint8Array(c.byteLength+r.byteLength);return m.set(new Uint8Array(c),0),m.set(new Uint8Array(r),c.byteLength),m.buffer}decode(e,t){if(this._isArrayBuffer(e))return t(this._binaryDecode(e));if("string"==typeof e){let[r,a,n,i,s]=JSON.parse(e);return t({join_ref:r,ref:a,topic:n,event:i,payload:s})}return t({})}_binaryDecode(e){let t=new DataView(e),r=t.getUint8(0),a=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,a)}_decodeUserBroadcast(e,t,r){let a=t.getUint8(1),n=t.getUint8(2),i=t.getUint8(3),s=t.getUint8(4),o=this.HEADER_LENGTH+4,l=r.decode(e.slice(o,o+a));o+=a;let u=r.decode(e.slice(o,o+n));o+=n;let c=r.decode(e.slice(o,o+i));o+=i;let d=e.slice(o,e.byteLength),h=s===this.JSON_ENCODING?JSON.parse(r.decode(d)):d,p={type:this.BROADCAST_EVENT,event:u,payload:h};return i>0&&(p.meta=JSON.parse(c)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||(null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class ${constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(g||(g={}));let C=(e,t,r={})=>{var a;let n=null!==(a=r.skipTypes)&&void 0!==a?a:[];return t?Object.keys(t).reduce((r,a)=>(r[a]=j(a,e,t,n),r),{}):{}},j=(e,t,r,a)=>{let n=t.find(t=>t.name===e),i=null==n?void 0:n.type,s=r[e];return i&&!a.includes(i)?N(i,s):Z(s)},N=(e,t)=>{if("_"===e.charAt(0))return U(t,e.slice(1,e.length));switch(e){case g.bool:return z(t);case g.float4:case g.float8:case g.int2:case g.int4:case g.int8:case g.numeric:case g.oid:return F(t);case g.json:case g.jsonb:return M(t);case g.timestamp:return L(t);case g.abstime:case g.date:case g.daterange:case g.int4range:case g.int8range:case g.money:case g.reltime:case g.text:case g.time:case g.timestamptz:case g.timetz:case g.tsrange:case g.tstzrange:default:return Z(t)}},Z=e=>e,z=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},F=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},M=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},U=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,a=e[r];if("{"===e[0]&&"}"===a){let a;let n=e.slice(1,r);try{a=JSON.parse("["+n+"]")}catch(e){a=n?n.split(","):[]}return a.map(e=>N(t,e))}return e},L=e=>"string"==typeof e?e.replace(" ","T"):e,D=e=>{let t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class q{constructor(e,t,r={},a=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(v||(v={}));class B{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=B.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=B.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=B.syncDiff(this.state,e,t,r),a())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,a){let n=this.cloneDeep(e),i=this.transformState(t),s={},o={};return this.map(n,(e,t)=>{i[e]||(o[e]=t)}),this.map(i,(e,t)=>{let r=n[e];if(r){let a=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),i=t.filter(e=>0>n.indexOf(e.presence_ref)),l=r.filter(e=>0>a.indexOf(e.presence_ref));i.length>0&&(s[e]=i),l.length>0&&(o[e]=l)}else s[e]=t}),this.syncDiff(n,{joins:s,leaves:o},r,a)}static syncDiff(e,t,r,a){let{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(n,(t,a)=>{var n;let i=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(a),i.length>0){let r=e[t].map(e=>e.presence_ref),a=i.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...a)}r(t,i,a)}),this.map(i,(t,r)=>{let n=e[t];if(!n)return;let i=r.map(e=>e.presence_ref);n=n.filter(e=>0>i.indexOf(e.presence_ref)),e[t]=n,a(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let a=e[r];return"metas"in a?t[r]=a.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(_||(_={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(b||(b={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(w||(w={}));class V{constructor(e,t={config:{}},r){var a,n;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=p.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new q(this,f.join,this.params,this.timeout),this.rejoinTimer=new $(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=p.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=p.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=p.errored,this.rejoinTimer.scheduleTimeout())}),this._on(f.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new B(this),this.broadcastEndpointURL=D(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(n=null===(a=this.params.config)||void 0===a?void 0:a.broadcast)||void 0===n?void 0:n.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,a,n;if(this.socket.isConnected()||this.socket.connect(),this.state==p.closed){let{config:{broadcast:i,presence:s,private:o}}=this.params,l=null!==(a=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==a?a:[],u=!!this.bindings[b.PRESENCE]&&this.bindings[b.PRESENCE].length>0||(null===(n=this.params.config.presence)||void 0===n?void 0:n.enabled)===!0,c={},d={broadcast:i,presence:Object.assign(Object.assign({},s),{enabled:u}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(w.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(w.CLOSED)),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===t){null==e||e(w.SUBSCRIBED);return}{let a=this.bindings.postgres_changes,n=null!==(r=null==a?void 0:a.length)&&void 0!==r?r:0,i=[];for(let r=0;r<n;r++){let n=a[r],{filter:{event:s,schema:o,table:l,filter:u}}=n,c=t&&t[r];if(c&&c.event===s&&V.isFilterValueEqual(c.schema,o)&&V.isFilterValueEqual(c.table,l)&&V.isFilterValueEqual(c.filter,u))i.push(Object.assign(Object.assign({},n),{id:c.id}));else{this.unsubscribe(),this.state=p.errored,null==e||e(w.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=i,e&&e(w.SUBSCRIBED);return}}).receive("error",t=>{this.state=p.errored,null==e||e(w.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(w.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===p.joined&&e===b.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var a;if(null==t)return Promise.reject("Payload is required for httpSend()");let n={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(n.Authorization=`Bearer ${this.socket.accessTokenValue}`);let i={method:"POST",headers:n,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},s=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!==(a=r.timeout)&&void 0!==a?a:this.timeout);if(202===s.status)return{success:!0};let o=s.statusText;try{let e=await s.json();o=e.error||e.message||o}catch(e){}return Promise.reject(Error(o))}async send(e,t={}){var r,a;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var a,n,i;let s=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(n=null===(a=this.params)||void 0===a?void 0:a.config)||void 0===n?void 0:n.broadcast)||void 0===i?void 0:i.ack)||r("ok"),s.receive("ok",()=>r("ok")),s.receive("error",()=>r("error")),s.receive("timeout",()=>r("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:n,payload:i}=e,s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);let o={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await (null===(a=e.body)||void 0===a?void 0:a.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=p.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(f.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{(r=new q(this,f.leave,{},e)).receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=p.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){let a=new AbortController,n=setTimeout(()=>a.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(n),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new q(this,e,t,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var a,n;let i=e.toLocaleLowerCase(),{close:s,error:o,leave:l,join:u}=f;if(r&&[s,o,l,u].indexOf(i)>=0&&r!==this._joinRef())return;let c=this._onMessage(i,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(a=this.bindings.postgres_changes)||void 0===a||a.filter(e=>{var t,r,a;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(a=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===a?void 0:a.toLocaleLowerCase())===i}).map(e=>e.callback(c,r)):null===(n=this.bindings[i])||void 0===n||n.filter(e=>{var r,a,n,s,o,l;if(!["broadcast","presence","postgres_changes"].includes(i))return e.type.toLocaleLowerCase()===i;if("id"in e){let i=e.id,s=null===(r=e.filter)||void 0===r?void 0:r.event;return i&&(null===(a=t.ids)||void 0===a?void 0:a.includes(i))&&("*"===s||(null==s?void 0:s.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{let r=null===(o=null===(s=null==e?void 0:e.filter)||void 0===s?void 0:s.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:a,type:n,errors:i}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:a,eventType:n,new:{},old:{},errors:i}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===p.closed}_isJoined(){return this.state===p.joined}_isJoining(){return this.state===p.joining}_isLeaving(){return this.state===p.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let a=e.toLocaleLowerCase(),n={type:a,filter:t,callback:r};return this.bindings[a]?this.bindings[a].push(n):this.bindings[a]=[n],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var a;return!((null===(a=e.type)||void 0===a?void 0:a.toLocaleLowerCase())===r&&V.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}static isFilterValueEqual(e,t){return(null!=e?e:void 0)===(null!=t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(f.close,{},e)}_onError(e){this._on(f.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=p.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=C(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=C(e.columns,e.old_record)),t}}let K=()=>{},W={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},G=[1e3,2e3,5e3,1e4],J=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class H{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=W.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=K,this.ref=0,this.reconnectTimer=null,this.vsn=R,this.logger=K,this.conn=null,this.sendBuffer=[],this.serializer=new P,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${m.websocket}`,this.httpEndpoint=D(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=O.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting()){if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case h.connecting:return y.Connecting;case h.open:return y.Open;case h.closing:return y.Closing;default:return y.Closed}}isConnected(){return this.connectionState()===y.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){let r=`realtime:${e}`,a=this.getChannels().find(e=>e.topic===r);if(a)return a;{let r=new V(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){let{topic:t,event:r,payload:a,ref:n}=e,i=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${n})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},W.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){let t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(e){this.log("error","error in heartbeat callback",e)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}let{topic:t,event:r,payload:a,ref:n}=e,i=n?`(${n})`:"",s=a.status||"";this.log("receive",`${s} ${t} ${r} ${i}`.trim(),a),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,a,n)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===h.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===h.open||this.conn.readyState===h.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(e){this.log("error","error in heartbeat callback",e)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(f.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${r}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([J],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;let r=!1;if(e)t=e,r=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(e){this.log("error","Error fetching access token from callback",e),t=this.accessTokenValue}else t=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{let r={access_token:t,version:"realtime-js/2.93.3"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(f.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(t){this.log("error",`error in ${e} callback`,t)}})}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new $(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},W.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,a,n,i,s,o,l,u,c,d,h;switch(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:1e4,this.heartbeatIntervalMs=null!==(a=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==a?a:W.HEARTBEAT_INTERVAL,this.worker=null!==(n=null==e?void 0:e.worker)&&void 0!==n&&n,this.accessToken=null!==(i=null==e?void 0:e.accessToken)&&void 0!==i?i:null,this.heartbeatCallback=null!==(s=null==e?void 0:e.heartbeatCallback)&&void 0!==s?s:K,this.vsn=null!==(o=null==e?void 0:e.vsn)&&void 0!==o?o:R,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null==e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>G[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!==(u=null==e?void 0:e.encode)&&void 0!==u?u:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null==e?void 0:e.decode)&&void 0!==c?c:(e,t)=>t(JSON.parse(e));break;case R:this.encode=null!==(d=null==e?void 0:e.encode)&&void 0!==d?d:this.serializer.encode.bind(this.serializer),this.decode=null!==(h=null==e?void 0:e.decode)&&void 0!==h?h:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}var X=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function Y(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}function Q(e){return e.join("\x1f")}var ee=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){let t=e?{parent:Q(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){let r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Q(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Q(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Q(e.namespace)}`}),!0}catch(e){if(e instanceof X&&404===e.status)return!1;throw e}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(e){if(e instanceof X&&409===e.status)return;throw e}}};function et(e){return e.join("\x1f")}var er=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){let r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){let r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){let t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${et(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(e){if(e instanceof X&&404===e.status)return!1;throw e}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof X&&409===r.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},ea=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);let r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=function(e){let t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:i,headers:s}){let o=function(e,t,r){let a=new URL(t,e);if(r)for(let[e,t]of Object.entries(r))void 0!==t&&a.searchParams.set(e,t);return a.toString()}(e.baseUrl,a,n),l=await Y(e.auth),u=await t(o,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...s},body:i?JSON.stringify(i):void 0}),c=await u.text(),d=(u.headers.get("content-type")||"").includes("application/json"),h=d&&c?JSON.parse(c):c;if(!u.ok){let e=d?h:void 0,t=e?.error;throw new X(t?.message??`Request failed with status ${u.status}`,{status:u.status,icebergType:t?.type,icebergCode:t?.code,details:e})}return{status:u.status,headers:u.headers,data:h}}}}({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new ee(this.client,t),this.tableOps=new er(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},en=class extends Error{constructor(e,t="storage",r,a){super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=a}};function ei(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var es=class extends en{constructor(e,t,r,a="storage"){super(e,a,t,r),this.name="vectors"===a?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},eo=class extends en{constructor(e,t,r="storage"){super(e,r),this.name="vectors"===r?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};let el=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),eu=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},ec=e=>{if(Array.isArray(e))return e.map(e=>ec(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=ec(r)}),t},ed=e=>!(!e||"string"!=typeof e||0===e.length||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function eh(e){return(eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ep(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function ef(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ep(Object(r),!0).forEach(function(t){!function(e,t,r){var a;(a=function(e,t){if("object"!=eh(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=eh(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==eh(a)?a:a+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ep(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let em=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},ey=async(e,t,r,a)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==r?void 0:r.noResolveJson)){let r=e.status||500;"function"==typeof e.json?e.json().then(e=>{let n=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||r+"";t(new es(em(e),r,n,a))}).catch(()=>{t(new es(e.statusText||`HTTP ${r} error`,r,r+"",a))}):t(new es(e.statusText||`HTTP ${r} error`,r,r+"",a))}else t(new eo(em(e),e,a))},eg=(e,t,r,a)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&a&&(eu(a)?(n.headers=ef({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,(null==t?void 0:t.duplex)&&(n.duplex=t.duplex)),ef(ef({},n),r)};async function ev(e,t,r,a,n,i,s){return new Promise((o,l)=>{e(r,eg(t,a,n,i)).then(e=>{if(!e.ok)throw e;if(null==a?void 0:a.noResolveJson)return e;if("vectors"===s){let t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status||!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>o(e)).catch(e=>ey(e,l,a,s))})}function e_(e="storage"){return{get:async(t,r,a,n)=>ev(t,"GET",r,a,n,void 0,e),post:async(t,r,a,n,i)=>ev(t,"POST",r,n,i,a,e),put:async(t,r,a,n,i)=>ev(t,"PUT",r,n,i,a,e),head:async(t,r,a,n)=>ev(t,"HEAD",r,ef(ef({},a),{},{noResolveJson:!0}),n,void 0,e),remove:async(t,r,a,n,i)=>ev(t,"DELETE",r,n,i,a,e)}}let{get:eb,post:ew,put:ek,head:eT,remove:ex}=e_("storage"),eS=e_("vectors");var eI=class{constructor(e,t={},r,a="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=el(r),this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ei(e))return{data:null,error:e};throw e}}},eA=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ei(e))return{data:null,error:e};throw e}}};a=Symbol.toStringTag;var eE=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[a]="BlobDownloadBuilder",this.promise=null}asStream(){return new eA(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ei(e))return{data:null,error:e};throw e}}};let eO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eR={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var eP=class extends eI{constructor(e,t={},r,a){super(e,t,a,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,a){var n=this;return n.handleOperation(async()=>{let i;let s=ef(ef({},eR),a),o=ef(ef({},n.headers),"POST"===e&&{"x-upsert":String(s.upsert)}),l=s.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",s.cacheControl),l&&i.append("metadata",n.encodeMetadata(l)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((i=r).has("cacheControl")||i.append("cacheControl",s.cacheControl),l&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=n.toBase64(n.encodeMetadata(l))),("undefined"!=typeof ReadableStream&&i instanceof ReadableStream||i&&"object"==typeof i&&"pipe"in i&&"function"==typeof i.pipe)&&!s.duplex&&(s.duplex="half")),(null==a?void 0:a.headers)&&(o=ef(ef({},o),a.headers));let u=n._removeEmptyFolders(t),c=n._getFinalPath(u),d=await ("PUT"==e?ek:ew)(n.fetch,`${n.url}/object/${c}`,i,ef({headers:o},(null==s?void 0:s.duplex)?{duplex:s.duplex}:{}));return{path:u,id:d.Id,fullPath:d.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var n=this;let i=n._removeEmptyFolders(e),s=n._getFinalPath(i),o=new URL(n.url+`/object/upload/sign/${s}`);return o.searchParams.set("token",t),n.handleOperation(async()=>{let e;let t=ef({upsert:eR.upsert},a),s=ef(ef({},n.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType),{path:i,fullPath:(await ek(n.fetch,o.toString(),e,{headers:s})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let a=r._getFinalPath(e),n=ef({},r.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");let i=await ew(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:n}),s=new URL(r.url+i.url),o=s.searchParams.get("token");if(!o)throw new en("No token returned by API");return{signedUrl:s.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;return a.handleOperation(async()=>await ew(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:a.headers}))}async copy(e,t,r){var a=this;return a.handleOperation(async()=>({path:(await ew(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(e,t,r){var a=this;return a.handleOperation(async()=>{let n=a._getFinalPath(e),i=await ew(a.fetch,`${a.url}/object/sign/${n}`,ef({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:a.headers}),s=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{signedUrl:encodeURI(`${a.url}${i.signedURL}${s}`)}})}async createSignedUrls(e,t,r){var a=this;return a.handleOperation(async()=>{let n=await ew(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return n.map(e=>ef(ef({},e),{},{signedUrl:e.signedURL?encodeURI(`${a.url}${e.signedURL}${i}`):null}))})}download(e,t){let r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=a?`?${a}`:"",i=this._getFinalPath(e);return new eE(()=>eb(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;let r=t._getFinalPath(e);return t.handleOperation(async()=>ec(await eb(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){let t=this._getFinalPath(e);try{return await eT(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ei(e)&&e instanceof eo){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}getPublicUrl(e,t){let r=this._getFinalPath(e),a=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&a.push(n);let i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&a.push(s);let o=a.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await ex(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var a=this;return a.handleOperation(async()=>{let n=ef(ef(ef({},eO),t),{},{prefix:e||""});return await ew(a.fetch,`${a.url}/object/list/${a.bucketId}`,n,{headers:a.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{let a=ef({},e);return await ew(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};let e$={"X-Client-Info":"storage-js/2.93.3"};var eC=class extends eI{constructor(e,t={},r,a){let n=new URL(e);(null==a?void 0:a.useNewHostname)&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),super(n.href.replace(/\/$/,""),ef(ef({},e$),t),r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let r=t.listBucketOptionsToQueryString(e);return await eb(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await eb(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await ew(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await ek(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await ew(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ex(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){let t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},ej=class extends eI{constructor(e,t={},r){super(e.replace(/\/$/,""),ef(ef({},e$),t),r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await ew(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let r=new URLSearchParams;(null==e?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(null==e?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&r.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&r.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&r.set("search",e.search);let a=r.toString(),n=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return await eb(t.fetch,n,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ex(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!ed(e))throw new en("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let r=new ea({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(e,t){let r=e[t];return"function"!=typeof r?r:async(...t)=>{try{return{data:await r.apply(e,t),error:null}}catch(e){if(a)throw e;return{data:null,error:e}}}}})}},eN=class extends eI{constructor(e,t={},r){super(e.replace(/\/$/,""),ef(ef({},e$),{},{"Content-Type":"application/json"},t),r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await eS.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await eS.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},eZ=class extends eI{constructor(e,t={},r){super(e.replace(/\/$/,""),ef(ef({},e$),{},{"Content-Type":"application/json"},t),r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},ez=class extends eI{constructor(e,t={},r){super(e.replace(/\/$/,""),ef(ef({},e$),{},{"Content-Type":"application/json"},t),r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await eS.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},eF=class extends ez{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new eM(this.url,this.headers,e,this.fetch)}async createBucket(e){return super.createBucket.call(this,e)}async getBucket(e){return super.getBucket.call(this,e)}async listBuckets(e={}){return super.listBuckets.call(this,e)}async deleteBucket(e){return super.deleteBucket.call(this,e)}},eM=class extends eN{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){return super.createIndex.call(this,ef(ef({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return super.listIndexes.call(this,ef(ef({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return super.getIndex.call(this,this.vectorBucketName,e)}async deleteIndex(e){return super.deleteIndex.call(this,this.vectorBucketName,e)}index(e){return new eU(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},eU=class extends eZ{constructor(e,t,r,a,n){super(e,t,n),this.vectorBucketName=r,this.indexName=a}async putVectors(e){return super.putVectors.call(this,ef(ef({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(e){return super.getVectors.call(this,ef(ef({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(e={}){return super.listVectors.call(this,ef(ef({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(e){return super.queryVectors.call(this,ef(ef({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(e){return super.deleteVectors.call(this,ef(ef({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},eL=class extends eC{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new eP(this.url,this.headers,e,this.fetch)}get vectors(){return new eF(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ej(this.url+"/iceberg",this.headers,this.fetch)}};let eD="2.93.3",eq={"X-Client-Info":`gotrue-js/${eD}`},eB="X-Supabase-Api-Version",eV={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eK=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class eW extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function eG(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class eJ extends eW{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class eH extends eW{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class eX extends eW{constructor(e,t,r,a){super(e,r,a),this.name=t,this.status=r}}class eY extends eX{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function eQ(e){return eG(e)&&"AuthSessionMissingError"===e.name}class e0 extends eX{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class e1 extends eX{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class e4 extends eX{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class e2 extends eX{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class e9 extends eX{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class e3 extends eX{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function e6(e){return eG(e)&&"AuthRetryableFetchError"===e.name}class e5 extends eX{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class e8 extends eX{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let e7="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),te=" 	\n\r=".split(""),tt=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<te.length;t+=1)e[te[t].charCodeAt(0)]=-2;for(let t=0;t<e7.length;t+=1)e[e7[t].charCodeAt(0)]=t;return e})();function tr(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)r(e7[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)r(e7[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function ta(e,t,r){let a=tt[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===a)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function tn(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=e=>{(function(e,t,r){if(0===t.utf8seq){if(e<=127){r(e);return}for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}})(e,a,r)};for(let t=0;t<e.length;t+=1)ta(e.charCodeAt(t),n,i);return t.join("")}function ti(e){let t=[],r={queue:0,queuedBits:0},a=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)ta(e.charCodeAt(t),r,a);return new Uint8Array(t)}function ts(e){let t=[],r={queue:0,queuedBits:0},a=e=>{t.push(e)};return e.forEach(e=>tr(e,r,a)),tr(null,r,a),t.join("")}let to=()=>"undefined"!=typeof window&&"undefined"!=typeof document,tl={tested:!1,writable:!1},tu=()=>{if(!to())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(tl.tested)return tl.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),tl.tested=!0,tl.writable=!0}catch(e){tl.tested=!0,tl.writable=!1}return tl.writable},tc=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),td=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,th=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},tp=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},tf=async(e,t)=>{await e.removeItem(t)};class tm{constructor(){this.promise=new tm.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function ty(e){let t=e.split(".");if(3!==t.length)throw new e8("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!eK.test(t[e]))throw new e8("JWT not in base64url format");return{header:JSON.parse(tn(t[0])),payload:JSON.parse(tn(t[1])),signature:ti(t[2]),raw:{header:t[0],payload:t[1]}}}async function tg(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function tv(e){return("0"+e.toString(16)).substr(-2)}async function t_(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function tb(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await t_(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function tw(e,t,r=!1){let a=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let a=0;a<56;a++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,tv).join("")}(),n=a;r&&(n+="/PASSWORD_RECOVERY"),await th(e,`${t}-code-verifier`,n);let i=await tb(a),s=a===i?"plain":"s256";return[i,s]}tm.promiseConstructor=Promise;let tk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,tT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tx(e){if(!tT.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function tS(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tI(e){return JSON.parse(JSON.stringify(e))}let tA=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tE=[502,503,504];async function tO(e){var t;let r,a;if(!td(e))throw new e3(tA(e),0);if(tE.includes(e.status))throw new e3(tA(e),e.status);try{r=await e.json()}catch(e){throw new eH(tA(e),e)}let n=function(e){let t=e.headers.get(eB);if(!t||!t.match(tk))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(n&&n.getTime()>=eV["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?a=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(a=r.error_code),a){if("weak_password"===a)throw new e5(tA(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new eY}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new e5(tA(r),e.status,r.weak_password.reasons);throw new eJ(tA(r),e.status||500,a)}let tR=(e,t,r,a)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function tP(e,t,r,a){var n;let i=Object.assign({},null==a?void 0:a.headers);i[eB]||(i[eB]=eV["2024-01-01"].name),(null==a?void 0:a.jwt)&&(i.Authorization=`Bearer ${a.jwt}`);let s=null!==(n=null==a?void 0:a.query)&&void 0!==n?n:{};(null==a?void 0:a.redirectTo)&&(s.redirect_to=a.redirectTo);let o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await t$(e,t,r+o,{headers:i,noResolveJson:null==a?void 0:a.noResolveJson},{},null==a?void 0:a.body);return(null==a?void 0:a.xform)?null==a?void 0:a.xform(l):{data:Object.assign({},l),error:null}}async function t$(e,t,r,a,n,i){let s;let o=tR(t,a,n,i);try{s=await e(r,Object.assign({},o))}catch(e){throw console.error(e),new e3(tA(e),0)}if(s.ok||await tO(s),null==a?void 0:a.noResolveJson)return s;try{return await s.json()}catch(e){await tO(e)}}function tC(e){var t,r;let a=null;return e.access_token&&e.refresh_token&&e.expires_in&&(a=Object.assign({},e),!e.expires_at)&&(a.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)),{data:{session:a,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tj(e){let t=tC(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tN(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tZ(e){return{data:e,error:null}}function tz(e){let{action_link:t,email_otp:r,hashed_token:a,redirect_to:i,verification_type:s}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:a,redirect_to:i,verification_type:s},user:Object.assign({},n(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function tF(e){return e}let tM=["global","local","others"];class tU{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=tc(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=tM[0]){if(0>tM.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${tM.join(", ")}`);try{return await tP(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(eG(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await tP(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tN})}catch(e){if(eG(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=n(e,["options"]),a=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(a.new_email=null==r?void 0:r.newEmail,delete a.newEmail),await tP(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:tz,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(eG(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await tP(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tN})}catch(e){if(eG(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,a,n,i,s,o;try{let l={nextPage:null,lastPage:0,total:0},u=await tP(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(a=null==e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==n?n:""},xform:tF});if(u.error)throw u.error;let c=await u.json(),d=null!==(i=u.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(o=null===(s=u.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(eG(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){tx(e);try{return await tP(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tN})}catch(e){if(eG(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){tx(e);try{return await tP(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tN})}catch(e){if(eG(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){tx(e);try{return await tP(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tN})}catch(e){if(eG(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){tx(e.userId);try{let{data:t,error:r}=await tP(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(eG(e))return{data:null,error:e};throw e}}async _deleteFactor(e){tx(e.userId),tx(e.id);try{return{data:await tP(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(eG(e))return{data:null,error:e};throw e}}async _listOAuthClients(e){var t,r,a,n,i,s,o;try{let l={nextPage:null,lastPage:0,total:0},u=await tP(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(a=null==e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==n?n:""},xform:tF});if(u.error)throw u.error;let c=await u.json(),d=null!==(i=u.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(o=null===(s=u.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(eG(e))return{data:{clients:[]},error:e};throw e}}async _createOAuthClient(e){try{return await tP(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eG(e))return{data:null,error:e};throw e}}async _getOAuthClient(e){try{return await tP(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eG(e))return{data:null,error:e};throw e}}async _updateOAuthClient(e,t){try{return await tP(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eG(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(e){try{return await tP(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(eG(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(e){try{return await tP(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(eG(e))return{data:null,error:e};throw e}}}function tL(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let tD={debug:!!(globalThis&&tu()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class tq extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tB extends tq{}async function tV(e,t,r){tD.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),tD.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async a=>{if(a){tD.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{tD.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(0===t)throw tD.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tB(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(tD.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function tK(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}class tW extends Error{constructor({message:e,code:t,cause:r,name:a}){var n;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!==(n=null!=a?a:r instanceof Error?r.name:void 0)&&void 0!==n?n:"Unknown Error",this.code=t}}class tG extends tW{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}class tJ{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let tH=new tJ;function tX(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function tY(){var e,t;return!!(to()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null===(e=null==navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"==typeof(null===(t=null==navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}async function tQ(e){try{let t=await navigator.credentials.create(e);if(!t)return{data:null,error:new tG("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new tG("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){var r,a,n;let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tW({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null===(r=i.authenticatorSelection)||void 0===r?void 0:r.requireResidentKey)===!0)return new tW({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if("conditional"===t.mediation&&(null===(a=i.authenticatorSelection)||void 0===a?void 0:a.userVerification)==="required")return new tW({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if((null===(n=i.authenticatorSelection)||void 0===n?void 0:n.userVerification)==="required")return new tW({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new tW({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new tW({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new tW(0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!tX(t))return new tW({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rp.id!==t)return new tW({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new tW({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new tW({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new tW({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}async function t0(e){try{let t=await navigator.credentials.get(e);if(!t)return{data:null,error:new tG("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new tG("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tW({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new tW({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!tX(t))return new tW({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new tW({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new tW({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new tW({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}let t1={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},t4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function t2(...e){let t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),a={};for(let n of e)if(n)for(let e in n){let i=n[e];if(void 0!==i){if(Array.isArray(i))a[e]=i;else if(r(i))a[e]=i;else if(t(i)){let r=a[e];t(r)?a[e]=t2(r,i):a[e]=t2(i)}else a[e]=i}}return a}class t9{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:a},n){var i,s,o,l,u;try{let{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:d};let h=null!=a?a:tH.createNewAbortSignal();if("create"===c.webauthn.type){let{user:e}=c.webauthn.credential_options.publicKey;if(!e.name){if(r)e.name=`${e.id}:${r}`;else{let t=(await this.client.getUser()).data.user,r=(null===(i=null==t?void 0:t.user_metadata)||void 0===i?void 0:i.name)||(null==t?void 0:t.email)||(null==t?void 0:t.id)||"User";e.name=`${e.id}:${r}`}}e.displayName||(e.displayName=e.name)}switch(c.webauthn.type){case"create":{let t=(s=c.webauthn.credential_options.publicKey,o=null==n?void 0:n.create,t2(t1,s,o||{})),{data:r,error:a}=await tQ({publicKey:t,signal:h});if(r)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:r}},error:null};return{data:null,error:a}}case"request":{let t=(l=c.webauthn.credential_options.publicKey,u=null==n?void 0:n.request,t2(t4,l,u||{})),{data:r,error:a}=await t0(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:t,signal:h}));if(r)return{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:r}},error:null};return{data:null,error:a}}}}catch(e){if(eG(e))return{data:null,error:e};return{data:null,error:new eH("Unexpected error in challenge",e)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:a}={}},n){if(!t)return{data:null,error:new eW("rpId is required for WebAuthn authentication")};try{if(!tY())return{data:null,error:new eH("Browser does not support WebAuthn",null)};let{data:i,error:s}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:a},{request:n});if(!i)return{data:null,error:s};let{webauthn:o}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:o.type,rpId:t,rpOrigins:r,credential_response:o.credential_response}})}catch(e){if(eG(e))return{data:null,error:e};return{data:null,error:new eH("Unexpected error in authenticate",e)}}}async _register({friendlyName:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:a}={}},n){if(!t)return{data:null,error:new eW("rpId is required for WebAuthn registration")};try{if(!tY())return{data:null,error:new eH("Browser does not support WebAuthn",null)};let{data:i,error:s}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(t=>{var r;return null===(r=t.data)||void 0===r?void 0:r.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:s};let{data:o,error:l}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:a},{create:n});if(!o)return{data:null,error:l};return this._verify({factorId:i.id,challengeId:o.challengeId,webauthn:{rpId:t,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}})}catch(e){if(eG(e))return{data:null,error:e};return{data:null,error:new eH("Unexpected error in register",e)}}}}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let t3={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eq,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function t6(e,t,r){return await r()}let t5={};class t8{get jwks(){var e,t;return null!==(t=null===(e=t5[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){t5[this.storageKey]=Object.assign(Object.assign({},t5[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=t5[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){t5[this.storageKey]=Object.assign(Object.assign({},t5[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;let n=Object.assign(Object.assign({},t3),e);if(this.storageKey=n.storageKey,this.instanceID=null!==(t=t8.nextInstanceID[this.storageKey])&&void 0!==t?t:0,t8.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.instanceID>0&&to()){let e=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=n.persistSession,this.autoRefreshToken=n.autoRefreshToken,this.admin=new tU({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=tc(n.fetch),this.lock=n.lock||t6,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,this.throwOnError=n.throwOnError,this.lockAcquireTimeout=n.lockAcquireTimeout,n.lock?this.lock=n.lock:this.persistSession&&to()&&(null===(r=null==globalThis?void 0:globalThis.navigator)||void 0===r?void 0:r.locks)?this.lock=tV:this.lock=t6,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new t9(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:tu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tL(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=tL(this.memoryStorage)),to()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(a=this.broadcastChannel)||void 0===a||a.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(e){this._debug("#broadcastChannel","error",e)}})}this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${eD}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},r="none";if(to()&&(t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),to()&&this.detectSessionInUrl&&"none"!==r){let{data:a,error:n}=await this._getSessionFromURL(t,r);if(n)return this._debug("#_initialize()","error detecting session from URL",n),eG(n)&&"AuthImplicitGrantRedirectError"===n.name&&(null===(e=n.details)||void 0===e||e.code),{error:n};let{session:i,redirectType:s}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",s),await this._saveSession(i),setTimeout(async()=>{"recovery"===s?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(eG(e))return this._returnResult({error:e});return this._returnResult({error:new eH("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,a;try{let{data:n,error:i}=await tP(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(a=null==e?void 0:e.options)||void 0===a?void 0:a.captchaToken}},xform:tC});if(i||!n)return this._returnResult({data:{user:null,session:null},error:i});let s=n.session,o=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",s)),this._returnResult({data:{user:o,session:s},error:null})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signUp(e){var t,r,a;try{let n;if("email"in e){let{email:r,password:a,options:i}=e,s=null,o=null;"pkce"===this.flowType&&([s,o]=await tw(this.storage,this.storageKey)),n=await tP(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:a,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:s,code_challenge_method:o},xform:tC})}else if("phone"in e){let{phone:t,password:i,options:s}=e;n=await tP(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},channel:null!==(a=null==s?void 0:s.channel)&&void 0!==a?a:"sms",gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:tC})}else throw new e1("You must provide either an email or phone number and a password");let{data:i,error:s}=n;if(s||!i)return await tf(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:s});let o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(await tf(this.storage,`${this.storageKey}-code-verifier`),eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:a,options:n}=e;t=await tP(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:a,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:tj})}else if("phone"in e){let{phone:r,password:a,options:n}=e;t=await tP(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:a,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:tj})}else throw new e1("You must provide either an email or phone number and a password");let{data:r,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!r||!r.session||!r.user){let e=new e0;return this._returnResult({data:{user:null,session:null},error:e})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(e){var t,r,a,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,a,n,i,s,o,l,u,c,d,h;let p,f;if("message"in e)p=e.message,f=e.signature;else{let c;let{chain:d,wallet:m,statement:y,options:g}=e;if(to()){if("object"==typeof m)c=m;else{let e=window;if("ethereum"in e&&"object"==typeof e.ethereum&&"request"in e.ethereum&&"function"==typeof e.ethereum.request)c=e.ethereum;else throw Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof m||!(null==g?void 0:g.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");c=m}let v=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href),_=await c.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||0===_.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let b=tK(_[0]),w=null===(r=null==g?void 0:g.signInWithEthereum)||void 0===r?void 0:r.chainId;w||(w=parseInt(await c.request({method:"eth_chainId"}),16)),p=function(e){var t;let{chainId:r,domain:a,expirationTime:n,issuedAt:i=new Date,nonce:s,notBefore:o,requestId:l,resources:u,scheme:c,uri:d,version:h}=e;if(!Number.isInteger(r))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!d)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);let p=tK(e.address),f=c?`${c}://${a}`:a,m=e.statement?`${e.statement}
`:"",y=`${f} wants you to sign in with your Ethereum account:
${p}

${m}`,g=`URI: ${d}
Version: ${h}
Chain ID: ${r}${s?`
Nonce: ${s}`:""}
Issued At: ${i.toISOString()}`;if(n&&(g+=`
Expiration Time: ${n.toISOString()}`),o&&(g+=`
Not Before: ${o.toISOString()}`),l&&(g+=`
Request ID: ${l}`),u){let e="\nResources:";for(let t of u){if(!t||"string"!=typeof t)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`
- ${t}`}g+=e}return`${y}
${g}`}({domain:v.host,address:b,statement:y,uri:v.href,version:"1",chainId:w,nonce:null===(a=null==g?void 0:g.signInWithEthereum)||void 0===a?void 0:a.nonce,issuedAt:null!==(i=null===(n=null==g?void 0:g.signInWithEthereum)||void 0===n?void 0:n.issuedAt)&&void 0!==i?i:new Date,expirationTime:null===(s=null==g?void 0:g.signInWithEthereum)||void 0===s?void 0:s.expirationTime,notBefore:null===(o=null==g?void 0:g.signInWithEthereum)||void 0===o?void 0:o.notBefore,requestId:null===(l=null==g?void 0:g.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(u=null==g?void 0:g.signInWithEthereum)||void 0===u?void 0:u.resources}),f=await c.request({method:"personal_sign",params:[(h=p,"0x"+Array.from(new TextEncoder().encode(h),e=>e.toString(16).padStart(2,"0")).join("")),b]})}try{let{data:t,error:r}=await tP(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:f},(null===(c=e.options)||void 0===c?void 0:c.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:tC});if(r)throw r;if(!t||!t.session||!t.user){let e=new e0;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSolana(e){var t,r,a,n,i,s,o,l,u,c,d,h;let p,f;if("message"in e)p=e.message,f=e.signature;else{let d;let{chain:h,wallet:m,statement:y,options:g}=e;if(to()){if("object"==typeof m)d=m;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))d=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof m||!(null==g?void 0:g.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");d=m}let v=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in d&&d.signIn){let e;let t=await d.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),y?{statement:y}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)p="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),f=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in d)||"function"!=typeof d.signMessage||!("publicKey"in d)||"object"!=typeof d||!d.publicKey||!("toBase58"in d.publicKey)||"function"!=typeof d.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${v.host} wants you to sign in with your Solana account:`,d.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(a=null===(r=null==g?void 0:g.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==a?a:new Date().toISOString()}`,...(null===(n=null==g?void 0:g.signInWithSolana)||void 0===n?void 0:n.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(s=null==g?void 0:g.signInWithSolana)||void 0===s?void 0:s.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(c=null===(u=null==g?void 0:g.signInWithSolana)||void 0===u?void 0:u.resources)||void 0===c?void 0:c.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await d.signMessage(new TextEncoder().encode(p),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{let{data:t,error:r}=await tP(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ts(f)},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:tC});if(r)throw r;if(!t||!t.session||!t.user){let e=new e0;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _exchangeCodeForSession(e){let t=await tp(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(null!=t?t:"").split("/");try{if(!r&&"pkce"===this.flowType)throw new e9;let{data:t,error:n}=await tP(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:tC});if(await tf(this.storage,`${this.storageKey}-code-verifier`),n)throw n;if(!t||!t.session||!t.user){let e=new e0;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=a?a:null}),error:n})}catch(e){if(await tf(this.storage,`${this.storageKey}-code-verifier`),eG(e))return this._returnResult({data:{user:null,session:null,redirectType:null},error:e});throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:a,access_token:n,nonce:i}=e,{data:s,error:o}=await tP(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:tC});if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!s||!s.session||!s.user){let e=new e0;return this._returnResult({data:{user:null,session:null},error:e})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:s,error:o})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(e){var t,r,a,n,i;try{if("email"in e){let{email:a,options:n}=e,i=null,s=null;"pkce"===this.flowType&&([i,s]=await tw(this.storage,this.storageKey));let{error:o}=await tP(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(r=null==n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:s},redirectTo:null==n?void 0:n.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){let{phone:t,options:r}=e,{data:s,error:o}=await tP(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(a=null==r?void 0:r.data)&&void 0!==a?a:{},create_user:null===(n=null==r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(i=null==r?void 0:r.channel)&&void 0!==i?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:o})}throw new e1("You must provide either an email or phone number.")}catch(e){if(await tf(this.storage,`${this.storageKey}-code-verifier`),eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async verifyOtp(e){var t,r;try{let a,n;"options"in e&&(a=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:i,error:s}=await tP(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:a,xform:tC});if(s)throw s;if(!i)throw Error("An error occurred on token verification.");let o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSSO(e){var t,r,a,n,i;try{let s=null,o=null;"pkce"===this.flowType&&([s,o]=await tw(this.storage,this.storageKey));let l=await tP(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(a=null==e?void 0:e.options)||void 0===a?void 0:a.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:tZ});return(null===(n=l.data)||void 0===n?void 0:n.url)&&to()&&!(null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(e){if(await tf(this.storage,`${this.storageKey}-code-verifier`),eG(e))return this._returnResult({data:null,error:e});throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new eY;let{error:a}=await tP(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:a,options:n}=e,{error:i}=await tP(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}if("phone"in e){let{phone:r,type:a,options:n}=e,{data:i,error:s}=await tP(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:s})}throw new e1("You must provide either an email or phone number and a type")}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let t=null,r=await tp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),null!==r&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};let a=!!t.expires_at&&1e3*t.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){let e=await tp(this.userStorage,this.storageKey+"-user");(null==e?void 0:e.user)?t.user=e.user:t.user=tS()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){var e;let r={value:this.suppressGetSessionWarning};t.user=(e=t.user,new Proxy(e,{get:(e,t,a)=>{if("__isInsecureUserWarningProxy"===t)return!0;if("symbol"==typeof t){let r=t.toString();if("Symbol(Symbol.toPrimitive)"===r||"Symbol(Symbol.toStringTag)"===r||"Symbol(util.inspect.custom)"===r||"Symbol(nodejs.util.inspect.custom)"===r)return Reflect.get(e,t,a)}return r.value||"string"!=typeof t||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(e,t,a)}})),r.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}let{data:n,error:i}=await this._callRefreshToken(t.refresh_token);if(i)return this._returnResult({data:{session:null},error:i});return this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;let t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{if(e)return await tP(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tN});return await this._useSession(async e=>{var t,r,a;let{data:n,error:i}=e;if(i)throw i;return(null===(t=n.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await tP(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(a=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==a?a:void 0,xform:tN}):{data:{user:null},error:new eY}})}catch(e){if(eG(e))return eQ(e)&&(await this._removeSession(),await tf(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:a,error:n}=r;if(n)throw n;if(!a.session)throw new eY;let i=a.session,s=null,o=null;"pkce"===this.flowType&&null!=e.email&&([s,o]=await tw(this.storage,this.storageKey));let{data:l,error:u}=await tP(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:o}),jwt:i.access_token,xform:tN});if(u)throw u;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(e){if(await tf(this.storage,`${this.storageKey}-code-verifier`),eG(e))return this._returnResult({data:{user:null},error:e});throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eY;let t=Date.now()/1e3,r=t,a=!0,n=null,{payload:i}=ty(e.access_token);if(i.exp&&(a=(r=i.exp)<=t),a){let{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!t)return{data:{user:null,session:null},error:null};n=t}else{let{data:a,error:i}=await this._getUser(e.access_token);if(i)return this._returnResult({data:{user:null,session:null},error:i});n={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return this._returnResult({data:{user:n.user,session:n},error:null})}catch(e){if(eG(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:a,error:n}=t;if(n)throw n;e=null!==(r=a.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new eY;let{data:a,error:n}=await this._callRefreshToken(e.refresh_token);return n?this._returnResult({data:{user:null,session:null},error:n}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(e,t){try{if(!to())throw new e4("No browser detected.");if(e.error||e.error_description||e.error_code)throw new e4(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new e2("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new e4("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new e2("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let a=new URL(window.location.href);return a.searchParams.delete("code"),window.history.replaceState(window.history.state,"",a.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:a,access_token:n,refresh_token:i,expires_in:s,expires_at:o,token_type:l}=e;if(!n||!s||!i||!l)throw new e4("No session defined in URL");let u=Math.round(Date.now()/1e3),c=parseInt(s),d=u+c;o&&(d=parseInt(o));let h=d-u;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${c}s`);let p=d-c;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,u);let{data:f,error:m}=await this._getUser(n);if(m)throw m;let y={provider_token:r,provider_refresh_token:a,access_token:n,expires_in:c,expires_at:d,refresh_token:i,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(e){if(eG(e))return this._returnResult({data:{session:null,redirectType:null},error:e});throw e}}_isImplicitGrantCallback(e){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await tp(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:a,error:n}=t;if(n&&!eQ(n))return this._returnResult({error:n});let i=null===(r=a.session)||void 0===r?void 0:r.access_token;if(i){let{error:t}=await this.admin.signOut(i,e);if(t&&!(eG(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)||eQ(t)))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await tf(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){let t=Symbol("auth-callback"),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,a;try{let{data:{session:a},error:n}=t;if(n)throw n;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(t){await (null===(a=this.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,a=null;"pkce"===this.flowType&&([r,a]=await tw(this.storage,this.storageKey,!0));try{return await tP(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(await tf(this.storage,`${this.storageKey}-code-verifier`),eG(e))return this._returnResult({data:null,error:e});throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{let{data:r,error:a}=await this._useSession(async t=>{var r,a,n,i,s;let{data:o,error:l}=t;if(l)throw l;let u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(a=e.options)||void 0===a?void 0:a.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return await tP(this.fetch,"GET",u,{headers:this.headers,jwt:null!==(s=null===(i=o.session)||void 0===i?void 0:i.access_token)&&void 0!==s?s:void 0})});if(a)throw a;return!to()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),this._returnResult({data:{provider:e.provider,url:null==r?void 0:r.url},error:null})}catch(t){if(eG(t))return this._returnResult({data:{provider:e.provider,url:null},error:t});throw t}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{let{error:a,data:{session:n}}=t;if(a)throw a;let{options:i,provider:s,token:o,access_token:l,nonce:u}=e,{data:c,error:d}=await tP(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!==(r=null==n?void 0:n.access_token)&&void 0!==r?r:void 0,body:{provider:s,id_token:o,access_token:l,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:tC});if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user)return this._returnResult({data:{user:null,session:null},error:new e0});return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("USER_UPDATED",c.session)),this._returnResult({data:c,error:d})}catch(e){if(await tf(this.storage,`${this.storageKey}-code-verifier`),eG(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,a;let{data:n,error:i}=t;if(i)throw i;return await tP(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(a=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==a?a:void 0})})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,a;let n=Date.now();return await (r=async r=>(r>0&&await tg(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await tP(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:tC})),a=(e,t)=>t&&e6(t)&&Date.now()+200*Math.pow(2,e)-n<3e4,new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{let t=await r(n);if(!a(n,null,t)){e(t);return}}catch(e){if(!a(n,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),eG(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),to()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let a=await tp(this.storage,this.storageKey);if(a&&this.userStorage){let t=await tp(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:a.user},await th(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:tS()}else if(a&&!a.user&&!a.user){let e=await tp(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(a.user=e.user,await tf(this.storage,this.storageKey+"-user"),await th(this.storage,this.storageKey,a)):a.user=tS()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),null!==a&&await this._removeSession();return}let n=(null!==(t=a.expires_at)&&void 0!==t?t:1/0)*1e3-Date.now()<9e4;if(this._debug(r,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&a.refresh_token){let{error:e}=await this._callRefreshToken(a.refresh_token);e&&(console.error(e),e6(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(a.access_token);!t&&(null==e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(e){this._debug(r,"error",e),console.error(e);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new eY;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new tm;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new eY;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let a={data:t.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(e){if(this._debug(a,"error",e),eG(e)){let r={data:null,error:e};return e6(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,r=!0){let a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let a=[],n=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){a.push(e)}});if(await Promise.all(n),a.length>0){for(let e=0;e<a.length;e+=1)console.error(a[e]);throw a[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await tf(this.storage,`${this.storageKey}-code-verifier`);let t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await th(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let a=tI(e);await th(this.storage,this.storageKey,a)}else{let e=tI(t);await th(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await tf(this.storage,this.storageKey),await tf(this.storage,this.storageKey+"-code-verifier"),await tf(this.storage,this.storageKey+"-user"),this.userStorage&&await tf(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&to()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e);let t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);let t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let a=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),a<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tq)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!to()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let a=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await tw(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});a.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);a.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:a,error:n}=t;return n?this._returnResult({data:null,error:n}):await tP(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==a?void 0:a.session)||void 0===r?void 0:r.access_token})})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,a;let{data:n,error:i}=t;if(i)return this._returnResult({data:null,error:i});let s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await tP(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null===(a=null==o?void 0:o.totp)||void 0===a?void 0:a.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r,a,n;let{data:i,error:s}=t;if(s)return this._returnResult({data:null,error:s});let o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?(a=e.webauthn.credential_response,"toJSON"in a&&"function"==typeof a.toJSON?a.toJSON():{id:a.id,rawId:a.id,response:{attestationObject:ts(new Uint8Array(a.response.attestationObject)),clientDataJSON:ts(new Uint8Array(a.response.clientDataJSON))},type:"public-key",clientExtensionResults:a.getClientExtensionResults(),authenticatorAttachment:null!==(n=a.authenticatorAttachment)&&void 0!==n?n:void 0}):function(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();let r=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ts(new Uint8Array(a.authenticatorData)),clientDataJSON:ts(new Uint8Array(a.clientDataJSON)),signature:ts(new Uint8Array(a.signature)),userHandle:a.userHandle?ts(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:null!==(t=e.authenticatorAttachment)&&void 0!==t?t:void 0}}(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:u}=await tP(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:u}))})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;let{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});let s=await tP(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null===(r=null==a?void 0:a.session)||void 0===r?void 0:r.access_token});if(s.error)return s;let{data:o}=s;if("webauthn"!==o.type)return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);let{challenge:t,user:r,excludeCredentials:a}=e,i=n(e,["challenge","user","excludeCredentials"]),s=ti(t).buffer,o=Object.assign(Object.assign({},r),{id:ti(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:s,user:o});if(a&&a.length>0){l.excludeCredentials=Array(a.length);for(let e=0;e<a.length;e++){let t=a[e];l.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:ti(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return l}(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);let{challenge:t,allowCredentials:r}=e,a=n(e,["challenge","allowCredentials"]),i=ti(t).buffer,s=Object.assign(Object.assign({},a),{challenge:i});if(r&&r.length>0){s.allowCredentials=Array(r.length);for(let e=0;e<r.length;e++){let t=r[e];s.allowCredentials[e]=Object.assign(Object.assign({},t),{id:ti(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return s}(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;let{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};let a={all:[],phone:[],totp:[],webauthn:[]};for(let r of null!==(e=null==t?void 0:t.factors)&&void 0!==e?e:[])a.all.push(r),"verified"===r.status&&a[r.factor_type].push(r);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,r,a,n;if(e)try{let{payload:a}=ty(e),n=null;a.aal&&(n=a.aal);let i=n,{data:{user:s},error:o}=await this.getUser(e);if(o)return this._returnResult({data:null,error:o});(null!==(r=null===(t=null==s?void 0:s.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(i="aal2");let l=a.amr||[];return{data:{currentLevel:n,nextLevel:i,currentAuthenticationMethods:l},error:null}}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}let{data:{session:i},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:o}=ty(i.access_token),l=null;o.aal&&(l=o.aal);let u=l;return(null!==(n=null===(a=i.user.factors)||void 0===a?void 0:a.filter(e=>"verified"===e.status))&&void 0!==n?n:[]).length>0&&(u="aal2"),{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:o.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{let{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await tP(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new eY})})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{let{data:{session:a},error:n}=r;if(n)return this._returnResult({data:null,error:n});if(!a)return this._returnResult({data:null,error:new eY});let i=await tP(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&to()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{let{data:{session:a},error:n}=r;if(n)return this._returnResult({data:null,error:n});if(!a)return this._returnResult({data:null,error:new eY});let i=await tP(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&to()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async _listOAuthGrants(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await tP(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new eY})})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{let{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?(await tP(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new eY})})}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;let a=Date.now();if((r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>a)return r;let{data:n,error:i}=await tP(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return n.keys&&0!==n.keys.length&&(this.jwks=n,this.jwks_cached_at=a,r=n.keys.find(t=>t.kid===e))?r:null}async getClaims(e,t={}){try{let r=e;if(!r){let{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});r=e.session.access_token}let{header:a,payload:n,signature:i,raw:{header:s,payload:o}}=ty(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(n.exp);let l=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!l){let{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:n,header:a,signature:i},error:null}}let u=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(a.alg),c=await crypto.subtle.importKey("jwk",l,u,!0,["verify"]);if(!await crypto.subtle.verify(u,c,i,function(e){let t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){let t=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127){t(e);return}if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(a,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${s}.${o}`)))throw new e8("Invalid JWT signature");return{data:{claims:n,header:a,signature:i},error:null}}catch(e){if(eG(e))return this._returnResult({data:null,error:e});throw e}}}t8.nextInstanceID={};let t7=t8,re="";"undefined"!=typeof Deno?re="deno":"undefined"!=typeof document?re="web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?re="react-native":re="node";let rt={headers:{"X-Client-Info":`supabase-js-${re}/2.93.3`}},rr={schema:"public"},ra={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},rn={};function ri(e){return(ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function ro(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rs(Object(r),!0).forEach(function(t){!function(e,t,r){var a;(a=function(e,t){if("object"!=ri(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=ri(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==ri(a)?a:a+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let rl=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),ru=()=>Headers,rc=(e,t,r)=>{let a=rl(r),n=ru();return async(r,i)=>{var s;let o=null!==(s=await t())&&void 0!==s?s:e,l=new n(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),a(r,ro(ro({},i),{},{headers:l}))}};var rd=class extends t7{constructor(e){super(e)}},rh=class{constructor(e,t,r){var a,n,i;this.supabaseUrl=e,this.supabaseKey=t;let s=function(e){let t=null==e?void 0:e.trim();if(!t)throw Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t.endsWith("/")?t:t+"/")}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(e);if(!t)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);let o=`sb-${s.hostname.split(".")[0]}-auth-token`,l=function(e,t){var r,a;let{db:n,auth:i,realtime:s,global:o}=e,{db:l,auth:u,realtime:c,global:d}=t,h={db:ro(ro({},l),n),auth:ro(ro({},u),i),realtime:ro(ro({},c),s),storage:{},global:ro(ro(ro({},d),o),{},{headers:ro(ro({},null!==(r=null==d?void 0:d.headers)&&void 0!==r?r:{}),null!==(a=null==o?void 0:o.headers)&&void 0!==a?a:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:rr,realtime:rn,auth:ro(ro({},ra),{},{storageKey:o}),global:rt});this.storageKey=null!==(a=l.auth.storageKey)&&void 0!==a?a:"",this.headers=null!==(n=l.global.headers)&&void 0!==n?n:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=l.auth)&&void 0!==i?i:{},this.headers,l.global.fetch),this.fetch=rc(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(ro({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new E(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new eL(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();let{data:r}=await this.auth.getSession();return null!==(e=null===(t=r.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,storageKey:i,flowType:s,lock:o,debug:l,throwOnError:u},c,d){let h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rd({url:this.authUrl.href,headers:ro(ro({},h),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,flowType:s,lock:o,debug:l,throwOnError:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new H(this.realtimeUrl.href,ro(ro({},e),{},{params:ro(ro({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}};let rp=(e,t,r)=>new rh(e,t,r);(function(){if("undefined"!=typeof window)return!1;let e=globalThis.process;if(!e)return!1;let t=e.version;if(null==t)return!1;let r=t.match(/^v(\d+)\./);return!!r&&18>=parseInt(r[1],10)})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")},2374:(e,t,r)=>{"use strict";r.d(t,{_4:()=>na});var a,n,i,s,o,l,u,c,d,h,p,f,m,y,g,v,_,b,w,k,T,x,S,I,A,E,O,R,P,$,C,j,N,Z,z,F,M,U,L,D,q,B=r(7997),V=r(1778),K="vercel.ai.error",W=Symbol.for(K),G=class e extends(n=Error,a=W,n){constructor({name:e,message:t,cause:r}){super(t),this[a]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,K)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}},J="AI_APICallError",H=`vercel.ai.error.${J}`,X=Symbol.for(H),Y=class extends(s=G,i=X,s){constructor({message:e,url:t,requestBodyValues:r,statusCode:a,responseHeaders:n,responseBody:s,cause:o,isRetryable:l=null!=a&&(408===a||409===a||429===a||a>=500),data:u}){super({name:J,message:e,cause:o}),this[i]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=a,this.responseHeaders=n,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(e){return G.hasMarker(e,H)}},Q="AI_EmptyResponseBodyError",ee=`vercel.ai.error.${Q}`,et=Symbol.for(ee),er=class extends(l=G,o=et,l){constructor({message:e="Empty response body"}={}){super({name:Q,message:e}),this[o]=!0}static isInstance(e){return G.hasMarker(e,ee)}};function ea(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}var en="AI_InvalidArgumentError",ei=`vercel.ai.error.${en}`,es=Symbol.for(ei),eo=class extends(c=G,u=es,c){constructor({message:e,cause:t,argument:r}){super({name:en,message:e,cause:t}),this[u]=!0,this.argument=r}static isInstance(e){return G.hasMarker(e,ei)}},el=(Symbol.for("vercel.ai.error.AI_InvalidPromptError"),Symbol.for("vercel.ai.error.AI_InvalidResponseDataError"),"AI_JSONParseError"),eu=`vercel.ai.error.${el}`,ec=Symbol.for(eu),ed=class extends(h=G,d=ec,h){constructor({text:e,cause:t}){super({name:el,message:`JSON parsing failed: Text: ${e}.
Error message: ${ea(t)}`,cause:t}),this[d]=!0,this.text=e}static isInstance(e){return G.hasMarker(e,eu)}},eh=(Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchModelError"),Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError"),"AI_TypeValidationError"),ep=`vercel.ai.error.${eh}`,ef=Symbol.for(ep),em=class e extends(f=G,p=ef,f){constructor({value:e,cause:t,context:r}){let a="Type validation failed";if((null==r?void 0:r.field)&&(a+=` for ${r.field}`),(null==r?void 0:r.entityName)||(null==r?void 0:r.entityId)){a+=" (";let e=[];r.entityName&&e.push(r.entityName),r.entityId&&e.push(`id: "${r.entityId}"`),a+=e.join(", ")+")"}super({name:eh,message:`${a}: Value: ${JSON.stringify(e)}.
Error message: ${ea(t)}`,cause:t}),this[p]=!0,this.value=e,this.context=r}static isInstance(e){return G.hasMarker(e,ep)}static wrap({value:t,cause:r,context:a}){var n,i,s;return e.isInstance(r)&&r.value===t&&(null==(n=r.context)?void 0:n.field)===(null==a?void 0:a.field)&&(null==(i=r.context)?void 0:i.entityName)===(null==a?void 0:a.entityName)&&(null==(s=r.context)?void 0:s.entityId)===(null==a?void 0:a.entityId)?r:new e({value:t,cause:r,context:a})}};function ey(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(ey):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&(void 0===t||ey(t))))}Symbol.for("vercel.ai.error.AI_UnsupportedFunctionalityError");var eg=r(8436),ev=r(2574),e_=r(1067),eb=r(1536);function ew(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function ek(e){return Object.fromEntries([...e.headers])}var{btoa:eT,atob:ex}=globalThis,eS=Symbol.for("vercel.ai.error.AI_DownloadError");function eI(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}(({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{let n=()=>{let e=r.length,a=Array(t);for(let n=0;n<t;n++)a[n]=r[Math.random()*e|0];return a.join("")};if(null!=e){if(r.includes(a))throw new eo({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return()=>`${e}${a}${n()}`}})();var eA=["fetch failed","failed to fetch"],eE=["ConnectionRefused","ConnectionClosed","FailedToOpenSocket","ECONNRESET","ECONNREFUSED","ETIMEDOUT","EPIPE"];function eO({error:e,url:t,requestBodyValues:r}){if(eI(e))return e;if(e instanceof TypeError&&eA.includes(e.message.toLowerCase())){let a=e.cause;if(null!=a)return new Y({message:`Cannot connect to API: ${a.message}`,cause:a,url:t,requestBodyValues:r,isRetryable:!0})}return!function(e){if(!(e instanceof Error))return!1;let t=e.code;return!!("string"==typeof t&&eE.includes(t))}(e)?e:new Y({message:`Cannot connect to API: ${e.message}`,cause:e,url:t,requestBodyValues:r,isRetryable:!0})}function eR(e=globalThis){var t,r,a;return e.window?"runtime/browser":(null==(t=e.navigator)?void 0:t.userAgent)?`runtime/${e.navigator.userAgent.toLowerCase()}`:(null==(a=null==(r=e.process)?void 0:r.versions)?void 0:a.node)?`runtime/node.js/${e.process.version.substring(0)}`:e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function eP(e,...t){let r=new Headers(function(e){if(null==e)return{};let t={};if(e instanceof Headers)e.forEach((e,r)=>{t[r.toLowerCase()]=e});else for(let[r,a]of(Array.isArray(e)||(e=Object.entries(e)),e))null!=a&&(t[r.toLowerCase()]=a);return t}(e)),a=r.get("user-agent")||"";return r.set("user-agent",[a,...t].filter(Boolean).join(" ")),Object.fromEntries(r.entries())}var e$="4.0.11",eC=()=>globalThis.fetch,ej=async({url:e,headers:t={},successfulResponseHandler:r,failedResponseHandler:a,abortSignal:n,fetch:i=eC()})=>{try{let s=await i(e,{method:"GET",headers:eP(t,`ai-sdk/provider-utils/${e$}`,eR()),signal:n}),o=ek(s);if(!s.ok){let t;try{t=await a({response:s,url:e,requestBodyValues:{}})}catch(t){if(eI(t)||Y.isInstance(t))throw t;throw new Y({message:"Failed to process error response",cause:t,statusCode:s.status,url:e,responseHeaders:o,requestBodyValues:{}})}throw t.value}try{return await r({response:s,url:e,requestBodyValues:{}})}catch(t){if(t instanceof Error&&(eI(t)||Y.isInstance(t)))throw t;throw new Y({message:"Failed to process successful response",cause:t,statusCode:s.status,url:e,responseHeaders:o,requestBodyValues:{}})}}catch(t){throw eO({error:t,url:e,requestBodyValues:{}})}};function eN({settingValue:e,environmentVariableName:t}){if("string"==typeof e||null==e&&"undefined"!=typeof process&&null!=(e=process.env[t])&&"string"==typeof e)return e}var eZ=/"__proto__"\s*:/,ez=/"constructor"\s*:/;function eF(e){let t=JSON.parse(e);return null===t||"object"!=typeof t||!1===eZ.test(e)&&!1===ez.test(e)?t:function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let a=r[e];a&&"object"==typeof a&&t.push(a)}}}return e}(t)}function eM(e){let{stackTraceLimit:t}=Error;try{Error.stackTraceLimit=0}catch(t){return eF(e)}try{return eF(e)}finally{Error.stackTraceLimit=t}}function eU(e){if("object"===e.type||Array.isArray(e.type)&&e.type.includes("object")){e.additionalProperties=!1;let{properties:t}=e;if(null!=t)for(let e of Object.keys(t))t[e]=eL(t[e])}null!=e.items&&(e.items=Array.isArray(e.items)?e.items.map(eL):eL(e.items)),null!=e.anyOf&&(e.anyOf=e.anyOf.map(eL)),null!=e.allOf&&(e.allOf=e.allOf.map(eL)),null!=e.oneOf&&(e.oneOf=e.oneOf.map(eL));let{definitions:t}=e;if(null!=t)for(let e of Object.keys(t))t[e]=eL(t[e]);return e}function eL(e){return"boolean"==typeof e?e:eU(e)}var eD=Symbol("Let zodToJsonSchema decide on which parser to use"),eq={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},eB=e=>"string"==typeof e?{...eq,name:e}:{...eq,...e};function eV(e,t){return tt(e.type._def,t)}var eK=(e,t)=>tt(e.innerType._def,t),eW=e=>{let t={type:"integer",format:"unix-time"};for(let r of e.checks)switch(r.kind){case"min":t.minimum=r.value;break;case"max":t.maximum=r.value}return t},eG=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,eJ=void 0,eH={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===eJ&&(eJ=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),eJ),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function eX(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value;break;case"max":r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"email":switch(t.emailStrategy){case"format:email":e0(r,"email",a.message,t);break;case"format:idn-email":e0(r,"idn-email",a.message,t);break;case"pattern:zod":e1(r,eH.email,a.message,t)}break;case"url":e0(r,"uri",a.message,t);break;case"uuid":e0(r,"uuid",a.message,t);break;case"regex":e1(r,a.regex,a.message,t);break;case"cuid":e1(r,eH.cuid,a.message,t);break;case"cuid2":e1(r,eH.cuid2,a.message,t);break;case"startsWith":e1(r,RegExp(`^${eY(a.value,t)}`),a.message,t);break;case"endsWith":e1(r,RegExp(`${eY(a.value,t)}$`),a.message,t);break;case"datetime":e0(r,"date-time",a.message,t);break;case"date":e0(r,"date",a.message,t);break;case"time":e0(r,"time",a.message,t);break;case"duration":e0(r,"duration",a.message,t);break;case"length":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"includes":e1(r,RegExp(eY(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&e0(r,"ipv4",a.message,t),"v4"!==a.version&&e0(r,"ipv6",a.message,t);break;case"base64url":e1(r,eH.base64url,a.message,t);break;case"jwt":e1(r,eH.jwt,a.message,t);break;case"cidr":"v6"!==a.version&&e1(r,eH.ipv4Cidr,a.message,t),"v4"!==a.version&&e1(r,eH.ipv6Cidr,a.message,t);break;case"emoji":e1(r,eH.emoji(),a.message,t);break;case"ulid":e1(r,eH.ulid,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":e0(r,"binary",a.message,t);break;case"contentEncoding:base64":r.contentEncoding="base64";break;case"pattern:zod":e1(r,eH.base64,a.message,t)}break;case"nanoid":e1(r,eH.nanoid,a.message,t)}return r}function eY(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)eQ.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}var eQ=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function e0(e,t,r,a){var n;e.format||(null==(n=e.anyOf)?void 0:n.some(e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function e1(e,t,r,a){var n;e.pattern||(null==(n=e.allOf)?void 0:n.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:e4(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=e4(t,a)}function e4(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;let a={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=a.i?e.source.toLowerCase():e.source,i="",s=!1,o=!1,l=!1;for(let e=0;e<n.length;e++){if(s){i+=n[e],s=!1;continue}if(a.i){if(o){if(n[e].match(/[a-z]/)){l?(i+=n[e]+`${n[e-2]}-${n[e]}`.toUpperCase(),l=!1):"-"===n[e+1]&&(null==(r=n[e+2])?void 0:r.match(/[a-z]/))?(i+=n[e],l=!0):i+=`${n[e]}${n[e].toUpperCase()}`;continue}}else if(n[e].match(/[a-z]/)){i+=`[${n[e]}${n[e].toUpperCase()}]`;continue}}if(a.m){if("^"===n[e]){i+=`(^|(?<=[\r
]))`;continue}if("$"===n[e]){i+=`($|(?=[\r
]))`;continue}}if(a.s&&"."===n[e]){i+=o?`${n[e]}\r
`:`[${n[e]}\r
]`;continue}i+=n[e],"\\"===n[e]?s=!0:o&&"]"===n[e]?o=!1:o||"["!==n[e]||(o=!0)}try{new RegExp(i)}catch(r){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return i}function e2(e,t){var r,a,n,i,s,o;let l={type:"object",additionalProperties:null!=(r=tt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))?r:t.allowedAdditionalProperties};if((null==(a=e.keyType)?void 0:a._def.typeName)===e_.pA.ZodString&&(null==(n=e.keyType._def.checks)?void 0:n.length)){let{type:r,...a}=eX(e.keyType._def,t);return{...l,propertyNames:a}}if((null==(i=e.keyType)?void 0:i._def.typeName)===e_.pA.ZodEnum)return{...l,propertyNames:{enum:e.keyType._def.values}};if((null==(s=e.keyType)?void 0:s._def.typeName)===e_.pA.ZodBranded&&e.keyType._def.type._def.typeName===e_.pA.ZodString&&(null==(o=e.keyType._def.type._def.checks)?void 0:o.length)){let{type:r,...a}=eV(e.keyType._def,t);return{...l,propertyNames:a}}return l}var e9={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},e3=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>tt(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},e6=(e,t)=>{var r;if(t.currentPath.toString()===(null==(r=t.propertyPath)?void 0:r.toString()))return tt(e.innerType._def,t);let a=tt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return a?{anyOf:[{not:{}},a]}:{}},e5=(e,t)=>{if("input"===t.pipeStrategy)return tt(e.in._def,t);if("output"===t.pipeStrategy)return tt(e.out._def,t);let r=tt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),a=tt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(e=>void 0!==e)}},e8=(e,t)=>tt(e.innerType._def,t),e7=(e,t,r)=>{switch(t){case e_.pA.ZodString:return eX(e,r);case e_.pA.ZodNumber:return function(e){let t={type:"number"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"int":t.type="integer";break;case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case e_.pA.ZodObject:return function(e,t){let r={type:"object",properties:{}},a=[],n=e.shape();for(let e in n){let i=n[e];if(void 0===i||void 0===i._def)continue;let s=function(e){try{return e.isOptional()}catch(e){return!0}}(i),o=tt(i._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==o&&(r.properties[e]=o,s||a.push(e))}a.length&&(r.required=a);let i=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return tt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==i&&(r.additionalProperties=i),r}(e,r);case e_.pA.ZodBigInt:return function(e){let t={type:"integer",format:"int64"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case e_.pA.ZodBoolean:return{type:"boolean"};case e_.pA.ZodDate:return function e(t,r,a){let n=null!=a?a:r.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((a,n)=>e(t,r,a))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return eW(t)}}(e,r);case e_.pA.ZodUndefined:return{not:{}};case e_.pA.ZodNull:return{type:"null"};case e_.pA.ZodArray:return function(e,t){var r,a,n;let i={type:"array"};return(null==(r=e.type)?void 0:r._def)&&(null==(n=null==(a=e.type)?void 0:a._def)?void 0:n.typeName)!==e_.pA.ZodAny&&(i.items=tt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(i.minItems=e.minLength.value),e.maxLength&&(i.maxItems=e.maxLength.value),e.exactLength&&(i.minItems=e.exactLength.value,i.maxItems=e.exactLength.value),i}(e,r);case e_.pA.ZodUnion:case e_.pA.ZodDiscriminatedUnion:return function(e,t){let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in e9&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=e9[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return e3(e,t)}(e,r);case e_.pA.ZodIntersection:return function(e,t){let r=[tt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),tt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),a=[];return r.forEach(e=>{if(eG(e))a.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}a.push(t)}}),a.length?{allOf:a}:void 0}(e,r);case e_.pA.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>tt(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:tt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>tt(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case e_.pA.ZodRecord:return e2(e,r);case e_.pA.ZodLiteral:return function(e){let t=typeof e.value;return"bigint"!==t&&"number"!==t&&"boolean"!==t&&"string"!==t?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===t?"integer":t,const:e.value}}(e);case e_.pA.ZodEnum:return{type:"string",enum:Array.from(e.values)};case e_.pA.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),a=Array.from(new Set(r.map(e=>typeof e)));return{type:1===a.length?"string"===a[0]?"string":"number":["string","number"],enum:r}}(e);case e_.pA.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[e9[e.innerType._def.typeName],"null"]};let r=tt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case e_.pA.ZodOptional:return e6(e,r);case e_.pA.ZodMap:return function(e,t){return"record"===t.mapStrategy?e2(e,t):{type:"array",maxItems:125,items:{type:"array",items:[tt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},tt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case e_.pA.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:tt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(r.minItems=e.minSize.value),e.maxSize&&(r.maxItems=e.maxSize.value),r}(e,r);case e_.pA.ZodLazy:return()=>e.getter()._def;case e_.pA.ZodPromise:return tt(e.type._def,r);case e_.pA.ZodNaN:case e_.pA.ZodNever:return{not:{}};case e_.pA.ZodEffects:return function(e,t){return"input"===t.effectStrategy?tt(e.schema._def,t):{}}(e,r);case e_.pA.ZodAny:case e_.pA.ZodUnknown:return{};case e_.pA.ZodDefault:return function(e,t){return{...tt(e.innerType._def,t),default:e.defaultValue()}}(e,r);case e_.pA.ZodBranded:return eV(e,r);case e_.pA.ZodReadonly:return e8(e,r);case e_.pA.ZodCatch:return eK(e,r);case e_.pA.ZodPipeline:return e5(e,r);case e_.pA.ZodFunction:case e_.pA.ZodVoid:case e_.pA.ZodSymbol:default:return}},te=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};function tt(e,t,r=!1){var a;let n=t.seen.get(e);if(t.override){let i=null==(a=t.override)?void 0:a.call(t,e,t,n,r);if(i!==eD)return i}if(n&&!r){let e=tr(n,t);if(void 0!==e)return e}let i={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,i);let s=e7(e,e.typeName,t),o="function"==typeof s?tt(s(),t):s;if(o&&ta(e,t,o),t.postProcess){let r=t.postProcess(o,e,t);return i.jsonSchema=o,r}return i.jsonSchema=o,o}var tr=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:te(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},ta=(e,t,r)=>(e.description&&(r.description=e.description),r),tn=e=>{let t=eB(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}},ti=(e,t)=>{var r;let a=tn(t),n="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>{var n;return{...e,[t]:null!=(n=tt(r._def,{...a,currentPath:[...a.basePath,a.definitionPath,t]},!0))?n:{}}},{}):void 0,i="string"==typeof t?t:(null==t?void 0:t.nameStrategy)==="title"?void 0:null==t?void 0:t.name,s=null!=(r=tt(e._def,void 0===i?a:{...a,currentPath:[...a.basePath,a.definitionPath,i]},!1))?r:{},o="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==o&&(s.title=o);let l=void 0===i?n?{...s,[a.definitionPath]:n}:s:{$ref:[..."relative"===a.$refStrategy?[]:a.basePath,a.definitionPath,i].join("/"),[a.definitionPath]:{...n,[i]:s}};return l.$schema="http://json-schema.org/draft-07/schema#",l},ts=Symbol.for("vercel.ai.schema");function to(e){let t;return()=>(null==t&&(t=e()),t)}function tl(e,{validate:t}={}){return{[ts]:!0,_type:void 0,get jsonSchema(){return"function"==typeof e&&(e=e()),e},validate:t}}function tu(e,t){return"_zod"in e?function(e,t){var r;let a=null!=(r=null==t?void 0:t.useReferences)&&r;return tl(()=>eU(eg.a(e,{target:"draft-7",io:"input",reused:a?"ref":"inline"})),{validate:async t=>{let r=await ev.X9(e,t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}(e,t):function(e,t){var r;let a=null!=(r=null==t?void 0:t.useReferences)&&r;return tl(()=>ti(e,{$refStrategy:a?"root":"none"}),{validate:async t=>{let r=await e.safeParseAsync(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}(e,t)}async function tc({value:e,schema:t,context:r}){let a=await td({value:e,schema:t,context:r});if(!a.success)throw em.wrap({value:e,cause:a.error,context:r});return a.value}async function td({value:e,schema:t,context:r}){let a=null==t?tl({properties:{},additionalProperties:!1}):"object"==typeof t&&null!==t&&ts in t&&!0===t[ts]&&"jsonSchema"in t&&"validate"in t?t:"~standard"in t?"zod"===t["~standard"].vendor?tu(t):tl(()=>eU(t["~standard"].jsonSchema.input({target:"draft-07"})),{validate:async e=>{let r=await t["~standard"].validate(e);return"value"in r?{success:!0,value:r.value}:{success:!1,error:new em({value:e,cause:r.issues})}}}):t();try{if(null==a.validate)return{success:!0,value:e,rawValue:e};let t=await a.validate(e);if(t.success)return{success:!0,value:t.value,rawValue:e};return{success:!1,error:em.wrap({value:e,cause:t.error,context:r}),rawValue:e}}catch(t){return{success:!1,error:em.wrap({value:e,cause:t,context:r}),rawValue:e}}}async function th({text:e,schema:t}){try{let r=eM(e);if(null==t)return r;return tc({value:r,schema:t})}catch(t){if(ed.isInstance(t)||em.isInstance(t))throw t;throw new ed({text:e,cause:t})}}async function tp({text:e,schema:t}){try{let r=eM(e);if(null==t)return{success:!0,value:r,rawValue:r};return await td({value:r,schema:t})}catch(t){return{success:!1,error:ed.isInstance(t)?t:new ed({text:e,cause:t}),rawValue:void 0}}}var tf=()=>globalThis.fetch,tm=async({url:e,headers:t,body:r,failedResponseHandler:a,successfulResponseHandler:n,abortSignal:i,fetch:s})=>ty({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:a,successfulResponseHandler:n,abortSignal:i,fetch:s}),ty=async({url:e,headers:t={},body:r,successfulResponseHandler:a,failedResponseHandler:n,abortSignal:i,fetch:s=tf()})=>{try{let o=await s(e,{method:"POST",headers:eP(t,`ai-sdk/provider-utils/${e$}`,eR()),body:r.content,signal:i}),l=ek(o);if(!o.ok){let t;try{t=await n({response:o,url:e,requestBodyValues:r.values})}catch(t){if(eI(t)||Y.isInstance(t))throw t;throw new Y({message:"Failed to process error response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:r.values})}throw t.value}try{return await a({response:o,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(eI(t)||Y.isInstance(t)))throw t;throw new Y({message:"Failed to process successful response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:r.values})}}catch(t){throw eO({error:t,url:e,requestBodyValues:r.values})}};function tg({id:e,inputSchema:t,outputSchema:r,supportsDeferredResults:a}){return({execute:n,needsApproval:i,toModelOutput:s,onInputStart:o,onInputDelta:l,onInputAvailable:u,...c})=>({type:"provider",id:e,args:c,inputSchema:t,outputSchema:r,execute:n,needsApproval:i,toModelOutput:s,onInputStart:o,onInputDelta:l,onInputAvailable:u,supportsDeferredResults:a})}async function tv(e){return"function"==typeof e&&(e=e()),Promise.resolve(e)}var t_=({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:a,url:n,requestBodyValues:i})=>{let s=await a.text(),o=ek(a);if(""===s.trim())return{responseHeaders:o,value:new Y({message:a.statusText,url:n,requestBodyValues:i,statusCode:a.status,responseHeaders:o,responseBody:s,isRetryable:null==r?void 0:r(a)})};try{let l=await th({text:s,schema:e});return{responseHeaders:o,value:new Y({message:t(l),url:n,requestBodyValues:i,statusCode:a.status,responseHeaders:o,responseBody:s,data:l,isRetryable:null==r?void 0:r(a,l)})}}catch(e){return{responseHeaders:o,value:new Y({message:a.statusText,url:n,requestBodyValues:i,statusCode:a.status,responseHeaders:o,responseBody:s,isRetryable:null==r?void 0:r(a)})}}},tb=e=>async({response:t})=>{let r=ek(t);if(null==t.body)throw new er({});return{responseHeaders:r,value:function({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new eb.m).pipeThrough(new TransformStream({async transform({data:e},r){"[DONE]"!==e&&r.enqueue(await tp({text:e,schema:t}))}}))}({stream:t.body,schema:e})}},tw=e=>async({response:t,url:r,requestBodyValues:a})=>{let n=await t.text(),i=await tp({text:n,schema:e}),s=ek(t);if(!i.success)throw new Y({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:s,responseBody:n,url:r,requestBodyValues:a});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},tk=r(9411),tT=r(1858),tx=Symbol.for("vercel.ai.gateway.error"),tS=class e extends(y=Error,m=tx,y){constructor({message:e,statusCode:t=500,cause:r,generationId:a}){super(a?`${e} [${a}]`:e),this[m]=!0,this.statusCode=t,this.cause=r,this.generationId=a}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&tx in e&&!0===e[tx]}},tI="GatewayAuthenticationError",tA=Symbol.for(`vercel.ai.gateway.error.${tI}`),tE=class e extends(v=tS,g=tA,v){constructor({message:e="Authentication failed",statusCode:t=401,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[g]=!0,this.name=tI,this.type="authentication_error"}static isInstance(e){return tS.hasMarker(e)&&tA in e}static createContextualError({apiKeyProvided:t,oidcTokenProvided:r,message:a="Authentication failed",statusCode:n=401,cause:i,generationId:s}){return new e({message:t?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:r?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:n,cause:i,generationId:s})}},tO="GatewayInvalidRequestError",tR=Symbol.for(`vercel.ai.gateway.error.${tO}`),tP=class extends(b=tS,_=tR,b){constructor({message:e="Invalid request",statusCode:t=400,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[_]=!0,this.name=tO,this.type="invalid_request_error"}static isInstance(e){return tS.hasMarker(e)&&tR in e}},t$="GatewayRateLimitError",tC=Symbol.for(`vercel.ai.gateway.error.${t$}`),tj=class extends(k=tS,w=tC,k){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[w]=!0,this.name=t$,this.type="rate_limit_exceeded"}static isInstance(e){return tS.hasMarker(e)&&tC in e}},tN="GatewayModelNotFoundError",tZ=Symbol.for(`vercel.ai.gateway.error.${tN}`),tz=to(()=>tu(tk.Ry({modelId:tk.Z_()}))),tF=class extends(x=tS,T=tZ,x){constructor({message:e="Model not found",statusCode:t=404,modelId:r,cause:a,generationId:n}={}){super({message:e,statusCode:t,cause:a,generationId:n}),this[T]=!0,this.name=tN,this.type="model_not_found",this.modelId=r}static isInstance(e){return tS.hasMarker(e)&&tZ in e}},tM="GatewayInternalServerError",tU=Symbol.for(`vercel.ai.gateway.error.${tM}`),tL=class extends(I=tS,S=tU,I){constructor({message:e="Internal server error",statusCode:t=500,cause:r,generationId:a}={}){super({message:e,statusCode:t,cause:r,generationId:a}),this[S]=!0,this.name=tM,this.type="internal_server_error"}static isInstance(e){return tS.hasMarker(e)&&tU in e}},tD="GatewayResponseError",tq=Symbol.for(`vercel.ai.gateway.error.${tD}`),tB=class extends(E=tS,A=tq,E){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:r,validationError:a,cause:n,generationId:i}={}){super({message:e,statusCode:t,cause:n,generationId:i}),this[A]=!0,this.name=tD,this.type="response_error",this.response=r,this.validationError=a}static isInstance(e){return tS.hasMarker(e)&&tq in e}};async function tV({response:e,statusCode:t,defaultMessage:r="Gateway request failed",cause:a,authMethod:n}){var i;let s=await td({value:e,schema:tK});if(!s.success){let n="object"==typeof e&&null!==e&&"generationId"in e?e.generationId:void 0;return new tB({message:`Invalid error response format: ${r}`,statusCode:t,response:e,validationError:s.error,cause:a,generationId:n})}let o=s.value,l=o.error.type,u=o.error.message,c=null!=(i=o.generationId)?i:void 0;switch(l){case"authentication_error":return tE.createContextualError({apiKeyProvided:"api-key"===n,oidcTokenProvided:"oidc"===n,statusCode:t,cause:a,generationId:c});case"invalid_request_error":return new tP({message:u,statusCode:t,cause:a,generationId:c});case"rate_limit_exceeded":return new tj({message:u,statusCode:t,cause:a,generationId:c});case"model_not_found":{let e=await td({value:o.error.param,schema:tz});return new tF({message:u,statusCode:t,modelId:e.success?e.value.modelId:void 0,cause:a,generationId:c})}default:return new tL({message:u,statusCode:t,cause:a,generationId:c})}}var tK=to(()=>tu(tk.Ry({error:tk.Ry({message:tk.Z_(),type:tk.Z_().nullish(),param:tk._4().nullish(),code:tk.G0([tk.Z_(),tk.Rx()]).nullish()}),generationId:tk.Z_().nullish()})));function tW(e,t){var r;return tS.isInstance(e)?e:Y.isInstance(e)?tV({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(r=e.statusCode)?r:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):tV({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var tG="ai-gateway-auth-method";async function tJ(e){let t=await td({value:e[tG],schema:tH});return t.success?t.value:void 0}var tH=to(()=>tu(tk.G0([tk.i0("api-key"),tk.i0("oidc")]))),tX=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await ej({url:`${this.config.baseURL}/config`,headers:await tv(this.config.headers()),successfulResponseHandler:tw(tY),failedResponseHandler:t_({errorSchema:tk.Yj(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await tW(e)}}async getCredits(){try{let e=new URL(this.config.baseURL),{value:t}=await ej({url:`${e.origin}/v1/credits`,headers:await tv(this.config.headers()),successfulResponseHandler:tw(tQ),failedResponseHandler:t_({errorSchema:tk.Yj(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await tW(e)}}},tY=to(()=>tu(tk.Ry({models:tk.IX(tk.Ry({id:tk.Z_(),name:tk.Z_(),description:tk.Z_().nullish(),pricing:tk.Ry({input:tk.Z_(),output:tk.Z_(),input_cache_read:tk.Z_().nullish(),input_cache_write:tk.Z_().nullish()}).transform(({input:e,output:t,input_cache_read:r,input_cache_write:a})=>({input:e,output:t,...r?{cachedInputTokens:r}:{},...a?{cacheCreationInputTokens:a}:{}})).nullish(),specification:tk.Ry({specificationVersion:tk.i0("v3"),provider:tk.Z_(),modelId:tk.Z_()}),modelType:tk.Km(["language","embedding","image"]).nullish()}))}))),tQ=to(()=>tu(tk.Ry({balance:tk.Z_(),total_used:tk.Z_()}).transform(({balance:e,total_used:t})=>({balance:e,totalUsed:t})))),t0=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...r}=e;return{args:this.maybeEncodeFileParts(r),warnings:[]}}async doGenerate(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,n=await tv(this.config.headers());try{let{responseHeaders:i,value:s,rawValue:o}=await tm({url:this.getUrl(),headers:ew(n,e.headers,this.getModelConfigHeaders(this.modelId,!1),await tv(this.config.o11yHeaders)),body:t,successfulResponseHandler:tw(tk.Yj()),failedResponseHandler:t_({errorSchema:tk.Yj(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{...s,request:{body:t},response:{headers:i,body:o},warnings:r}}catch(e){throw await tW(e,await tJ(n))}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,n=await tv(this.config.headers());try{let{value:i,responseHeaders:s}=await tm({url:this.getUrl(),headers:ew(n,e.headers,this.getModelConfigHeaders(this.modelId,!0),await tv(this.config.o11yHeaders)),body:t,successfulResponseHandler:tb(tk.Yj()),failedResponseHandler:t_({errorSchema:tk.Yj(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{stream:i.pipeThrough(new TransformStream({start(e){r.length>0&&e.enqueue({type:"stream-start",warnings:r})},transform(t,r){if(t.success){let a=t.value;("raw"!==a.type||e.includeRawChunks)&&("response-metadata"===a.type&&a.timestamp&&"string"==typeof a.timestamp&&(a.timestamp=new Date(a.timestamp)),r.enqueue(a))}else r.error(t.error)}})),request:{body:t},response:{headers:s}}}catch(e){throw await tW(e,await tJ(n))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),r=Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${r}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"3","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},t1=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed({values:e,headers:t,abortSignal:r,providerOptions:a}){var n;let i=await tv(this.config.headers());try{let{responseHeaders:s,value:o,rawValue:l}=await tm({url:this.getUrl(),headers:ew(i,null!=t?t:{},this.getModelConfigHeaders(),await tv(this.config.o11yHeaders)),body:{values:e,...a?{providerOptions:a}:{}},successfulResponseHandler:tw(t4),failedResponseHandler:t_({errorSchema:tk.Yj(),errorToMessage:e=>e}),...r&&{abortSignal:r},fetch:this.config.fetch});return{embeddings:o.embeddings,usage:null!=(n=o.usage)?n:void 0,providerMetadata:o.providerMetadata,response:{headers:s,body:l},warnings:[]}}catch(e){throw await tW(e,await tJ(i))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"3","ai-model-id":this.modelId}}},t4=to(()=>tu(tk.Ry({embeddings:tk.IX(tk.IX(tk.Rx())),usage:tk.Ry({tokens:tk.Rx()}).nullish(),providerMetadata:tk.IM(tk.Z_(),tk.IM(tk.Z_(),tk._4())).optional()}))),t2=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxImagesPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:r,aspectRatio:a,seed:n,files:i,mask:s,providerOptions:o,headers:l,abortSignal:u}){var c;let d=await tv(this.config.headers());try{let{responseHeaders:h,value:p,rawValue:f}=await tm({url:this.getUrl(),headers:ew(d,null!=l?l:{},this.getModelConfigHeaders(),await tv(this.config.o11yHeaders)),body:{prompt:e,n:t,...r&&{size:r},...a&&{aspectRatio:a},...n&&{seed:n},...o&&{providerOptions:o},...i&&{files:i.map(e=>t9(e))},...s&&{mask:t9(s)}},successfulResponseHandler:tw(t6),failedResponseHandler:t_({errorSchema:tk.Yj(),errorToMessage:e=>e}),...u&&{abortSignal:u},fetch:this.config.fetch});return{images:p.images,warnings:null!=(c=p.warnings)?c:[],providerMetadata:p.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:h}}}catch(e){throw tW(e,await tJ(d))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"3","ai-model-id":this.modelId}}};function t9(e){return"file"===e.type&&e.data instanceof Uint8Array?{...e,data:function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return eT(t)}(e.data)}:e}var t3=tk.Ry({images:tk.IX(tk._4()).optional()}).catchall(tk._4()),t6=tk.Ry({images:tk.IX(tk.Z_()),warnings:tk.IX(tk.Ry({type:tk.i0("other"),message:tk.Z_()})).optional(),providerMetadata:tk.IM(tk.Z_(),t3).optional()}),t5=tg({id:"gateway.parallel_search",inputSchema:to(()=>tu(e_.Ry({objective:e_.Z_().describe("Natural-language description of the web research goal, including source or freshness guidance and broader context from the task. Maximum 5000 characters."),search_queries:e_.IX(e_.Z_()).optional().describe("Optional search queries to supplement the objective. Maximum 200 characters per query."),mode:e_.Km(["one-shot","agentic"]).optional().describe('Mode preset: "one-shot" for comprehensive results with longer excerpts (default), "agentic" for concise, token-efficient results for multi-step workflows.'),max_results:e_.Rx().optional().describe("Maximum number of results to return (1-20). Defaults to 10 if not specified."),source_policy:e_.Ry({include_domains:e_.IX(e_.Z_()).optional().describe("List of domains to include in search results."),exclude_domains:e_.IX(e_.Z_()).optional().describe("List of domains to exclude from search results."),after_date:e_.Z_().optional().describe("Only include results published after this date (ISO 8601 format).")}).optional().describe("Source policy for controlling which domains to include/exclude and freshness."),excerpts:e_.Ry({max_chars_per_result:e_.Rx().optional().describe("Maximum characters per result."),max_chars_total:e_.Rx().optional().describe("Maximum total characters across all results.")}).optional().describe("Excerpt configuration for controlling result length."),fetch_policy:e_.Ry({max_age_seconds:e_.Rx().optional().describe("Maximum age in seconds for cached content. Set to 0 to always fetch fresh content.")}).optional().describe("Fetch policy for controlling content freshness.")}))),outputSchema:to(()=>tu(e_.G0([e_.Ry({searchId:e_.Z_(),results:e_.IX(e_.Ry({url:e_.Z_(),title:e_.Z_(),excerpt:e_.Z_(),publishDate:e_.Z_().nullable().optional(),relevanceScore:e_.Rx().optional()}))}),e_.Ry({error:e_.Km(["api_error","rate_limit","timeout","invalid_input","configuration_error","unknown"]),statusCode:e_.Rx().optional(),message:e_.Z_()})])))}),t8=tg({id:"gateway.perplexity_search",inputSchema:to(()=>tu(e_.Ry({query:e_.G0([e_.Z_(),e_.IX(e_.Z_())]).describe("Search query (string) or multiple queries (array of up to 5 strings). Multi-query searches return combined results from all queries."),max_results:e_.Rx().optional().describe("Maximum number of search results to return (1-20, default: 10)"),max_tokens_per_page:e_.Rx().optional().describe("Maximum number of tokens to extract per search result page (256-2048, default: 2048)"),max_tokens:e_.Rx().optional().describe("Maximum total tokens across all search results (default: 25000, max: 1000000)"),country:e_.Z_().optional().describe("Two-letter ISO 3166-1 alpha-2 country code for regional search results (e.g., 'US', 'GB', 'FR')"),search_domain_filter:e_.IX(e_.Z_()).optional().describe("List of domains to include or exclude from search results (max 20). To include: ['nature.com', 'science.org']. To exclude: ['-example.com', '-spam.net']"),search_language_filter:e_.IX(e_.Z_()).optional().describe("List of ISO 639-1 language codes to filter results (max 10, lowercase). Examples: ['en', 'fr', 'de']"),search_after_date:e_.Z_().optional().describe("Include only results published after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),search_before_date:e_.Z_().optional().describe("Include only results published before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),last_updated_after_filter:e_.Z_().optional().describe("Include only results last updated after this date. Format: 'MM/DD/YYYY' (e.g., '3/1/2025'). Cannot be used with search_recency_filter."),last_updated_before_filter:e_.Z_().optional().describe("Include only results last updated before this date. Format: 'MM/DD/YYYY' (e.g., '3/15/2025'). Cannot be used with search_recency_filter."),search_recency_filter:e_.Km(["day","week","month","year"]).optional().describe("Filter results by relative time period. Cannot be used with search_after_date or search_before_date.")}))),outputSchema:to(()=>tu(e_.G0([e_.Ry({results:e_.IX(e_.Ry({title:e_.Z_(),url:e_.Z_(),snippet:e_.Z_(),date:e_.Z_().optional(),lastUpdated:e_.Z_().optional()})),id:e_.Z_()}),e_.Ry({error:e_.Km(["api_error","rate_limit","timeout","invalid_input","unknown"]),statusCode:e_.Rx().optional(),message:e_.Z_()})])))}),t7={parallelSearch:(e={})=>t5(e),perplexitySearch:(e={})=>t8(e)};async function re(){var e;return null==(e=(0,tT.getContext)().headers)?void 0:e["x-vercel-id"]}var rt=function(e={}){var t,r,a;let n=null,i=null,s=null!=(t=e.metadataCacheRefreshMillis)?t:3e5,o=0,l=null!=(r=null==(a=e.baseURL)?void 0:a.replace(/\/$/,""))?r:"https://ai-gateway.vercel.sh/v3/ai",u=async()=>{try{let t=await rr(e);return eP({Authorization:`Bearer ${t.token}`,"ai-gateway-protocol-version":"0.0.1",[tG]:t.authMethod,...e.headers},"ai-sdk/gateway/3.0.29")}catch(e){throw tE.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401,cause:e})}},c=()=>{let e=eN({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=eN({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),r=eN({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let a=await re();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...r&&{"ai-o11y-region":r},...a&&{"ai-o11y-request-id":a}}}},d=t=>new t0(t,{provider:"gateway",baseURL:l,headers:u,fetch:e.fetch,o11yHeaders:c()}),h=async()=>{var t,r,a;let c=null!=(a=null==(r=null==(t=e._internal)?void 0:t.currentDate)?void 0:r.call(t).getTime())?a:Date.now();return(!n||c-o>s)&&(o=c,n=new tX({baseURL:l,headers:u,fetch:e.fetch}).getAvailableModels().then(e=>(i=e,e)).catch(async e=>{throw await tW(e,await tJ(await u()))})),i?Promise.resolve(i):n},p=async()=>new tX({baseURL:l,headers:u,fetch:e.fetch}).getCredits().catch(async e=>{throw await tW(e,await tJ(await u()))}),f=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return d(e)};f.specificationVersion="v3",f.getAvailableModels=h,f.getCredits=p,f.imageModel=t=>new t2(t,{provider:"gateway",baseURL:l,headers:u,fetch:e.fetch,o11yHeaders:c()}),f.languageModel=d;let m=t=>new t1(t,{provider:"gateway",baseURL:l,headers:u,fetch:e.fetch,o11yHeaders:c()});return f.embeddingModel=m,f.textEmbeddingModel=m,f.tools=t7,f}();async function rr(e){let t=eN({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});return t?{token:t,authMethod:"api-key"}:{token:await (0,tT.getVercelOidcToken)(),authMethod:"oidc"}}var ra=r(5658),rn=r(3931),ri=r(3048),rs=Object.defineProperty,ro="AI_InvalidArgumentError",rl=`vercel.ai.error.${ro}`,ru=Symbol.for(rl),rc=class extends V.AX{constructor({parameter:e,value:t,message:r}){super({name:ro,message:`Invalid argument for parameter ${e}: ${r}`}),this[O]=!0,this.parameter=e,this.value=t}static isInstance(e){return V.AX.hasMarker(e,rl)}};O=ru,Symbol.for("vercel.ai.error.AI_InvalidStreamPartError"),V.AX;var rd="AI_InvalidToolApprovalError",rh=`vercel.ai.error.${rd}`,rp=Symbol.for(rh),rf=class extends V.AX{constructor({approvalId:e}){super({name:rd,message:`Tool approval response references unknown approvalId: "${e}". No matching tool-approval-request found in message history.`}),this[R]=!0,this.approvalId=e}static isInstance(e){return V.AX.hasMarker(e,rh)}};R=rp;var rm="AI_InvalidToolInputError",ry=`vercel.ai.error.${rm}`,rg=Symbol.for(ry),rv=class extends V.AX{constructor({toolInput:e,toolName:t,cause:r,message:a=`Invalid input for tool ${t}: ${(0,V.e$)(r)}`}){super({name:rm,message:a,cause:r}),this[P]=!0,this.toolInput=e,this.toolName=t}static isInstance(e){return V.AX.hasMarker(e,ry)}};P=rg;var r_="AI_ToolCallNotFoundForApprovalError",rb=`vercel.ai.error.${r_}`,rw=Symbol.for(rb),rk=class extends V.AX{constructor({toolCallId:e,approvalId:t}){super({name:r_,message:`Tool call "${e}" not found for approval request "${t}".`}),this[$]=!0,this.toolCallId=e,this.approvalId=t}static isInstance(e){return V.AX.hasMarker(e,rb)}};$=rw;var rT="AI_MissingToolResultsError",rx=`vercel.ai.error.${rT}`,rS=Symbol.for(rx),rI=class extends V.AX{constructor({toolCallIds:e}){super({name:rT,message:`Tool result${e.length>1?"s are":" is"} missing for tool call${e.length>1?"s":""} ${e.join(", ")}.`}),this[C]=!0,this.toolCallIds=e}static isInstance(e){return V.AX.hasMarker(e,rx)}};C=rS;var rA=Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");V.AX;var rE="AI_NoObjectGeneratedError",rO=`vercel.ai.error.${rE}`,rR=Symbol.for(rO),rP=class extends V.AX{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:n,finishReason:i}){super({name:rE,message:e,cause:t}),this[j]=!0,this.text=r,this.response=a,this.usage=n,this.finishReason=i}static isInstance(e){return V.AX.hasMarker(e,rO)}};j=rR;var r$="AI_NoOutputGeneratedError",rC=`vercel.ai.error.${r$}`,rj=Symbol.for(rC),rN=class extends V.AX{constructor({message:e="No output generated.",cause:t}={}){super({name:r$,message:e,cause:t}),this[N]=!0}static isInstance(e){return V.AX.hasMarker(e,rC)}};N=rj;var rZ=Symbol.for("vercel.ai.error.AI_NoSpeechGeneratedError");V.AX;var rz=Symbol.for("vercel.ai.error.AI_NoTranscriptGeneratedError");V.AX;var rF="AI_NoSuchToolError",rM=`vercel.ai.error.${rF}`,rU=Symbol.for(rM),rL=class extends V.AX{constructor({toolName:e,availableTools:t,message:r=`Model tried to call unavailable tool '${e}'. ${void 0===t?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:rF,message:r}),this[Z]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return V.AX.hasMarker(e,rM)}};Z=rU;var rD="AI_ToolCallRepairError",rq=`vercel.ai.error.${rD}`,rB=Symbol.for(rq),rV=class extends V.AX{constructor({cause:e,originalError:t,message:r=`Error repairing tool call: ${(0,V.e$)(e)}`}){super({name:rD,message:r,cause:e}),this[z]=!0,this.originalError=t}static isInstance(e){return V.AX.hasMarker(e,rq)}};z=rB;var rK=class extends V.AX{constructor(e){super({name:"AI_UnsupportedModelVersionError",message:`Unsupported model version ${e.version} for provider "${e.provider}" and model "${e.modelId}". AI SDK 5 only supports models that implement specification version "v2".`}),this.version=e.version,this.provider=e.provider,this.modelId=e.modelId}},rW="AI_UIMessageStreamError",rG=`vercel.ai.error.${rW}`,rJ=Symbol.for(rG);V.AX,F=rJ;var rH="AI_InvalidDataContentError",rX=`vercel.ai.error.${rH}`,rY=Symbol.for(rX);V.AX,M=rY;var rQ="AI_InvalidMessageRoleError",r0=`vercel.ai.error.${rQ}`,r1=Symbol.for(r0),r4=class extends V.AX{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:rQ,message:t}),this[U]=!0,this.role=e}static isInstance(e){return V.AX.hasMarker(e,r0)}};U=r1;var r2="AI_MessageConversionError",r9=`vercel.ai.error.${r2}`,r3=Symbol.for(r9),r6=class extends V.AX{constructor({originalMessage:e,message:t}){super({name:r2,message:t}),this[L]=!0,this.originalMessage=e}static isInstance(e){return V.AX.hasMarker(e,r9)}};L=r3;var r5="AI_RetryError",r8=`vercel.ai.error.${r5}`,r7=Symbol.for(r8),ae=class extends V.AX{constructor({message:e,reason:t,errors:r}){super({name:r5,message:e}),this[D]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return V.AX.hasMarker(e,r8)}};D=r7;var at=!1,ar=e=>{if(0===e.warnings.length)return;let t=globalThis.AI_SDK_LOG_WARNINGS;if(!1!==t){if("function"==typeof t){t(e);return}for(let t of(at||(at=!0,console.info("AI SDK Warning System: To turn off warning logging, set the AI_SDK_LOG_WARNINGS global to false.")),e.warnings))console.warn(function({warning:e,provider:t,model:r}){let a=`AI SDK Warning (${t} / ${r}):`;switch(e.type){case"unsupported":{let t=`${a} The feature "${e.feature}" is not supported.`;return e.details&&(t+=` ${e.details}`),t}case"compatibility":{let t=`${a} The feature "${e.feature}" is used in a compatibility mode.`;return e.details&&(t+=` ${e.details}`),t}case"other":return`${a} ${e.message}`;default:return`${a} ${JSON.stringify(e,null,2)}`}}({warning:t,provider:e.provider,model:e.model}))}};function aa({provider:e,modelId:t}){ar({warnings:[{type:"compatibility",feature:"specificationVersion",details:"Using v2 specification compatibility mode. Some features may not be available."}],provider:e,model:t})}function an(e){return{unified:"unknown"===e?"other":e,raw:void 0}}function ai(e){return{inputTokens:{total:e.inputTokens,noCache:void 0,cacheRead:e.cachedInputTokens,cacheWrite:void 0},outputTokens:{total:e.outputTokens,text:void 0,reasoning:e.reasoningTokens}}}function as(e){if("string"!=typeof e){var t;if("v3"!==e.specificationVersion&&"v2"!==e.specificationVersion)throw new rK({version:e.specificationVersion,provider:e.provider,modelId:e.modelId});return"v3"===(t=e).specificationVersion?t:(aa({provider:t.provider,modelId:t.modelId}),new Proxy(t,{get(e,t){switch(t){case"specificationVersion":return"v3";case"doGenerate":return async(...t)=>{let r=await e.doGenerate(...t);return{...r,finishReason:an(r.finishReason),usage:ai(r.usage)}};case"doStream":return async(...t)=>{let r=await e.doStream(...t);return{...r,stream:r.stream.pipeThrough(new TransformStream({transform(e,t){"finish"===e.type?t.enqueue({...e,finishReason:an(e.finishReason),usage:ai(e.usage)}):t.enqueue(e)}}))}};default:return e[t]}}}))}return(function(){var e;return null!=(e=globalThis.AI_SDK_DEFAULT_PROVIDER)?e:rt})().languageModel(e)}function ao(e){return null==e?void 0:"number"==typeof e?e:e.totalMs}var al=[{mediaType:"image/gif",bytesPrefix:[71,73,70]},{mediaType:"image/png",bytesPrefix:[137,80,78,71]},{mediaType:"image/jpeg",bytesPrefix:[255,216]},{mediaType:"image/webp",bytesPrefix:[82,73,70,70,null,null,null,null,87,69,66,80]},{mediaType:"image/bmp",bytesPrefix:[66,77]},{mediaType:"image/tiff",bytesPrefix:[73,73,42,0]},{mediaType:"image/tiff",bytesPrefix:[77,77,0,42]},{mediaType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102]},{mediaType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99]}],au=e=>{let t="string"==typeof e?(0,B.MS)(e):e,r=(127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9];return t.slice(r+10)},ac="6.0.62",ad=async({url:e})=>{var t;let r=e.toString();try{let e=await fetch(r,{headers:(0,B.CR)({},`ai-sdk/${ac}`,(0,B.gJ)())});if(!e.ok)throw new B.Bx({url:r,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mediaType:null!=(t=e.headers.get("content-type"))?t:void 0}}catch(e){if(B.Bx.isInstance(e))throw e;throw new B.Bx({url:r,cause:e})}},ah=(e=ad)=>t=>Promise.all(t.map(async t=>t.isUrlSupportedByModel?null:e(t))),ap=tk.G0([tk.Z_(),tk.Pp(Uint8Array),tk.Pp(ArrayBuffer),tk.PG(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]);function af(e){if(e instanceof Uint8Array)return{data:e,mediaType:void 0};if(e instanceof ArrayBuffer)return{data:new Uint8Array(e),mediaType:void 0};if("string"==typeof e)try{e=new URL(e)}catch(e){}if(e instanceof URL&&"data:"===e.protocol){let{mediaType:t,base64Content:r}=function(e){try{let[t,r]=e.split(",");return{mediaType:t.split(";")[0].split(":")[1],base64Content:r}}catch(e){return{mediaType:void 0,base64Content:void 0}}}(e.toString());if(null==t||null==r)throw new V.AX({name:"InvalidDataContentError",message:`Invalid data URL format in content ${e.toString()}`});return{data:r,mediaType:t}}return{data:e,mediaType:void 0}}function am(e){return void 0===e?[]:Array.isArray(e)?e:[e]}async function ay({prompt:e,supportedUrls:t,download:r=ah()}){let a=await ag(e.messages,r,t),n=new Map;for(let t of e.messages)if("assistant"===t.role&&Array.isArray(t.content))for(let e of t.content)"tool-approval-request"===e.type&&"approvalId"in e&&"toolCallId"in e&&n.set(e.approvalId,e.toolCallId);let i=new Set;for(let t of e.messages)if("tool"===t.role){for(let e of t.content)if("tool-approval-response"===e.type){let t=n.get(e.approvalId);t&&i.add(t)}}let s=[...null!=e.system?"string"==typeof e.system?[{role:"system",content:e.system}]:am(e.system).map(e=>({role:"system",content:e.content,providerOptions:e.providerOptions})):[],...e.messages.map(e=>(function({message:e,downloadedAssets:t}){let r=e.role;switch(r){case"system":return{role:"system",content:e.content,providerOptions:e.providerOptions};case"user":if("string"==typeof e.content)return{role:"user",content:[{type:"text",text:e.content}],providerOptions:e.providerOptions};return{role:"user",content:e.content.map(e=>(function(e,t){var r;let a;if("text"===e.type)return{type:"text",text:e.text,providerOptions:e.providerOptions};let n=e.type;switch(n){case"image":a=e.image;break;case"file":a=e.data;break;default:throw Error(`Unsupported part type: ${n}`)}let{data:i,mediaType:s}=af(a),o=null!=s?s:e.mediaType,l=i;if(l instanceof URL){let e=t[l.toString()];e&&(l=e.data,null!=o||(o=e.mediaType))}switch(n){case"image":return(l instanceof Uint8Array||"string"==typeof l)&&(o=null!=(r=function({data:e,signatures:t}){let r="string"==typeof e&&e.startsWith("SUQz")||"string"!=typeof e&&e.length>10&&73===e[0]&&68===e[1]&&51===e[2]?au(e):e,a="string"==typeof r?(0,B.MS)(r.substring(0,Math.min(r.length,24))):r;for(let e of t)if(a.length>=e.bytesPrefix.length&&e.bytesPrefix.every((e,t)=>null===e||a[t]===e))return e.mediaType}({data:l,signatures:al}))?r:o),{type:"file",mediaType:null!=o?o:"image/*",filename:void 0,data:l,providerOptions:e.providerOptions};case"file":if(null==o)throw Error("Media type is missing for file part");return{type:"file",mediaType:o,filename:e.filename,data:l,providerOptions:e.providerOptions}}})(e,t)).filter(e=>"text"!==e.type||""!==e.text),providerOptions:e.providerOptions};case"assistant":if("string"==typeof e.content)return{role:"assistant",content:[{type:"text",text:e.content}],providerOptions:e.providerOptions};return{role:"assistant",content:e.content.filter(e=>"text"!==e.type||""!==e.text||null!=e.providerOptions).filter(e=>"tool-approval-request"!==e.type).map(e=>{let t=e.providerOptions;switch(e.type){case"file":{let{data:r,mediaType:a}=af(e.data);return{type:"file",data:r,filename:e.filename,mediaType:null!=a?a:e.mediaType,providerOptions:t}}case"reasoning":return{type:"reasoning",text:e.text,providerOptions:t};case"text":return{type:"text",text:e.text,providerOptions:t};case"tool-call":return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:e.input,providerExecuted:e.providerExecuted,providerOptions:t};case"tool-result":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:av(e.output),providerOptions:t}}}),providerOptions:e.providerOptions};case"tool":return{role:"tool",content:e.content.filter(e=>"tool-approval-response"!==e.type||e.providerExecuted).map(e=>{switch(e.type){case"tool-result":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:av(e.output),providerOptions:e.providerOptions};case"tool-approval-response":return{type:"tool-approval-response",approvalId:e.approvalId,approved:e.approved,reason:e.reason}}}),providerOptions:e.providerOptions};default:throw new r4({role:r})}})({message:e,downloadedAssets:a}))],o=[];for(let e of s){if("tool"!==e.role){o.push(e);continue}let t=o.at(-1);(null==t?void 0:t.role)==="tool"?t.content.push(...e.content):o.push(e)}let l=new Set;for(let e of o)switch(e.role){case"assistant":for(let t of e.content)"tool-call"!==t.type||t.providerExecuted||l.add(t.toolCallId);break;case"tool":for(let t of e.content)"tool-result"===t.type&&l.delete(t.toolCallId);break;case"user":case"system":for(let e of i)l.delete(e);if(l.size>0)throw new rI({toolCallIds:Array.from(l)})}for(let e of i)l.delete(e);if(l.size>0)throw new rI({toolCallIds:Array.from(l)});return o.filter(e=>"tool"!==e.role||e.content.length>0)}async function ag(e,t,r){let a=e.filter(e=>"user"===e.role).map(e=>e.content).filter(e=>Array.isArray(e)).flat().filter(e=>"image"===e.type||"file"===e.type).map(e=>{var t;let r=null!=(t=e.mediaType)?t:"image"===e.type?"image/*":void 0,a="image"===e.type?e.image:e.data;if("string"==typeof a)try{a=new URL(a)}catch(e){}return{mediaType:r,data:a}}).filter(e=>e.data instanceof URL).map(e=>({url:e.data,isUrlSupportedByModel:null!=e.mediaType&&(0,B.MT)({url:e.data.toString(),mediaType:e.mediaType,supportedUrls:r})}));return Object.fromEntries((await t(a)).map((e,t)=>null==e?null:[a[t].url.toString(),{data:e.data,mediaType:e.mediaType}]).filter(e=>null!=e))}function av(e){return"content"!==e.type?e:{type:"content",value:e.value.map(e=>"media"!==e.type?e:e.mediaType.startsWith("image/")?{type:"image-data",data:e.data,mediaType:e.mediaType}:{type:"file-data",data:e.data,mediaType:e.mediaType})}}async function a_({toolCallId:e,input:t,output:r,tool:a,errorMode:n}){return"text"===n?{type:"error-text",value:(0,V.e$)(r)}:"json"===n?{type:"error-json",value:ab(r)}:(null==a?void 0:a.toModelOutput)?await a.toModelOutput({toolCallId:e,input:t,output:r}):"string"==typeof r?{type:"text",value:r}:{type:"json",value:ab(r)}}function ab(e){return void 0===e?null:e}function aw({maxOutputTokens:e,temperature:t,topP:r,topK:a,presencePenalty:n,frequencyPenalty:i,seed:s,stopSequences:o}){if(null!=e){if(!Number.isInteger(e))throw new rc({parameter:"maxOutputTokens",value:e,message:"maxOutputTokens must be an integer"});if(e<1)throw new rc({parameter:"maxOutputTokens",value:e,message:"maxOutputTokens must be >= 1"})}if(null!=t&&"number"!=typeof t)throw new rc({parameter:"temperature",value:t,message:"temperature must be a number"});if(null!=r&&"number"!=typeof r)throw new rc({parameter:"topP",value:r,message:"topP must be a number"});if(null!=a&&"number"!=typeof a)throw new rc({parameter:"topK",value:a,message:"topK must be a number"});if(null!=n&&"number"!=typeof n)throw new rc({parameter:"presencePenalty",value:n,message:"presencePenalty must be a number"});if(null!=i&&"number"!=typeof i)throw new rc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(null!=s&&!Number.isInteger(s))throw new rc({parameter:"seed",value:s,message:"seed must be an integer"});return{maxOutputTokens:e,temperature:t,topP:r,topK:a,presencePenalty:n,frequencyPenalty:i,stopSequences:o,seed:s}}async function ak({tools:e,toolChoice:t,activeTools:r}){if(!(null!=e&&Object.keys(e).length>0))return{tools:void 0,toolChoice:void 0};let a=null!=r?Object.entries(e).filter(([e])=>r.includes(e)):Object.entries(e),n=[];for(let[e,t]of a){let r=t.type;switch(r){case void 0:case"dynamic":case"function":n.push({type:"function",name:e,description:t.description,inputSchema:await (0,B.C3)(t.inputSchema).jsonSchema,...null!=t.inputExamples?{inputExamples:t.inputExamples}:{},providerOptions:t.providerOptions,...null!=t.strict?{strict:t.strict}:{}});break;case"provider":n.push({type:"provider",name:e,id:t.id,args:t.args});break;default:throw Error(`Unsupported tool type: ${r}`)}}return{tools:n,toolChoice:null==t?{type:"auto"}:"string"==typeof t?{type:t}:{type:"tool",toolName:t.toolName}}}var aT=tk.Vo(()=>tk.G0([tk.lB(),tk.Z_(),tk.Rx(),tk.O7(),tk.IM(tk.Z_(),aT.optional()),tk.IX(aT)])),ax=tk.IM(tk.Z_(),tk.IM(tk.Z_(),aT.optional())),aS=tk.Ry({type:tk.i0("text"),text:tk.Z_(),providerOptions:ax.optional()}),aI=tk.Ry({type:tk.i0("image"),image:tk.G0([ap,tk.Pp(URL)]),mediaType:tk.Z_().optional(),providerOptions:ax.optional()}),aA=tk.Ry({type:tk.i0("file"),data:tk.G0([ap,tk.Pp(URL)]),filename:tk.Z_().optional(),mediaType:tk.Z_(),providerOptions:ax.optional()}),aE=tk.Ry({type:tk.i0("reasoning"),text:tk.Z_(),providerOptions:ax.optional()}),aO=tk.Ry({type:tk.i0("tool-call"),toolCallId:tk.Z_(),toolName:tk.Z_(),input:tk._4(),providerOptions:ax.optional(),providerExecuted:tk.O7().optional()}),aR=tk.VK("type",[tk.Ry({type:tk.i0("text"),value:tk.Z_(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("json"),value:aT,providerOptions:ax.optional()}),tk.Ry({type:tk.i0("execution-denied"),reason:tk.Z_().optional(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("error-text"),value:tk.Z_(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("error-json"),value:aT,providerOptions:ax.optional()}),tk.Ry({type:tk.i0("content"),value:tk.IX(tk.G0([tk.Ry({type:tk.i0("text"),text:tk.Z_(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("media"),data:tk.Z_(),mediaType:tk.Z_()}),tk.Ry({type:tk.i0("file-data"),data:tk.Z_(),mediaType:tk.Z_(),filename:tk.Z_().optional(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("file-url"),url:tk.Z_(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("file-id"),fileId:tk.G0([tk.Z_(),tk.IM(tk.Z_(),tk.Z_())]),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("image-data"),data:tk.Z_(),mediaType:tk.Z_(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("image-url"),url:tk.Z_(),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("image-file-id"),fileId:tk.G0([tk.Z_(),tk.IM(tk.Z_(),tk.Z_())]),providerOptions:ax.optional()}),tk.Ry({type:tk.i0("custom"),providerOptions:ax.optional()})]))})]),aP=tk.Ry({type:tk.i0("tool-result"),toolCallId:tk.Z_(),toolName:tk.Z_(),output:aR,providerOptions:ax.optional()}),a$=tk.Ry({type:tk.i0("tool-approval-request"),approvalId:tk.Z_(),toolCallId:tk.Z_()}),aC=tk.Ry({type:tk.i0("tool-approval-response"),approvalId:tk.Z_(),approved:tk.O7(),reason:tk.Z_().optional()}),aj=tk.Ry({role:tk.i0("system"),content:tk.Z_(),providerOptions:ax.optional()}),aN=tk.Ry({role:tk.i0("user"),content:tk.G0([tk.Z_(),tk.IX(tk.G0([aS,aI,aA]))]),providerOptions:ax.optional()}),aZ=tk.Ry({role:tk.i0("assistant"),content:tk.G0([tk.Z_(),tk.IX(tk.G0([aS,aA,aE,aO,aP,a$]))]),providerOptions:ax.optional()}),az=tk.Ry({role:tk.i0("tool"),content:tk.IX(tk.G0([aP,aC])),providerOptions:ax.optional()}),aF=tk.G0([aj,aN,aZ,az]);async function aM(e){let t;if(null==e.prompt&&null==e.messages)throw new V.Mt({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new V.Mt({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!=typeof e.system&&!am(e.system).every(e=>"object"==typeof e&&null!==e&&"role"in e&&"system"===e.role))throw new V.Mt({prompt:e,message:"system must be a string, SystemModelMessage, or array of SystemModelMessage"});if(null!=e.prompt&&"string"==typeof e.prompt)t=[{role:"user",content:e.prompt}];else if(null!=e.prompt&&Array.isArray(e.prompt))t=e.prompt;else if(null!=e.messages)t=e.messages;else throw new V.Mt({prompt:e,message:"prompt or messages must be defined"});if(0===t.length)throw new V.Mt({prompt:e,message:"messages must not be empty"});let r=await (0,B.pW)({value:t,schema:tk.IX(aF)});if(!r.success)throw new V.Mt({prompt:e,message:"The messages do not match the ModelMessage[] schema.",cause:r.error});return{messages:t,system:e.system}}function aU({operationId:e,telemetry:t}){return{"operation.name":`${e}${(null==t?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":null==t?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":null==t?void 0:t.functionId}}var aL={startSpan:()=>aD,startActiveSpan:(e,t,r,a)=>"function"==typeof t?t(aD):"function"==typeof r?r(aD):"function"==typeof a?a(aD):void 0},aD={spanContext:()=>aq,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},aq={traceId:"",spanId:"",traceFlags:0};async function aB({name:e,tracer:t,attributes:r,fn:a,endWhenDone:n=!0}){return t.startActiveSpan(e,{attributes:await r},async e=>{let t=rn.D.active();try{let r=await rn.D.with(t,()=>a(e));return n&&e.end(),r}catch(t){try{aV(e,t)}finally{e.end()}throw t}})}function aV(e,t){t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:ri.Q.ERROR,message:t.message})):e.setStatus({code:ri.Q.ERROR})}async function aK({telemetry:e,attributes:t}){if((null==e?void 0:e.isEnabled)!==!0)return{};let r={};for(let[a,n]of Object.entries(t))if(null!=n){if("object"==typeof n&&"input"in n&&"function"==typeof n.input){if((null==e?void 0:e.recordInputs)===!1)continue;let t=await n.input();null!=t&&(r[a]=t);continue}if("object"==typeof n&&"output"in n&&"function"==typeof n.output){if((null==e?void 0:e.recordOutputs)===!1)continue;let t=await n.output();null!=t&&(r[a]=t);continue}r[a]=n}return r}function aW(e,t){return null==e&&null==t?void 0:(null!=e?e:0)+(null!=t?t:0)}var aG=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2,abortSignal:a}={})=>async n=>aJ(n,{maxRetries:e,delayInMs:t,backoffFactor:r,abortSignal:a});async function aJ(e,{maxRetries:t,delayInMs:r,backoffFactor:a,abortSignal:n},i=[]){try{return await e()}catch(u){if((0,B.D_)(u)||0===t)throw u;let s=(0,B.e$)(u),o=[...i,u],l=o.length;if(l>t)throw new ae({message:`Failed after ${l} attempts. Last error: ${s}`,reason:"maxRetriesExceeded",errors:o});if(u instanceof Error&&V.w.isInstance(u)&&!0===u.isRetryable&&l<=t)return await (0,B.gw)(function({error:e,exponentialBackoffDelay:t}){let r;let a=e.responseHeaders;if(!a)return t;let n=a["retry-after-ms"];if(n){let e=parseFloat(n);Number.isNaN(e)||(r=e)}let i=a["retry-after"];if(i&&void 0===r){let e=parseFloat(i);r=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}return null!=r&&!Number.isNaN(r)&&0<=r&&(r<6e4||r<t)?r:t}({error:u,exponentialBackoffDelay:r}),{abortSignal:n}),aJ(e,{maxRetries:t,delayInMs:a*r,backoffFactor:a,abortSignal:n},o);if(1===l)throw u;throw new ae({message:`Failed after ${l} attempts with non-retryable error: '${s}'`,reason:"errorNotRetryable",errors:o})}}async function aH({toolCall:e,tools:t,tracer:r,telemetry:a,messages:n,abortSignal:i,experimental_context:s,onPreliminaryToolResult:o}){let{toolName:l,toolCallId:u,input:c}=e,d=null==t?void 0:t[l];if((null==d?void 0:d.execute)!=null)return aB({name:"ai.toolCall",attributes:aK({telemetry:a,attributes:{...aU({operationId:"ai.toolCall",telemetry:a}),"ai.toolCall.name":l,"ai.toolCall.id":u,"ai.toolCall.args":{output:()=>JSON.stringify(c)}}}),tracer:r,fn:async t=>{let r;try{for await(let t of(0,B.aN)({execute:d.execute.bind(d),input:c,options:{toolCallId:u,messages:n,abortSignal:i,experimental_context:s}}))"preliminary"===t.type?null==o||o({...e,type:"tool-result",output:t.output,preliminary:!0}):r=t.output}catch(r){return aV(t,r),{type:"tool-error",toolCallId:u,toolName:l,input:c,error:r,dynamic:"dynamic"===d.type,...null!=e.providerMetadata?{providerMetadata:e.providerMetadata}:{}}}try{t.setAttributes(await aK({telemetry:a,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(r)}}}))}catch(e){}return{type:"tool-result",toolCallId:u,toolName:l,input:c,output:r,dynamic:"dynamic"===d.type,...null!=e.providerMetadata?{providerMetadata:e.providerMetadata}:{}}}})}function aX(e){let t=e.filter(e=>"text"===e.type);if(0!==t.length)return t.map(e=>e.text).join("")}var aY=class{constructor({data:e,mediaType:t}){let r=e instanceof Uint8Array;this.base64Data=r?void 0:e,this.uint8ArrayData=r?e:void 0,this.mediaType=t}get base64(){return null==this.base64Data&&(this.base64Data=(0,B.k0)(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=(0,B.MS)(this.base64Data)),this.uint8ArrayData}};async function aQ({tool:e,toolCall:t,messages:r,experimental_context:a}){return null!=e.needsApproval&&("boolean"==typeof e.needsApproval?e.needsApproval:await e.needsApproval(t.input,{toolCallId:t.toolCallId,messages:r,experimental_context:a}))}async function a0(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,B.NX)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,B.NX)({text:function(e){let t=["ROOT"],r=-1,a=null;function n(e,n,i){switch(e){case'"':r=n,t.pop(),t.push(i),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=n,a=n,t.pop(),t.push(i),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=n,t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"{":r=n,t.pop(),t.push(i),t.push("INSIDE_OBJECT_START");break;case"[":r=n,t.pop(),t.push(i),t.push("INSIDE_ARRAY_START")}}function i(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function s(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let o=0;o<e.length;o++){let l=e[o];switch(t[t.length-1]){case"ROOT":n(l,o,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=o,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":n(l,o,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":i(l,o);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=o;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=o}break;case"INSIDE_ARRAY_START":"]"===l?(r=o,t.pop()):(r=o,n(l,o,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=o,t.pop();break;default:r=o}break;case"INSIDE_ARRAY_AFTER_COMMA":n(l,o,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=o;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,o),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(l,o);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(l,o);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,o);break;default:t.pop()}break;case"INSIDE_LITERAL":{let n=e.substring(a,o+1);"false".startsWith(n)||"true".startsWith(n)||"null".startsWith(n)?r=o:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?i(l,o):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,o))}}}let o=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":o+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":o+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":o+="]";break;case"INSIDE_LITERAL":{let t=e.substring(a,e.length);"true".startsWith(t)?o+="true".slice(t.length):"false".startsWith(t)?o+="false".slice(t.length):"null".startsWith(t)&&(o+="null".slice(t.length))}}return o}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}((e,t)=>{for(var r in t)rs(e,r,{get:t[r],enumerable:!0})})({},{array:()=>a2,choice:()=>a9,json:()=>a3,object:()=>a4,text:()=>a1});var a1=()=>({name:"text",responseFormat:Promise.resolve({type:"text"}),parseCompleteOutput:async({text:e})=>e,parsePartialOutput:async({text:e})=>({partial:e}),createElementStreamTransform(){}}),a4=({schema:e,name:t,description:r})=>{let a=(0,B.C3)(e);return{name:"object",responseFormat:(0,B.DB)(a.jsonSchema).then(e=>({type:"json",schema:e,...null!=t&&{name:t},...null!=r&&{description:r}})),async parseCompleteOutput({text:e},t){let r=await (0,B.NX)({text:e});if(!r.success)throw new rP({message:"No object generated: could not parse the response.",cause:r.error,text:e,response:t.response,usage:t.usage,finishReason:t.finishReason});let n=await (0,B.pW)({value:r.value,schema:a});if(!n.success)throw new rP({message:"No object generated: response did not match schema.",cause:n.error,text:e,response:t.response,usage:t.usage,finishReason:t.finishReason});return n.value},async parsePartialOutput({text:e}){let t=await a0(e);switch(t.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:t.value}}},createElementStreamTransform(){}}},a2=({element:e,name:t,description:r})=>{let a=(0,B.C3)(e);return{name:"array",responseFormat:(0,B.DB)(a.jsonSchema).then(e=>{let{$schema:a,...n}=e;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:n}},required:["elements"],additionalProperties:!1},...null!=t&&{name:t},...null!=r&&{description:r}}}),async parseCompleteOutput({text:e},t){let r=await (0,B.NX)({text:e});if(!r.success)throw new rP({message:"No object generated: could not parse the response.",cause:r.error,text:e,response:t.response,usage:t.usage,finishReason:t.finishReason});let n=r.value;if(null==n||"object"!=typeof n||!("elements"in n)||!Array.isArray(n.elements))throw new rP({message:"No object generated: response did not match schema.",cause:new V.Gz({value:n,cause:"response must be an object with an elements array"}),text:e,response:t.response,usage:t.usage,finishReason:t.finishReason});for(let r of n.elements){let n=await (0,B.pW)({value:r,schema:a});if(!n.success)throw new rP({message:"No object generated: response did not match schema.",cause:n.error,text:e,response:t.response,usage:t.usage,finishReason:t.finishReason})}return n.elements},async parsePartialOutput({text:e}){let t=await a0(e);switch(t.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let e=t.value;if(null==e||"object"!=typeof e||!("elements"in e)||!Array.isArray(e.elements))return;let r="repaired-parse"===t.state&&e.elements.length>0?e.elements.slice(0,-1):e.elements,n=[];for(let e of r){let t=await (0,B.pW)({value:e,schema:a});t.success&&n.push(t.value)}return{partial:n}}}},createElementStreamTransform(){let e=0;return new TransformStream({transform({partialOutput:t},r){if(null!=t)for(;e<t.length;e++)r.enqueue(t[e])}})}}},a9=({options:e,name:t,description:r})=>({name:"choice",responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:e}},required:["result"],additionalProperties:!1},...null!=t&&{name:t},...null!=r&&{description:r}}),async parseCompleteOutput({text:t},r){let a=await (0,B.NX)({text:t});if(!a.success)throw new rP({message:"No object generated: could not parse the response.",cause:a.error,text:t,response:r.response,usage:r.usage,finishReason:r.finishReason});let n=a.value;if(null==n||"object"!=typeof n||!("result"in n)||"string"!=typeof n.result||!e.includes(n.result))throw new rP({message:"No object generated: response did not match schema.",cause:new V.Gz({value:n,cause:"response must be an object that contains a choice value."}),text:t,response:r.response,usage:r.usage,finishReason:r.finishReason});return n.result},async parsePartialOutput({text:t}){let r=await a0(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let t=r.value;if(null==t||"object"!=typeof t||!("result"in t)||"string"!=typeof t.result)return;let a=e.filter(e=>e.startsWith(t.result));if("successful-parse"===r.state)return a.includes(t.result)?{partial:t.result}:void 0;return 1===a.length?{partial:a[0]}:void 0}}},createElementStreamTransform(){}}),a3=({name:e,description:t}={})=>({name:"json",responseFormat:Promise.resolve({type:"json",...null!=e&&{name:e},...null!=t&&{description:t}}),async parseCompleteOutput({text:e},t){let r=await (0,B.NX)({text:e});if(!r.success)throw new rP({message:"No object generated: could not parse the response.",cause:r.error,text:e,response:t.response,usage:t.usage,finishReason:t.finishReason});return r.value},async parsePartialOutput({text:e}){let t=await a0(e);switch(t.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return void 0===t.value?void 0:{partial:t.value}}},createElementStreamTransform(){}});async function a6({toolCall:e,tools:t,repairToolCall:r,system:a,messages:n}){var i;try{if(null==t){if(e.providerExecuted&&e.dynamic)return await a5(e);throw new rL({toolName:e.toolName})}try{return await a8({toolCall:e,tools:t})}catch(s){if(null==r||!(rL.isInstance(s)||rv.isInstance(s)))throw s;let i=null;try{i=await r({toolCall:e,tools:t,inputSchema:async({toolName:e})=>{let{inputSchema:r}=t[e];return await (0,B.C3)(r).jsonSchema},system:a,messages:n,error:s})}catch(e){throw new rV({cause:e,originalError:s})}if(null==i)throw s;return await a8({toolCall:i,tools:t})}}catch(n){let r=await (0,B.NX)({text:e.input}),a=r.success?r.value:e.input;return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:a,dynamic:!0,invalid:!0,error:n,title:null==(i=null==t?void 0:t[e.toolName])?void 0:i.title,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}}}async function a5(e){let t=""===e.input.trim()?{success:!0,value:{}}:await (0,B.NX)({text:e.input});if(!1===t.success)throw new rv({toolName:e.toolName,toolInput:e.input,cause:t.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:t.value,providerExecuted:!0,dynamic:!0,providerMetadata:e.providerMetadata}}async function a8({toolCall:e,tools:t}){let r=e.toolName,a=t[r];if(null==a){if(e.providerExecuted&&e.dynamic)return await a5(e);throw new rL({toolName:e.toolName,availableTools:Object.keys(t)})}let n=(0,B.C3)(a.inputSchema),i=""===e.input.trim()?await (0,B.pW)({value:{},schema:n}):await (0,B.NX)({text:e.input,schema:n});if(!1===i.success)throw new rv({toolName:r,toolInput:e.input,cause:i.error});return"dynamic"===a.type?{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:i.value,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,dynamic:!0,title:a.title}:{type:"tool-call",toolCallId:e.toolCallId,toolName:r,input:i.value,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,title:a.title}}var a7=class{constructor({content:e,finishReason:t,rawFinishReason:r,usage:a,warnings:n,request:i,response:s,providerMetadata:o}){this.content=e,this.finishReason=t,this.rawFinishReason=r,this.usage=a,this.warnings=n,this.request=i,this.response=s,this.providerMetadata=o}get text(){return this.content.filter(e=>"text"===e.type).map(e=>e.text).join("")}get reasoning(){return this.content.filter(e=>"reasoning"===e.type)}get reasoningText(){return 0===this.reasoning.length?void 0:this.reasoning.map(e=>e.text).join("")}get files(){return this.content.filter(e=>"file"===e.type).map(e=>e.file)}get sources(){return this.content.filter(e=>"source"===e.type)}get toolCalls(){return this.content.filter(e=>"tool-call"===e.type)}get staticToolCalls(){return this.toolCalls.filter(e=>!0!==e.dynamic)}get dynamicToolCalls(){return this.toolCalls.filter(e=>!0===e.dynamic)}get toolResults(){return this.content.filter(e=>"tool-result"===e.type)}get staticToolResults(){return this.toolResults.filter(e=>!0!==e.dynamic)}get dynamicToolResults(){return this.toolResults.filter(e=>!0===e.dynamic)}};async function ne({stopConditions:e,steps:t}){return(await Promise.all(e.map(e=>e({steps:t})))).some(e=>e)}async function nt({content:e,tools:t}){let r=[],a=[];for(let r of e)if("source"!==r.type&&("tool-result"!==r.type&&"tool-error"!==r.type||r.providerExecuted)&&("text"!==r.type||0!==r.text.length))switch(r.type){case"text":a.push({type:"text",text:r.text,providerOptions:r.providerMetadata});break;case"reasoning":a.push({type:"reasoning",text:r.text,providerOptions:r.providerMetadata});break;case"file":a.push({type:"file",data:r.file.base64,mediaType:r.file.mediaType,providerOptions:r.providerMetadata});break;case"tool-call":a.push({type:"tool-call",toolCallId:r.toolCallId,toolName:r.toolName,input:r.input,providerExecuted:r.providerExecuted,providerOptions:r.providerMetadata});break;case"tool-result":{let e=await a_({toolCallId:r.toolCallId,input:r.input,tool:null==t?void 0:t[r.toolName],output:r.output,errorMode:"none"});a.push({type:"tool-result",toolCallId:r.toolCallId,toolName:r.toolName,output:e,providerOptions:r.providerMetadata});break}case"tool-error":{let e=await a_({toolCallId:r.toolCallId,input:r.input,tool:null==t?void 0:t[r.toolName],output:r.error,errorMode:"json"});a.push({type:"tool-result",toolCallId:r.toolCallId,toolName:r.toolName,output:e,providerOptions:r.providerMetadata});break}case"tool-approval-request":a.push({type:"tool-approval-request",approvalId:r.approvalId,toolCallId:r.toolCall.toolCallId})}a.length>0&&r.push({role:"assistant",content:a});let n=[];for(let r of e){if(!("tool-result"===r.type||"tool-error"===r.type)||r.providerExecuted)continue;let e=await a_({toolCallId:r.toolCallId,input:r.input,tool:null==t?void 0:t[r.toolName],output:"tool-result"===r.type?r.output:r.error,errorMode:"tool-error"===r.type?"text":"none"});n.push({type:"tool-result",toolCallId:r.toolCallId,toolName:r.toolName,output:e,...null!=r.providerMetadata?{providerOptions:r.providerMetadata}:{}})}return n.length>0&&r.push({role:"tool",content:n}),r}var nr=(0,B.bF)({prefix:"aitxt",size:24});async function na({model:e,tools:t,toolChoice:r,system:a,prompt:n,messages:i,maxRetries:s,abortSignal:o,timeout:l,headers:u,stopWhen:c=function(e){return({steps:e})=>1===e.length}(0),experimental_output:d,output:h=d,experimental_telemetry:p,providerOptions:f,experimental_activeTools:m,activeTools:y=m,experimental_prepareStep:g,prepareStep:v=g,experimental_repairToolCall:_,experimental_download:b,experimental_context:w,experimental_include:k,_internal:{generateId:T=nr}={},onStepFinish:x,onFinish:S,...I}){let A=as(e),E=am(c),O=ao(l),R=function(e){if(null!=e&&"number"!=typeof e)return e.stepMs}(l),P=null!=R?new AbortController:void 0,$=function(...e){let t=e.filter(e=>null!=e);if(0===t.length)return;if(1===t.length)return t[0];let r=new AbortController;for(let e of t){if(e.aborted){r.abort(e.reason);break}e.addEventListener("abort",()=>{r.abort(e.reason)},{once:!0})}return r.signal}(o,null!=O?AbortSignal.timeout(O):void 0,null==P?void 0:P.signal),{maxRetries:C,retry:j}=function({maxRetries:e,abortSignal:t}){if(null!=e){if(!Number.isInteger(e))throw new rc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new rc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}let r=null!=e?e:2;return{maxRetries:r,retry:aG({maxRetries:r,abortSignal:t})}}({maxRetries:s,abortSignal:$}),N=aw(I),Z=(0,B.CR)(null!=u?u:{},`ai/${ac}`),z=function({model:e,settings:t,telemetry:r,headers:a}){var n;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((e,[t,r])=>{if("timeout"===t){let a=ao(r);null!=a&&(e[`ai.settings.${t}`]=a)}else e[`ai.settings.${t}`]=r;return e},{}),...Object.entries(null!=(n=null==r?void 0:r.metadata)?n:{}).reduce((e,[t,r])=>(e[`ai.telemetry.metadata.${t}`]=r,e),{}),...Object.entries(null!=a?a:{}).reduce((e,[t,r])=>(void 0!==r&&(e[`ai.request.headers.${t}`]=r),e),{})}}({model:A,telemetry:p,headers:Z,settings:{...N,maxRetries:C}}),F=await aM({system:a,prompt:n,messages:i}),M=function({isEnabled:e=!1,tracer:t}={}){return e?t||ra.g.getTracer("ai"):aL}(p);try{return await aB({name:"ai.generateText",attributes:aK({telemetry:p,attributes:{...aU({operationId:"ai.generateText",telemetry:p}),...z,"ai.model.provider":A.provider,"ai.model.id":A.modelId,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:n,messages:i})}}}),tracer:M,fn:async e=>{var n,i,s,o,l,u,c,d,m,g,O,C;let N,U;let L=F.messages,D=[],{approvedToolApprovals:q,deniedToolApprovals:V}=function({messages:e}){let t=e.at(-1);if((null==t?void 0:t.role)!="tool")return{approvedToolApprovals:[],deniedToolApprovals:[]};let r={};for(let t of e)if("assistant"===t.role&&"string"!=typeof t.content)for(let e of t.content)"tool-call"===e.type&&(r[e.toolCallId]=e);let a={};for(let t of e)if("assistant"===t.role&&"string"!=typeof t.content)for(let e of t.content)"tool-approval-request"===e.type&&(a[e.approvalId]=e);let n={};for(let e of t.content)"tool-result"===e.type&&(n[e.toolCallId]=e);let i=[],s=[];for(let e of t.content.filter(e=>"tool-approval-response"===e.type)){let t=a[e.approvalId];if(null==t)throw new rf({approvalId:e.approvalId});if(null!=n[t.toolCallId])continue;let o=r[t.toolCallId];if(null==o)throw new rk({toolCallId:t.toolCallId,approvalId:t.approvalId});let l={approvalRequest:t,approvalResponse:e,toolCall:o};e.approved?i.push(l):s.push(l)}return{approvedToolApprovals:i,deniedToolApprovals:s}}({messages:L}),K=q.filter(e=>!e.toolCall.providerExecuted);if(V.length>0||K.length>0){let e=await nn({toolCalls:K.map(e=>e.toolCall),tools:t,tracer:M,telemetry:p,messages:L,abortSignal:$,experimental_context:w}),r=[];for(let a of e){let e=await a_({toolCallId:a.toolCallId,input:a.input,tool:null==t?void 0:t[a.toolName],output:"tool-result"===a.type?a.output:a.error,errorMode:"tool-error"===a.type?"json":"none"});r.push({type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:e})}for(let e of V)r.push({type:"tool-result",toolCallId:e.toolCall.toolCallId,toolName:e.toolCall.toolName,output:{type:"execution-denied",reason:e.approvalResponse.reason,...e.toolCall.providerExecuted&&{providerOptions:{openai:{approvalId:e.approvalResponse.approvalId}}}}});D.push({role:"tool",content:r})}let W=[...q,...V].filter(e=>e.toolCall.providerExecuted);W.length>0&&D.push({role:"tool",content:W.map(e=>({type:"tool-approval-response",approvalId:e.approvalResponse.approvalId,approved:e.approvalResponse.approved,reason:e.approvalResponse.reason,providerExecuted:!0}))});let G=aw(I),J=[],H=[],X=[],Y=new Map;do{let e=null!=R?setTimeout(()=>P.abort(),R):void 0;try{let e=[...L,...D],S=await (null==v?void 0:v({model:A,steps:X,stepNumber:X.length,messages:e,experimental_context:w})),E=as(null!=(n=null==S?void 0:S.model)?n:A),R=await ay({prompt:{system:null!=(i=null==S?void 0:S.system)?i:F.system,messages:null!=(s=null==S?void 0:S.messages)?s:e},supportedUrls:await E.supportedUrls,download:b});w=null!=(o=null==S?void 0:S.experimental_context)?o:w;let{toolChoice:P,tools:U}=await ak({tools:t,toolChoice:null!=(l=null==S?void 0:S.toolChoice)?l:r,activeTools:null!=(u=null==S?void 0:S.activeTools)?u:y});N=await j(()=>{var e;return aB({name:"ai.generateText.doGenerate",attributes:aK({telemetry:p,attributes:{...aU({operationId:"ai.generateText.doGenerate",telemetry:p}),...z,"ai.model.provider":E.provider,"ai.model.id":E.modelId,"ai.prompt.messages":{input:()=>{var e;return e=R,JSON.stringify(e.map(e=>({...e,content:"string"==typeof e.content?e.content:e.content.map(e=>{var t;return"file"===e.type?{...e,data:e.data instanceof Uint8Array?"string"==typeof(t=e.data)?t:t instanceof ArrayBuffer?(0,B.k0)(new Uint8Array(t)):(0,B.k0)(t):e.data}:e})})))}},"ai.prompt.tools":{input:()=>null==U?void 0:U.map(e=>JSON.stringify(e))},"ai.prompt.toolChoice":{input:()=>null!=P?JSON.stringify(P):void 0},"gen_ai.system":E.provider,"gen_ai.request.model":E.modelId,"gen_ai.request.frequency_penalty":I.frequencyPenalty,"gen_ai.request.max_tokens":I.maxOutputTokens,"gen_ai.request.presence_penalty":I.presencePenalty,"gen_ai.request.stop_sequences":I.stopSequences,"gen_ai.request.temperature":null!=(e=I.temperature)?e:void 0,"gen_ai.request.top_k":I.topK,"gen_ai.request.top_p":I.topP}}),tracer:M,fn:async e=>{var t,r,a,n,i,s,o,l;let u=function e(t,r){if(void 0===t&&void 0===r)return;if(void 0===t)return r;if(void 0===r)return t;let a={...t};for(let n in r)if(Object.prototype.hasOwnProperty.call(r,n)){let i=r[n];if(void 0===i)continue;let s=n in t?t[n]:void 0,o=null!==i&&"object"==typeof i&&!Array.isArray(i)&&!(i instanceof Date)&&!(i instanceof RegExp),l=null!=s&&"object"==typeof s&&!Array.isArray(s)&&!(s instanceof Date)&&!(s instanceof RegExp);o&&l?a[n]=e(s,i):a[n]=i}return a}(f,null==S?void 0:S.providerOptions),c=await E.doGenerate({...G,tools:U,toolChoice:P,responseFormat:await (null==h?void 0:h.responseFormat),prompt:R,providerOptions:u,abortSignal:$,headers:Z}),d={id:null!=(r=null==(t=c.response)?void 0:t.id)?r:T(),timestamp:null!=(n=null==(a=c.response)?void 0:a.timestamp)?n:new Date,modelId:null!=(s=null==(i=c.response)?void 0:i.modelId)?s:E.modelId,headers:null==(o=c.response)?void 0:o.headers,body:null==(l=c.response)?void 0:l.body};return e.setAttributes(await aK({telemetry:p,attributes:{"ai.response.finishReason":c.finishReason.unified,"ai.response.text":{output:()=>aX(c.content)},"ai.response.toolCalls":{output:()=>{let e=ns(c.content);return null==e?void 0:JSON.stringify(e)}},"ai.response.id":d.id,"ai.response.model":d.modelId,"ai.response.timestamp":d.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(c.providerMetadata),"ai.usage.promptTokens":c.usage.inputTokens.total,"ai.usage.completionTokens":c.usage.outputTokens.total,"gen_ai.response.finish_reasons":[c.finishReason.unified],"gen_ai.response.id":d.id,"gen_ai.response.model":d.modelId,"gen_ai.usage.input_tokens":c.usage.inputTokens.total,"gen_ai.usage.output_tokens":c.usage.outputTokens.total}})),{...c,response:d}}})});let q=await Promise.all(N.content.filter(e=>"tool-call"===e.type).map(r=>a6({toolCall:r,tools:t,repairToolCall:_,system:a,messages:e}))),V={};for(let r of q){if(r.invalid)continue;let a=null==t?void 0:t[r.toolName];null!=a&&((null==a?void 0:a.onInputAvailable)!=null&&await a.onInputAvailable({input:r.input,toolCallId:r.toolCallId,messages:e,abortSignal:$,experimental_context:w}),await aQ({tool:a,toolCall:r,messages:e,experimental_context:w})&&(V[r.toolCallId]={type:"tool-approval-request",approvalId:T(),toolCall:r}))}let K=q.filter(e=>e.invalid&&e.dynamic);for(let e of(H=[],K))H.push({type:"tool-error",toolCallId:e.toolCallId,toolName:e.toolName,input:e.input,error:(0,B.e$)(e.error),dynamic:!0});for(let r of(J=q.filter(e=>!e.providerExecuted),null!=t&&H.push(...await nn({toolCalls:J.filter(e=>!e.invalid&&null==V[e.toolCallId]),tools:t,tracer:M,telemetry:p,messages:e,abortSignal:$,experimental_context:w})),q)){if(!r.providerExecuted)continue;let e=null==t?void 0:t[r.toolName];(null==e?void 0:e.type)==="provider"&&e.supportsDeferredResults&&!N.content.some(e=>"tool-result"===e.type&&e.toolCallId===r.toolCallId)&&Y.set(r.toolCallId,{toolName:r.toolName})}for(let e of N.content)"tool-result"===e.type&&Y.delete(e.toolCallId);let W=function({content:e,toolCalls:t,toolOutputs:r,toolApprovalRequests:a,tools:n}){let i=[];for(let r of e)switch(r.type){case"text":case"reasoning":case"source":i.push(r);break;case"file":i.push({type:"file",file:new aY(r),...null!=r.providerMetadata?{providerMetadata:r.providerMetadata}:{}});break;case"tool-call":i.push(t.find(e=>e.toolCallId===r.toolCallId));break;case"tool-result":{let e=t.find(e=>e.toolCallId===r.toolCallId);if(null==e){let e=null==n?void 0:n[r.toolName];if(!((null==e?void 0:e.type)==="provider"&&e.supportsDeferredResults))throw Error(`Tool call ${r.toolCallId} not found.`);r.isError?i.push({type:"tool-error",toolCallId:r.toolCallId,toolName:r.toolName,input:void 0,error:r.result,providerExecuted:!0,dynamic:r.dynamic}):i.push({type:"tool-result",toolCallId:r.toolCallId,toolName:r.toolName,input:void 0,output:r.result,providerExecuted:!0,dynamic:r.dynamic});break}r.isError?i.push({type:"tool-error",toolCallId:r.toolCallId,toolName:r.toolName,input:e.input,error:r.result,providerExecuted:!0,dynamic:e.dynamic}):i.push({type:"tool-result",toolCallId:r.toolCallId,toolName:r.toolName,input:e.input,output:r.result,providerExecuted:!0,dynamic:e.dynamic});break}case"tool-approval-request":{let e=t.find(e=>e.toolCallId===r.toolCallId);if(null==e)throw new rk({toolCallId:r.toolCallId,approvalId:r.approvalId});i.push({type:"tool-approval-request",approvalId:r.approvalId,toolCall:e})}}return[...i,...r,...a]}({content:N.content,toolCalls:q,toolOutputs:H,toolApprovalRequests:Object.values(V),tools:t});D.push(...await nt({content:W,tools:t}));let Q=null==(c=null==k?void 0:k.requestBody)||c?null!=(d=N.request)?d:{}:{...N.request,body:void 0},ee={...N.response,messages:structuredClone(D),body:null==(m=null==k?void 0:k.responseBody)||m?null==(g=N.response)?void 0:g.body:void 0},et=new a7({content:W,finishReason:N.finishReason.unified,rawFinishReason:N.finishReason.raw,usage:{inputTokens:(C=N.usage).inputTokens.total,inputTokenDetails:{noCacheTokens:C.inputTokens.noCache,cacheReadTokens:C.inputTokens.cacheRead,cacheWriteTokens:C.inputTokens.cacheWrite},outputTokens:C.outputTokens.total,outputTokenDetails:{textTokens:C.outputTokens.text,reasoningTokens:C.outputTokens.reasoning},totalTokens:aW(C.inputTokens.total,C.outputTokens.total),raw:C.raw,reasoningTokens:C.outputTokens.reasoning,cachedInputTokens:C.inputTokens.cacheRead},warnings:N.warnings,providerMetadata:N.providerMetadata,request:Q,response:ee});ar({warnings:null!=(O=N.warnings)?O:[],provider:E.provider,model:E.modelId}),X.push(et),await (null==x?void 0:x(et))}finally{null!=e&&clearTimeout(e)}}while((J.length>0&&H.length===J.length||Y.size>0)&&!await ne({stopConditions:E,steps:X}));e.setAttributes(await aK({telemetry:p,attributes:{"ai.response.finishReason":N.finishReason.unified,"ai.response.text":{output:()=>aX(N.content)},"ai.response.toolCalls":{output:()=>{let e=ns(N.content);return null==e?void 0:JSON.stringify(e)}},"ai.response.providerMetadata":JSON.stringify(N.providerMetadata),"ai.usage.promptTokens":N.usage.inputTokens.total,"ai.usage.completionTokens":N.usage.outputTokens.total}}));let Q=X[X.length-1],ee=X.reduce((e,t)=>{var r,a,n,i,s,o,l,u,c,d,h,p;return r=e,a=t.usage,{inputTokens:aW(r.inputTokens,a.inputTokens),inputTokenDetails:{noCacheTokens:aW(null==(n=r.inputTokenDetails)?void 0:n.noCacheTokens,null==(i=a.inputTokenDetails)?void 0:i.noCacheTokens),cacheReadTokens:aW(null==(s=r.inputTokenDetails)?void 0:s.cacheReadTokens,null==(o=a.inputTokenDetails)?void 0:o.cacheReadTokens),cacheWriteTokens:aW(null==(l=r.inputTokenDetails)?void 0:l.cacheWriteTokens,null==(u=a.inputTokenDetails)?void 0:u.cacheWriteTokens)},outputTokens:aW(r.outputTokens,a.outputTokens),outputTokenDetails:{textTokens:aW(null==(c=r.outputTokenDetails)?void 0:c.textTokens,null==(d=a.outputTokenDetails)?void 0:d.textTokens),reasoningTokens:aW(null==(h=r.outputTokenDetails)?void 0:h.reasoningTokens,null==(p=a.outputTokenDetails)?void 0:p.reasoningTokens)},totalTokens:aW(r.totalTokens,a.totalTokens),reasoningTokens:aW(r.reasoningTokens,a.reasoningTokens),cachedInputTokens:aW(r.cachedInputTokens,a.cachedInputTokens)}},{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0,reasoningTokens:void 0,cachedInputTokens:void 0});if(await (null==S?void 0:S({finishReason:Q.finishReason,rawFinishReason:Q.rawFinishReason,usage:Q.usage,content:Q.content,text:Q.text,reasoningText:Q.reasoningText,reasoning:Q.reasoning,files:Q.files,sources:Q.sources,toolCalls:Q.toolCalls,staticToolCalls:Q.staticToolCalls,dynamicToolCalls:Q.dynamicToolCalls,toolResults:Q.toolResults,staticToolResults:Q.staticToolResults,dynamicToolResults:Q.dynamicToolResults,request:Q.request,response:Q.response,warnings:Q.warnings,providerMetadata:Q.providerMetadata,steps:X,totalUsage:ee,experimental_context:w})),"stop"===Q.finishReason){let e=null!=h?h:a1();U=await e.parseCompleteOutput({text:Q.text},{response:Q.response,usage:Q.usage,finishReason:Q.finishReason})}return new ni({steps:X,totalUsage:ee,output:U})}})}catch(e){throw function(e){if(!tE.isInstance(e))return e;let t="https://ai-sdk.dev/unauthenticated-ai-gateway";return(null==process?void 0:"production")==="production"?new V.AX({name:"GatewayError",message:`Unauthenticated. Configure AI_GATEWAY_API_KEY or use a provider module. Learn more: ${t}`}):Object.assign(Error(`\x1b[1m\x1b[31mUnauthenticated request to AI Gateway.\x1b[0m

To authenticate, set the \x1b[33mAI_GATEWAY_API_KEY\x1b[0m environment variable with your API key.

Alternatively, you can use a provider module instead of the AI Gateway.

Learn more: \x1b[34m${t}\x1b[0m

`),{name:"GatewayAuthenticationError"})}(e)}}async function nn({toolCalls:e,tools:t,tracer:r,telemetry:a,messages:n,abortSignal:i,experimental_context:s}){return(await Promise.all(e.map(async e=>aH({toolCall:e,tools:t,tracer:r,telemetry:a,messages:n,abortSignal:i,experimental_context:s})))).filter(e=>null!=e)}var ni=class{constructor(e){this.steps=e.steps,this._output=e.output,this.totalUsage=e.totalUsage}get finalStep(){return this.steps[this.steps.length-1]}get content(){return this.finalStep.content}get text(){return this.finalStep.text}get files(){return this.finalStep.files}get reasoningText(){return this.finalStep.reasoningText}get reasoning(){return this.finalStep.reasoning}get toolCalls(){return this.finalStep.toolCalls}get staticToolCalls(){return this.finalStep.staticToolCalls}get dynamicToolCalls(){return this.finalStep.dynamicToolCalls}get toolResults(){return this.finalStep.toolResults}get staticToolResults(){return this.finalStep.staticToolResults}get dynamicToolResults(){return this.finalStep.dynamicToolResults}get sources(){return this.finalStep.sources}get finishReason(){return this.finalStep.finishReason}get rawFinishReason(){return this.finalStep.rawFinishReason}get warnings(){return this.finalStep.warnings}get providerMetadata(){return this.finalStep.providerMetadata}get response(){return this.finalStep.response}get request(){return this.finalStep.request}get usage(){return this.finalStep.usage}get experimental_output(){return this.output}get output(){if(null==this._output)throw new rN;return this._output}};function ns(e){let t=e.filter(e=>"tool-call"===e.type);if(0!==t.length)return t.map(e=>({toolCallId:e.toolCallId,toolName:e.toolName,input:e.input}))}function no(e,t){let r=new Headers(null!=e?e:{});for(let[e,a]of Object.entries(t))r.has(e)||r.set(e,a);return r}function nl(e){return e.type.startsWith("data-")}function nu(e){return"text"===e.type}function nc(e){return"file"===e.type}function nd(e){return"reasoning"===e.type}TransformStream,(0,B.DG)(()=>(0,B.r0)(tk.G0([tk.cf({type:tk.i0("text-start"),id:tk.Z_(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("text-delta"),id:tk.Z_(),delta:tk.Z_(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("text-end"),id:tk.Z_(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("error"),errorText:tk.Z_()}),tk.cf({type:tk.i0("tool-input-start"),toolCallId:tk.Z_(),toolName:tk.Z_(),providerExecuted:tk.O7().optional(),providerMetadata:ax.optional(),dynamic:tk.O7().optional(),title:tk.Z_().optional()}),tk.cf({type:tk.i0("tool-input-delta"),toolCallId:tk.Z_(),inputTextDelta:tk.Z_()}),tk.cf({type:tk.i0("tool-input-available"),toolCallId:tk.Z_(),toolName:tk.Z_(),input:tk._4(),providerExecuted:tk.O7().optional(),providerMetadata:ax.optional(),dynamic:tk.O7().optional(),title:tk.Z_().optional()}),tk.cf({type:tk.i0("tool-input-error"),toolCallId:tk.Z_(),toolName:tk.Z_(),input:tk._4(),providerExecuted:tk.O7().optional(),providerMetadata:ax.optional(),dynamic:tk.O7().optional(),errorText:tk.Z_(),title:tk.Z_().optional()}),tk.cf({type:tk.i0("tool-approval-request"),approvalId:tk.Z_(),toolCallId:tk.Z_()}),tk.cf({type:tk.i0("tool-output-available"),toolCallId:tk.Z_(),output:tk._4(),providerExecuted:tk.O7().optional(),dynamic:tk.O7().optional(),preliminary:tk.O7().optional()}),tk.cf({type:tk.i0("tool-output-error"),toolCallId:tk.Z_(),errorText:tk.Z_(),providerExecuted:tk.O7().optional(),dynamic:tk.O7().optional()}),tk.cf({type:tk.i0("tool-output-denied"),toolCallId:tk.Z_()}),tk.cf({type:tk.i0("reasoning-start"),id:tk.Z_(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("reasoning-delta"),id:tk.Z_(),delta:tk.Z_(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("reasoning-end"),id:tk.Z_(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("source-url"),sourceId:tk.Z_(),url:tk.Z_(),title:tk.Z_().optional(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("source-document"),sourceId:tk.Z_(),mediaType:tk.Z_(),title:tk.Z_(),filename:tk.Z_().optional(),providerMetadata:ax.optional()}),tk.cf({type:tk.i0("file"),url:tk.Z_(),mediaType:tk.Z_(),providerMetadata:ax.optional()}),tk.cf({type:tk.PG(e=>"string"==typeof e&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:tk.Z_().optional(),data:tk._4(),transient:tk.O7().optional()}),tk.cf({type:tk.i0("start-step")}),tk.cf({type:tk.i0("finish-step")}),tk.cf({type:tk.i0("start"),messageId:tk.Z_().optional(),messageMetadata:tk._4().optional()}),tk.cf({type:tk.i0("finish"),finishReason:tk.Km(["stop","length","content-filter","tool-calls","error","other"]).optional(),messageMetadata:tk._4().optional()}),tk.cf({type:tk.i0("abort"),reason:tk.Z_().optional()}),tk.cf({type:tk.i0("message-metadata"),messageMetadata:tk._4()})])));function nh(e){return"dynamic-tool"===e.type}function np(e){return e.type.startsWith("tool-")||nh(e)}function nf(e){return nh(e)?e.toolName:e.type.split("-").slice(1).join("-")}function nm(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}}(0,B.bF)({prefix:"aitxt",size:24});var ny=(0,B.DG)(()=>(0,B.r0)(tk.IX(tk.Ry({id:tk.Z_(),role:tk.Km(["system","user","assistant"]),metadata:tk._4().optional(),parts:tk.IX(tk.G0([tk.Ry({type:tk.i0("text"),text:tk.Z_(),state:tk.Km(["streaming","done"]).optional(),providerMetadata:ax.optional()}),tk.Ry({type:tk.i0("reasoning"),text:tk.Z_(),state:tk.Km(["streaming","done"]).optional(),providerMetadata:ax.optional()}),tk.Ry({type:tk.i0("source-url"),sourceId:tk.Z_(),url:tk.Z_(),title:tk.Z_().optional(),providerMetadata:ax.optional()}),tk.Ry({type:tk.i0("source-document"),sourceId:tk.Z_(),mediaType:tk.Z_(),title:tk.Z_(),filename:tk.Z_().optional(),providerMetadata:ax.optional()}),tk.Ry({type:tk.i0("file"),mediaType:tk.Z_(),filename:tk.Z_().optional(),url:tk.Z_(),providerMetadata:ax.optional()}),tk.Ry({type:tk.i0("step-start")}),tk.Ry({type:tk.Z_().startsWith("data-"),id:tk.Z_().optional(),data:tk._4()}),tk.Ry({type:tk.i0("dynamic-tool"),toolName:tk.Z_(),toolCallId:tk.Z_(),state:tk.i0("input-streaming"),input:tk._4().optional(),providerExecuted:tk.O7().optional(),callProviderMetadata:ax.optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),approval:tk.Fi().optional()}),tk.Ry({type:tk.i0("dynamic-tool"),toolName:tk.Z_(),toolCallId:tk.Z_(),state:tk.i0("input-available"),input:tk._4(),providerExecuted:tk.O7().optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Fi().optional()}),tk.Ry({type:tk.i0("dynamic-tool"),toolName:tk.Z_(),toolCallId:tk.Z_(),state:tk.i0("approval-requested"),input:tk._4(),providerExecuted:tk.O7().optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.Fi().optional(),reason:tk.Fi().optional()})}),tk.Ry({type:tk.i0("dynamic-tool"),toolName:tk.Z_(),toolCallId:tk.Z_(),state:tk.i0("approval-responded"),input:tk._4(),providerExecuted:tk.O7().optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.O7(),reason:tk.Z_().optional()})}),tk.Ry({type:tk.i0("dynamic-tool"),toolName:tk.Z_(),toolCallId:tk.Z_(),state:tk.i0("output-available"),input:tk._4(),providerExecuted:tk.O7().optional(),output:tk._4(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),preliminary:tk.O7().optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.i0(!0),reason:tk.Z_().optional()}).optional()}),tk.Ry({type:tk.i0("dynamic-tool"),toolName:tk.Z_(),toolCallId:tk.Z_(),state:tk.i0("output-error"),input:tk._4(),rawInput:tk._4().optional(),providerExecuted:tk.O7().optional(),output:tk.Fi().optional(),errorText:tk.Z_(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.i0(!0),reason:tk.Z_().optional()}).optional()}),tk.Ry({type:tk.i0("dynamic-tool"),toolName:tk.Z_(),toolCallId:tk.Z_(),state:tk.i0("output-denied"),input:tk._4(),providerExecuted:tk.O7().optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.i0(!1),reason:tk.Z_().optional()})}),tk.Ry({type:tk.Z_().startsWith("tool-"),toolCallId:tk.Z_(),state:tk.i0("input-streaming"),providerExecuted:tk.O7().optional(),callProviderMetadata:ax.optional(),input:tk._4().optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),approval:tk.Fi().optional()}),tk.Ry({type:tk.Z_().startsWith("tool-"),toolCallId:tk.Z_(),state:tk.i0("input-available"),providerExecuted:tk.O7().optional(),input:tk._4(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Fi().optional()}),tk.Ry({type:tk.Z_().startsWith("tool-"),toolCallId:tk.Z_(),state:tk.i0("approval-requested"),input:tk._4(),providerExecuted:tk.O7().optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.Fi().optional(),reason:tk.Fi().optional()})}),tk.Ry({type:tk.Z_().startsWith("tool-"),toolCallId:tk.Z_(),state:tk.i0("approval-responded"),input:tk._4(),providerExecuted:tk.O7().optional(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.O7(),reason:tk.Z_().optional()})}),tk.Ry({type:tk.Z_().startsWith("tool-"),toolCallId:tk.Z_(),state:tk.i0("output-available"),providerExecuted:tk.O7().optional(),input:tk._4(),output:tk._4(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),preliminary:tk.O7().optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.i0(!0),reason:tk.Z_().optional()}).optional()}),tk.Ry({type:tk.Z_().startsWith("tool-"),toolCallId:tk.Z_(),state:tk.i0("output-error"),providerExecuted:tk.O7().optional(),input:tk._4(),rawInput:tk._4().optional(),output:tk.Fi().optional(),errorText:tk.Z_(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.i0(!0),reason:tk.Z_().optional()}).optional()}),tk.Ry({type:tk.Z_().startsWith("tool-"),toolCallId:tk.Z_(),state:tk.i0("output-denied"),providerExecuted:tk.O7().optional(),input:tk._4(),output:tk.Fi().optional(),errorText:tk.Fi().optional(),callProviderMetadata:ax.optional(),approval:tk.Ry({id:tk.Z_(),approved:tk.i0(!1),reason:tk.Z_().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty")));async function ng({messages:e,metadataSchema:t,dataSchemas:r,tools:a}){try{if(null==e)return{success:!1,error:new rc({parameter:"messages",value:e,message:"messages parameter must be provided"})};let n=await validateTypes2({value:e,schema:ny});if(t)for(let[e,r]of n.entries())await validateTypes2({value:r.metadata,schema:t,context:{field:`messages[${e}].metadata`,entityId:r.id}});if(r||a)for(let[e,t]of n.entries())for(let[n,i]of t.parts.entries()){if(r&&i.type.startsWith("data-")){let t=i.type.slice(5),a=r[t];if(!a)return{success:!1,error:new TypeValidationError3({value:i.data,cause:`No data schema found for data part ${t}`,context:{field:`messages[${e}].parts[${n}].data`,entityName:t,entityId:i.id}})};await validateTypes2({value:i.data,schema:a,context:{field:`messages[${e}].parts[${n}].data`,entityName:t,entityId:i.id}})}if(a&&i.type.startsWith("tool-")){let t=i.type.slice(5),r=a[t];if(!r)return{success:!1,error:new TypeValidationError3({value:i.input,cause:`No tool schema found for tool part ${t}`,context:{field:`messages[${e}].parts[${n}].input`,entityName:t,entityId:i.toolCallId}})};("input-available"===i.state||"output-available"===i.state||"output-error"===i.state&&void 0!==i.input)&&await validateTypes2({value:i.input,schema:r.inputSchema,context:{field:`messages[${e}].parts[${n}].input`,entityName:t,entityId:i.toolCallId}}),"output-available"===i.state&&r.outputSchema&&await validateTypes2({value:i.output,schema:r.outputSchema,context:{field:`messages[${e}].parts[${n}].output`,entityName:t,entityId:i.toolCallId}})}}return{success:!0,data:n}}catch(e){return{success:!1,error:e}}}async function nv(e,t,r){let a=await safeParseJSON4({text:e});if(!a.success)throw new rP({message:"No object generated: could not parse the response.",cause:a.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});let n=await t.validateFinalResult(a.value,{text:e,response:r.response,usage:r.usage});if(!n.success)throw new rP({message:"No object generated: response did not match schema.",cause:n.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});return n.value}(0,B.bF)({prefix:"aiobj",size:24}),(0,B.bF)({prefix:"aiobj",size:24});var n_=({model:e,middleware:{transformParams:t,wrapGenerate:r,wrapStream:a,overrideProvider:n,overrideModelId:i,overrideSupportedUrls:s},modelId:o,providerId:l})=>{var u,c,d;async function h({params:r,type:a}){return t?await t({params:r,type:a,model:e}):r}return{specificationVersion:"v3",provider:null!=(u=null!=l?l:null==n?void 0:n({model:e}))?u:e.provider,modelId:null!=(c=null!=o?o:null==i?void 0:i({model:e}))?c:e.modelId,supportedUrls:null!=(d=null==s?void 0:s({model:e}))?d:e.supportedUrls,async doGenerate(t){let a=await h({params:t,type:"generate"}),n=async()=>e.doGenerate(a),i=async()=>e.doStream(a);return r?r({doGenerate:n,doStream:i,params:a,model:e}):n()},async doStream(t){let r=await h({params:t,type:"stream"}),n=async()=>e.doGenerate(r),i=async()=>e.doStream(r);return a?a({doGenerate:n,doStream:i,params:r,model:e}):i()}}},nb=({model:e,middleware:{transformParams:t,wrapGenerate:r,overrideProvider:a,overrideModelId:n,overrideMaxImagesPerCall:i},modelId:s,providerId:o})=>{var l,u,c;async function d({params:r}){return t?await t({params:r,model:e}):r}let h=null!=(l=null==i?void 0:i({model:e}))?l:e.maxImagesPerCall,p=h instanceof Function?h.bind(e):h;return{specificationVersion:"v3",provider:null!=(u=null!=o?o:null==a?void 0:a({model:e}))?u:e.provider,modelId:null!=(c=null!=s?s:null==n?void 0:n({model:e}))?c:e.modelId,maxImagesPerCall:p,async doGenerate(t){let a=await d({params:t}),n=async()=>e.doGenerate(a);return r?r({doGenerate:n,params:a,model:e}):n()}}},nw="AI_NoSuchProviderError",nk=`vercel.ai.error.${nw}`,nT=Symbol.for(nk);V.JJ,q=nT},7997:(e,t,r)=>{"use strict";r.d(t,{Bx:()=>_,C3:()=>eu,CR:()=>S,DB:()=>em,DG:()=>eo,D_:()=>k,MS:()=>f,MT:()=>I,NX:()=>eh,RF:()=>ep,aN:()=>ey,bF:()=>b,e$:()=>w,gJ:()=>T,gw:()=>c,k0:()=>m,kh:()=>x,pW:()=>ed,r0:()=>ec,w3:()=>ef});var a,n,i=r(1778),s=r(8436),o=r(2574),l=r(1067),u=r(1536);async function c(e,t){if(null==e)return Promise.resolve();let r=null==t?void 0:t.abortSignal;return new Promise((t,a)=>{if(null==r?void 0:r.aborted){a(d());return}let n=setTimeout(()=>{i(),t()},e),i=()=>{clearTimeout(n),null==r||r.removeEventListener("abort",s)},s=()=>{i(),a(d())};null==r||r.addEventListener("abort",s)})}function d(){return new DOMException("Delay was aborted","AbortError")}var{btoa:h,atob:p}=globalThis;function f(e){let t=p(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}function m(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return h(t)}var y="AI_DownloadError",g=`vercel.ai.error.${y}`,v=Symbol.for(g),_=class extends(n=i.AX,a=v,n){constructor({url:e,statusCode:t,statusText:r,cause:n,message:i=null==n?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${n}`}){super({name:y,message:i,cause:n}),this[a]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return i.AX.hasMarker(e,g)}},b=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{let n=()=>{let e=r.length,a=Array(t);for(let n=0;n<t;n++)a[n]=r[Math.random()*e|0];return a.join("")};if(null==e)return n;if(r.includes(a))throw new i.RU({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return()=>`${e}${a}${n()}`};function w(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}function k(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}function T(e=globalThis){var t,r,a;return e.window?"runtime/browser":(null==(t=e.navigator)?void 0:t.userAgent)?`runtime/${e.navigator.userAgent.toLowerCase()}`:(null==(a=null==(r=e.process)?void 0:r.versions)?void 0:a.node)?`runtime/node.js/${e.process.version.substring(0)}`:e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function x(e){if(null==e)return{};let t={};if(e instanceof Headers)e.forEach((e,r)=>{t[r.toLowerCase()]=e});else for(let[r,a]of(Array.isArray(e)||(e=Object.entries(e)),e))null!=a&&(t[r.toLowerCase()]=a);return t}function S(e,...t){let r=new Headers(x(e)),a=r.get("user-agent")||"";return r.set("user-agent",[a,...t].filter(Boolean).join(" ")),Object.fromEntries(r.entries())}function I({mediaType:e,url:t,supportedUrls:r}){return t=t.toLowerCase(),e=e.toLowerCase(),Object.entries(r).map(([e,t])=>{let r=e.toLowerCase();return"*"===r||"*/*"===r?{mediaTypePrefix:"",regexes:t}:{mediaTypePrefix:r.replace(/\*/,""),regexes:t}}).filter(({mediaTypePrefix:t})=>e.startsWith(t)).flatMap(({regexes:e})=>e).some(e=>e.test(t))}b();var A=/"__proto__"\s*:/,E=/"constructor"\s*:/;function O(e){let t=JSON.parse(e);return null===t||"object"!=typeof t||!1===A.test(e)&&!1===E.test(e)?t:function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let a=r[e];a&&"object"==typeof a&&t.push(a)}}}return e}(t)}function R(e){if("object"===e.type||Array.isArray(e.type)&&e.type.includes("object")){e.additionalProperties=!1;let{properties:t}=e;if(null!=t)for(let e of Object.keys(t))t[e]=P(t[e])}null!=e.items&&(e.items=Array.isArray(e.items)?e.items.map(P):P(e.items)),null!=e.anyOf&&(e.anyOf=e.anyOf.map(P)),null!=e.allOf&&(e.allOf=e.allOf.map(P)),null!=e.oneOf&&(e.oneOf=e.oneOf.map(P));let{definitions:t}=e;if(null!=t)for(let e of Object.keys(t))t[e]=P(t[e]);return e}function P(e){return"boolean"==typeof e?e:R(e)}var $=Symbol("Let zodToJsonSchema decide on which parser to use"),C={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},j=e=>"string"==typeof e?{...C,name:e}:{...C,...e};function N(e,t){return et(e.type._def,t)}var Z=(e,t)=>et(e.innerType._def,t),z=e=>{let t={type:"integer",format:"unix-time"};for(let r of e.checks)switch(r.kind){case"min":t.minimum=r.value;break;case"max":t.maximum=r.value}return t},F=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,M=void 0,U={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===M&&(M=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),M),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function L(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value;break;case"max":r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"email":switch(t.emailStrategy){case"format:email":B(r,"email",a.message,t);break;case"format:idn-email":B(r,"idn-email",a.message,t);break;case"pattern:zod":V(r,U.email,a.message,t)}break;case"url":B(r,"uri",a.message,t);break;case"uuid":B(r,"uuid",a.message,t);break;case"regex":V(r,a.regex,a.message,t);break;case"cuid":V(r,U.cuid,a.message,t);break;case"cuid2":V(r,U.cuid2,a.message,t);break;case"startsWith":V(r,RegExp(`^${D(a.value,t)}`),a.message,t);break;case"endsWith":V(r,RegExp(`${D(a.value,t)}$`),a.message,t);break;case"datetime":B(r,"date-time",a.message,t);break;case"date":B(r,"date",a.message,t);break;case"time":B(r,"time",a.message,t);break;case"duration":B(r,"duration",a.message,t);break;case"length":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"includes":V(r,RegExp(D(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&B(r,"ipv4",a.message,t),"v4"!==a.version&&B(r,"ipv6",a.message,t);break;case"base64url":V(r,U.base64url,a.message,t);break;case"jwt":V(r,U.jwt,a.message,t);break;case"cidr":"v6"!==a.version&&V(r,U.ipv4Cidr,a.message,t),"v4"!==a.version&&V(r,U.ipv6Cidr,a.message,t);break;case"emoji":V(r,U.emoji(),a.message,t);break;case"ulid":V(r,U.ulid,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":B(r,"binary",a.message,t);break;case"contentEncoding:base64":r.contentEncoding="base64";break;case"pattern:zod":V(r,U.base64,a.message,t)}break;case"nanoid":V(r,U.nanoid,a.message,t)}return r}function D(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)q.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}var q=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function B(e,t,r,a){var n;e.format||(null==(n=e.anyOf)?void 0:n.some(e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function V(e,t,r,a){var n;e.pattern||(null==(n=e.allOf)?void 0:n.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:K(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=K(t,a)}function K(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;let a={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=a.i?e.source.toLowerCase():e.source,i="",s=!1,o=!1,l=!1;for(let e=0;e<n.length;e++){if(s){i+=n[e],s=!1;continue}if(a.i){if(o){if(n[e].match(/[a-z]/)){l?(i+=n[e]+`${n[e-2]}-${n[e]}`.toUpperCase(),l=!1):"-"===n[e+1]&&(null==(r=n[e+2])?void 0:r.match(/[a-z]/))?(i+=n[e],l=!0):i+=`${n[e]}${n[e].toUpperCase()}`;continue}}else if(n[e].match(/[a-z]/)){i+=`[${n[e]}${n[e].toUpperCase()}]`;continue}}if(a.m){if("^"===n[e]){i+=`(^|(?<=[\r
]))`;continue}if("$"===n[e]){i+=`($|(?=[\r
]))`;continue}}if(a.s&&"."===n[e]){i+=o?`${n[e]}\r
`:`[${n[e]}\r
]`;continue}i+=n[e],"\\"===n[e]?s=!0:o&&"]"===n[e]?o=!1:o||"["!==n[e]||(o=!0)}try{new RegExp(i)}catch(r){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return i}function W(e,t){var r,a,n,i,s,o;let u={type:"object",additionalProperties:null!=(r=et(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))?r:t.allowedAdditionalProperties};if((null==(a=e.keyType)?void 0:a._def.typeName)===l.pA.ZodString&&(null==(n=e.keyType._def.checks)?void 0:n.length)){let{type:r,...a}=L(e.keyType._def,t);return{...u,propertyNames:a}}if((null==(i=e.keyType)?void 0:i._def.typeName)===l.pA.ZodEnum)return{...u,propertyNames:{enum:e.keyType._def.values}};if((null==(s=e.keyType)?void 0:s._def.typeName)===l.pA.ZodBranded&&e.keyType._def.type._def.typeName===l.pA.ZodString&&(null==(o=e.keyType._def.type._def.checks)?void 0:o.length)){let{type:r,...a}=N(e.keyType._def,t);return{...u,propertyNames:a}}return u}var G={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},J=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>et(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},H=(e,t)=>{var r;if(t.currentPath.toString()===(null==(r=t.propertyPath)?void 0:r.toString()))return et(e.innerType._def,t);let a=et(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return a?{anyOf:[{not:{}},a]}:{}},X=(e,t)=>{if("input"===t.pipeStrategy)return et(e.in._def,t);if("output"===t.pipeStrategy)return et(e.out._def,t);let r=et(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),a=et(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(e=>void 0!==e)}},Y=(e,t)=>et(e.innerType._def,t),Q=(e,t,r)=>{switch(t){case l.pA.ZodString:return L(e,r);case l.pA.ZodNumber:return function(e){let t={type:"number"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"int":t.type="integer";break;case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case l.pA.ZodObject:return function(e,t){let r={type:"object",properties:{}},a=[],n=e.shape();for(let e in n){let i=n[e];if(void 0===i||void 0===i._def)continue;let s=function(e){try{return e.isOptional()}catch(e){return!0}}(i),o=et(i._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==o&&(r.properties[e]=o,s||a.push(e))}a.length&&(r.required=a);let i=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return et(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==i&&(r.additionalProperties=i),r}(e,r);case l.pA.ZodBigInt:return function(e){let t={type:"integer",format:"int64"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case l.pA.ZodBoolean:return{type:"boolean"};case l.pA.ZodDate:return function e(t,r,a){let n=null!=a?a:r.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((a,n)=>e(t,r,a))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return z(t)}}(e,r);case l.pA.ZodUndefined:return{not:{}};case l.pA.ZodNull:return{type:"null"};case l.pA.ZodArray:return function(e,t){var r,a,n;let i={type:"array"};return(null==(r=e.type)?void 0:r._def)&&(null==(n=null==(a=e.type)?void 0:a._def)?void 0:n.typeName)!==l.pA.ZodAny&&(i.items=et(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(i.minItems=e.minLength.value),e.maxLength&&(i.maxItems=e.maxLength.value),e.exactLength&&(i.minItems=e.exactLength.value,i.maxItems=e.exactLength.value),i}(e,r);case l.pA.ZodUnion:case l.pA.ZodDiscriminatedUnion:return function(e,t){let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in G&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=G[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return J(e,t)}(e,r);case l.pA.ZodIntersection:return function(e,t){let r=[et(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),et(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),a=[];return r.forEach(e=>{if(F(e))a.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}a.push(t)}}),a.length?{allOf:a}:void 0}(e,r);case l.pA.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>et(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:et(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>et(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case l.pA.ZodRecord:return W(e,r);case l.pA.ZodLiteral:return function(e){let t=typeof e.value;return"bigint"!==t&&"number"!==t&&"boolean"!==t&&"string"!==t?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===t?"integer":t,const:e.value}}(e);case l.pA.ZodEnum:return{type:"string",enum:Array.from(e.values)};case l.pA.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),a=Array.from(new Set(r.map(e=>typeof e)));return{type:1===a.length?"string"===a[0]?"string":"number":["string","number"],enum:r}}(e);case l.pA.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[G[e.innerType._def.typeName],"null"]};let r=et(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case l.pA.ZodOptional:return H(e,r);case l.pA.ZodMap:return function(e,t){return"record"===t.mapStrategy?W(e,t):{type:"array",maxItems:125,items:{type:"array",items:[et(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},et(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case l.pA.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:et(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(r.minItems=e.minSize.value),e.maxSize&&(r.maxItems=e.maxSize.value),r}(e,r);case l.pA.ZodLazy:return()=>e.getter()._def;case l.pA.ZodPromise:return et(e.type._def,r);case l.pA.ZodNaN:case l.pA.ZodNever:return{not:{}};case l.pA.ZodEffects:return function(e,t){return"input"===t.effectStrategy?et(e.schema._def,t):{}}(e,r);case l.pA.ZodAny:case l.pA.ZodUnknown:return{};case l.pA.ZodDefault:return function(e,t){return{...et(e.innerType._def,t),default:e.defaultValue()}}(e,r);case l.pA.ZodBranded:return N(e,r);case l.pA.ZodReadonly:return Y(e,r);case l.pA.ZodCatch:return Z(e,r);case l.pA.ZodPipeline:return X(e,r);case l.pA.ZodFunction:case l.pA.ZodVoid:case l.pA.ZodSymbol:default:return}},ee=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};function et(e,t,r=!1){var a;let n=t.seen.get(e);if(t.override){let i=null==(a=t.override)?void 0:a.call(t,e,t,n,r);if(i!==$)return i}if(n&&!r){let e=er(n,t);if(void 0!==e)return e}let i={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,i);let s=Q(e,e.typeName,t),o="function"==typeof s?et(s(),t):s;if(o&&ea(e,t,o),t.postProcess){let r=t.postProcess(o,e,t);return i.jsonSchema=o,r}return i.jsonSchema=o,o}var er=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:ee(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},ea=(e,t,r)=>(e.description&&(r.description=e.description),r),en=e=>{let t=j(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}},ei=(e,t)=>{var r;let a=en(t),n="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>{var n;return{...e,[t]:null!=(n=et(r._def,{...a,currentPath:[...a.basePath,a.definitionPath,t]},!0))?n:{}}},{}):void 0,i="string"==typeof t?t:(null==t?void 0:t.nameStrategy)==="title"?void 0:null==t?void 0:t.name,s=null!=(r=et(e._def,void 0===i?a:{...a,currentPath:[...a.basePath,a.definitionPath,i]},!1))?r:{},o="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==o&&(s.title=o);let l=void 0===i?n?{...s,[a.definitionPath]:n}:s:{$ref:[..."relative"===a.$refStrategy?[]:a.basePath,a.definitionPath,i].join("/"),[a.definitionPath]:{...n,[i]:s}};return l.$schema="http://json-schema.org/draft-07/schema#",l},es=Symbol.for("vercel.ai.schema");function eo(e){let t;return()=>(null==t&&(t=e()),t)}function el(e,{validate:t}={}){return{[es]:!0,_type:void 0,get jsonSchema(){return"function"==typeof e&&(e=e()),e},validate:t}}function eu(e){return null==e?el({properties:{},additionalProperties:!1}):"object"==typeof e&&null!==e&&es in e&&!0===e[es]&&"jsonSchema"in e&&"validate"in e?e:"~standard"in e?"zod"===e["~standard"].vendor?ec(e):el(()=>R(e["~standard"].jsonSchema.input({target:"draft-07"})),{validate:async t=>{let r=await e["~standard"].validate(t);return"value"in r?{success:!0,value:r.value}:{success:!1,error:new i.Gz({value:t,cause:r.issues})}}}):e()}function ec(e,t){return"_zod"in e?function(e,t){var r;let a=null!=(r=null==t?void 0:t.useReferences)&&r;return el(()=>R(s.a(e,{target:"draft-7",io:"input",reused:a?"ref":"inline"})),{validate:async t=>{let r=await o.X9(e,t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}(e,t):function(e,t){var r;let a=null!=(r=null==t?void 0:t.useReferences)&&r;return el(()=>ei(e,{$refStrategy:a?"root":"none"}),{validate:async t=>{let r=await e.safeParseAsync(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}(e,t)}async function ed({value:e,schema:t,context:r}){let a=eu(t);try{if(null==a.validate)return{success:!0,value:e,rawValue:e};let t=await a.validate(e);if(t.success)return{success:!0,value:t.value,rawValue:e};return{success:!1,error:i.Gz.wrap({value:e,cause:t.error,context:r}),rawValue:e}}catch(t){return{success:!1,error:i.Gz.wrap({value:e,cause:t,context:r}),rawValue:e}}}async function eh({text:e,schema:t}){try{let r=function(e){let{stackTraceLimit:t}=Error;try{Error.stackTraceLimit=0}catch(t){return O(e)}try{return O(e)}finally{Error.stackTraceLimit=t}}(e);if(null==t)return{success:!0,value:r,rawValue:r};return await ed({value:r,schema:t})}catch(t){return{success:!1,error:i.xU.isInstance(t)?t:new i.xU({text:e,cause:t}),rawValue:void 0}}}function ep({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new u.m).pipeThrough(new TransformStream({async transform({data:e},r){"[DONE]"!==e&&r.enqueue(await eh({text:e,schema:t}))}}))}function ef(e){return e}async function em(e){return"function"==typeof e&&(e=e()),Promise.resolve(e)}async function*ey({execute:e,input:t,options:r}){let a=e(t,r);if(null!=a&&"function"==typeof a[Symbol.asyncIterator]){let e;for await(let t of a)e=t,yield{type:"preliminary",output:t};yield{type:"final",output:e}}else yield{type:"final",output:await a}}},1778:(e,t,r)=>{"use strict";r.d(t,{AX:()=>w,A_:()=>H,Gz:()=>K,JJ:()=>D,Mt:()=>j,RU:()=>R,e$:()=>I,w:()=>S,xU:()=>F});var a,n,i,s,o,l,u,c,d,h,p,f,m,y,g,v,_="vercel.ai.error",b=Symbol.for(_),w=class e extends(n=Error,a=b,n){constructor({name:e,message:t,cause:r}){super(t),this[a]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,_)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}},k="AI_APICallError",T=`vercel.ai.error.${k}`,x=Symbol.for(T),S=class extends(s=w,i=x,s){constructor({message:e,url:t,requestBodyValues:r,statusCode:a,responseHeaders:n,responseBody:s,cause:o,isRetryable:l=null!=a&&(408===a||409===a||429===a||a>=500),data:u}){super({name:k,message:e,cause:o}),this[i]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=a,this.responseHeaders=n,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(e){return w.hasMarker(e,T)}};function I(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError");var A="AI_InvalidArgumentError",E=`vercel.ai.error.${A}`,O=Symbol.for(E),R=class extends(l=w,o=O,l){constructor({message:e,cause:t,argument:r}){super({name:A,message:e,cause:t}),this[o]=!0,this.argument=r}static isInstance(e){return w.hasMarker(e,E)}},P="AI_InvalidPromptError",$=`vercel.ai.error.${P}`,C=Symbol.for($),j=class extends(c=w,u=C,c){constructor({prompt:e,message:t,cause:r}){super({name:P,message:`Invalid prompt: ${t}`,cause:r}),this[u]=!0,this.prompt=e}static isInstance(e){return w.hasMarker(e,$)}},N=(Symbol.for("vercel.ai.error.AI_InvalidResponseDataError"),"AI_JSONParseError"),Z=`vercel.ai.error.${N}`,z=Symbol.for(Z),F=class extends(h=w,d=z,h){constructor({text:e,cause:t}){super({name:N,message:`JSON parsing failed: Text: ${e}.
Error message: ${I(t)}`,cause:t}),this[d]=!0,this.text=e}static isInstance(e){return w.hasMarker(e,Z)}},M=(Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),"AI_NoSuchModelError"),U=`vercel.ai.error.${M}`,L=Symbol.for(U),D=class extends(f=w,p=L,f){constructor({errorName:e=M,modelId:t,modelType:r,message:a=`No such ${r}: ${t}`}){super({name:e,message:a}),this[p]=!0,this.modelId=t,this.modelType=r}static isInstance(e){return w.hasMarker(e,U)}},q=(Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError"),"AI_TypeValidationError"),B=`vercel.ai.error.${q}`,V=Symbol.for(B),K=class e extends(y=w,m=V,y){constructor({value:e,cause:t,context:r}){let a="Type validation failed";if((null==r?void 0:r.field)&&(a+=` for ${r.field}`),(null==r?void 0:r.entityName)||(null==r?void 0:r.entityId)){a+=" (";let e=[];r.entityName&&e.push(r.entityName),r.entityId&&e.push(`id: "${r.entityId}"`),a+=e.join(", ")+")"}super({name:q,message:`${a}: Value: ${JSON.stringify(e)}.
Error message: ${I(t)}`,cause:t}),this[m]=!0,this.value=e,this.context=r}static isInstance(e){return w.hasMarker(e,B)}static wrap({value:t,cause:r,context:a}){var n,i,s;return e.isInstance(r)&&r.value===t&&(null==(n=r.context)?void 0:n.field)===(null==a?void 0:a.field)&&(null==(i=r.context)?void 0:i.entityName)===(null==a?void 0:a.entityName)&&(null==(s=r.context)?void 0:s.entityId)===(null==a?void 0:a.entityId)?r:new e({value:t,cause:r,context:a})}},W="AI_UnsupportedFunctionalityError",G=`vercel.ai.error.${W}`,J=Symbol.for(G),H=class extends(v=w,g=J,v){constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:W,message:t}),this[g]=!0,this.functionality=e}static isInstance(e){return w.hasMarker(e,G)}};function X(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(X):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&(void 0===t||X(t))))}},1536:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});class a extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function n(e){}class i extends TransformStream{constructor({onError:e,onRetry:t,onComment:r}={}){let i;super({start(s){i=function(e){if("function"==typeof e)throw TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:t=n,onError:r=n,onRetry:i=n,onComment:s}=e,o="",l=!0,u,c="",d="";function h(e){if(""===e){c.length>0&&t({id:u,event:d||void 0,data:c.endsWith(`
`)?c.slice(0,-1):c}),u=void 0,c="",d="";return}if(e.startsWith(":")){s&&s(e.slice(e.startsWith(": ")?2:1));return}let r=e.indexOf(":");if(-1!==r){let t=e.slice(0,r),a=" "===e[r+1]?2:1;p(t,e.slice(r+a),e);return}p(e,"",e)}function p(e,t,n){switch(e){case"event":d=t;break;case"data":c=`${c}${t}
`;break;case"id":u=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?i(parseInt(t,10)):r(new a(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:n}));break;default:r(new a(`Unknown field "${e.length>20?`${e.slice(0,20)}\u2026`:e}"`,{type:"unknown-field",field:e,value:t,line:n}))}}return{feed:function(e){let t=l?e.replace(/^\xEF\xBB\xBF/,""):e,[r,a]=function(e){let t=[],r="",a=0;for(;a<e.length;){let n=e.indexOf("\r",a),i=e.indexOf(`
`,a),s=-1;if(-1!==n&&-1!==i?s=Math.min(n,i):-1!==n?s=n===e.length-1?-1:n:-1!==i&&(s=i),-1===s){r=e.slice(a);break}{let r=e.slice(a,s);t.push(r),"\r"===e[(a=s+1)-1]&&e[a]===`
`&&a++}}return[t,r]}(`${o}${t}`);for(let e of r)h(e);o=a,l=!1},reset:function(e={}){o&&e.consume&&h(o),l=!0,u=void 0,c="",d="",o=""}}}({onEvent:e=>{s.enqueue(e)},onError(t){"terminate"===e?s.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:r})},transform(e){i.feed(e)}})}}},1067:(e,t,r)=>{"use strict";var a,n,i,s;let o;r.d(t,{pA:()=>s,IX:()=>eP,O7:()=>eR,Km:()=>ej,Rx:()=>eO,Ry:()=>e$,Z_:()=>eE,G0:()=>eC}),function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),a={};for(let e of r)a[e]=t[e];return e.objectValues(a)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(a||(a={})),(n||(n={})).mergeShapes=(e,t)=>({...e,...t});let l=a.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),u=e=>{switch(typeof e){case"undefined":return l.undefined;case"string":return l.string;case"number":return Number.isNaN(e)?l.nan:l.number;case"boolean":return l.boolean;case"function":return l.function;case"bigint":return l.bigint;case"symbol":return l.symbol;case"object":if(Array.isArray(e))return l.array;if(null===e)return l.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return l.promise;if("undefined"!=typeof Map&&e instanceof Map)return l.map;if("undefined"!=typeof Set&&e instanceof Set)return l.set;if("undefined"!=typeof Date&&e instanceof Date)return l.date;return l.object;default:return l.unknown}},c=a.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class d extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},a=e=>{for(let n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(a);else if("invalid_return_type"===n.code)a(n.returnTypeError);else if("invalid_arguments"===n.code)a(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,a=0;for(;a<n.path.length;){let r=n.path[a];a===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],a++}}};return a(this),r}static assert(e){if(!(e instanceof d))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,a.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let a of this.issues)if(a.path.length>0){let r=a.path[0];t[r]=t[r]||[],t[r].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}d.create=e=>new d(e);let h=(e,t)=>{let r;switch(e.code){case c.invalid_type:r=e.received===l.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case c.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,a.jsonStringifyReplacer)}`;break;case c.unrecognized_keys:r=`Unrecognized key(s) in object: ${a.joinValues(e.keys,", ")}`;break;case c.invalid_union:r="Invalid input";break;case c.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${a.joinValues(e.options)}`;break;case c.invalid_enum_value:r=`Invalid enum value. Expected ${a.joinValues(e.options)}, received '${e.received}'`;break;case c.invalid_arguments:r="Invalid function arguments";break;case c.invalid_return_type:r="Invalid function return type";break;case c.invalid_date:r="Invalid date";break;case c.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:a.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case c.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case c.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case c.custom:r="Invalid input";break;case c.invalid_intersection_types:r="Intersection results could not be merged";break;case c.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case c.not_finite:r="Number must be finite";break;default:r=t.defaultError,a.assertNever(e)}return{message:r}};!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(i||(i={}));let p=e=>{let{data:t,path:r,errorMaps:a,issueData:n}=e,i=[...r,...n.path||[]],s={...n,path:i};if(void 0!==n.message)return{...n,path:i,message:n.message};let o="";for(let e of a.filter(e=>!!e).slice().reverse())o=e(s,{data:t,defaultError:o}).message;return{...n,path:i,message:o}};function f(e,t){let r=p({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,h,h==h?void 0:h].filter(e=>!!e)});e.common.issues.push(r)}class m{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let a of t){if("aborted"===a.status)return y;"dirty"===a.status&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,a=await e.value;r.push({key:t,value:a})}return m.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let a of t){let{key:t,value:n}=a;if("aborted"===t.status||"aborted"===n.status)return y;"dirty"===t.status&&e.dirty(),"dirty"===n.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==n.value||a.alwaysSet)&&(r[t.value]=n.value)}return{status:e.value,value:r}}}let y=Object.freeze({status:"aborted"}),g=e=>({status:"dirty",value:e}),v=e=>({status:"valid",value:e}),_=e=>"aborted"===e.status,b=e=>"dirty"===e.status,w=e=>"valid"===e.status,k=e=>"undefined"!=typeof Promise&&e instanceof Promise;class T{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let x=(e,t)=>{if(w(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new d(e.common.issues);return this._error=t,this._error}}};function S(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:a,description:n}=e;if(t&&(r||a))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{let{message:i}=e;return"invalid_enum_value"===t.code?{message:i??n.defaultError}:void 0===n.data?{message:i??a??n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:i??r??n.defaultError}},description:n}}class I{get description(){return this._def.description}_getType(e){return u(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:u(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new m,ctx:{common:e.parent.common,data:e.data,parsedType:u(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(k(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:u(e)},a=this._parseSync({data:e,path:r.path,parent:r});return x(r,a)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:u(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return w(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>w(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:u(e)},a=this._parse({data:e,path:r.path,parent:r});return x(r,await (k(a)?a:Promise.resolve(a)))}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,a)=>{let n=e(t),i=()=>a.addIssue({code:c.custom,...r(t)});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(i(),!1)):!!n||(i(),!1)})}refinement(e,t){return this._refinement((r,a)=>!!e(r)||(a.addIssue("function"==typeof t?t(r,a):t),!1))}_refinement(e){return new e_({schema:this,typeName:s.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return eb.create(this,this._def)}nullable(){return ew.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return er.create(this)}promise(){return ev.create(this,this._def)}or(e){return en.create([this,e],this._def)}and(e){return eo.create(this,e,this._def)}transform(e){return new e_({...S(this._def),schema:this,typeName:s.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ek({...S(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:s.ZodDefault})}brand(){return new eS({typeName:s.ZodBranded,type:this,...S(this._def)})}catch(e){return new eT({...S(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:s.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return eI.create(this,e)}readonly(){return eA.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let A=/^c[^\s-]{8,}$/i,E=/^[0-9a-z]+$/,O=/^[0-9A-HJKMNP-TV-Z]{26}$/i,R=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,P=/^[a-z0-9_-]{21}$/i,$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,C=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,j=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,N=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Z=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,z=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,F=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,M=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,U=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,L="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",D=RegExp(`^${L}$`);function q(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}class B extends I{_parse(e){var t,r,n,i;let s;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==l.string){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.string,received:t.parsedType}),y}let u=new m;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(f(s=this._getOrReturnCtx(e,s),{code:c.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),u.dirty());else if("max"===l.kind)e.data.length>l.value&&(f(s=this._getOrReturnCtx(e,s),{code:c.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),u.dirty());else if("length"===l.kind){let t=e.data.length>l.value,r=e.data.length<l.value;(t||r)&&(s=this._getOrReturnCtx(e,s),t?f(s,{code:c.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):r&&f(s,{code:c.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),u.dirty())}else if("email"===l.kind)j.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"email",code:c.invalid_string,message:l.message}),u.dirty());else if("emoji"===l.kind)o||(o=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),o.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"emoji",code:c.invalid_string,message:l.message}),u.dirty());else if("uuid"===l.kind)R.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"uuid",code:c.invalid_string,message:l.message}),u.dirty());else if("nanoid"===l.kind)P.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"nanoid",code:c.invalid_string,message:l.message}),u.dirty());else if("cuid"===l.kind)A.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"cuid",code:c.invalid_string,message:l.message}),u.dirty());else if("cuid2"===l.kind)E.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"cuid2",code:c.invalid_string,message:l.message}),u.dirty());else if("ulid"===l.kind)O.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"ulid",code:c.invalid_string,message:l.message}),u.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{f(s=this._getOrReturnCtx(e,s),{validation:"url",code:c.invalid_string,message:l.message}),u.dirty()}else"regex"===l.kind?(l.regex.lastIndex=0,l.regex.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"regex",code:c.invalid_string,message:l.message}),u.dirty())):"trim"===l.kind?e.data=e.data.trim():"includes"===l.kind?e.data.includes(l.value,l.position)||(f(s=this._getOrReturnCtx(e,s),{code:c.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),u.dirty()):"toLowerCase"===l.kind?e.data=e.data.toLowerCase():"toUpperCase"===l.kind?e.data=e.data.toUpperCase():"startsWith"===l.kind?e.data.startsWith(l.value)||(f(s=this._getOrReturnCtx(e,s),{code:c.invalid_string,validation:{startsWith:l.value},message:l.message}),u.dirty()):"endsWith"===l.kind?e.data.endsWith(l.value)||(f(s=this._getOrReturnCtx(e,s),{code:c.invalid_string,validation:{endsWith:l.value},message:l.message}),u.dirty()):"datetime"===l.kind?(function(e){let t=`${L}T${q(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)})(l).test(e.data)||(f(s=this._getOrReturnCtx(e,s),{code:c.invalid_string,validation:"datetime",message:l.message}),u.dirty()):"date"===l.kind?D.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{code:c.invalid_string,validation:"date",message:l.message}),u.dirty()):"time"===l.kind?RegExp(`^${q(l)}$`).test(e.data)||(f(s=this._getOrReturnCtx(e,s),{code:c.invalid_string,validation:"time",message:l.message}),u.dirty()):"duration"===l.kind?C.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"duration",code:c.invalid_string,message:l.message}),u.dirty()):"ip"===l.kind?(t=e.data,("v4"===(r=l.version)||!r)&&N.test(t)||("v6"===r||!r)&&z.test(t)||(f(s=this._getOrReturnCtx(e,s),{validation:"ip",code:c.invalid_string,message:l.message}),u.dirty())):"jwt"===l.kind?!function(e,t){if(!$.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(a));if("object"!=typeof n||null===n||"typ"in n&&n?.typ!=="JWT"||!n.alg||t&&n.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(f(s=this._getOrReturnCtx(e,s),{validation:"jwt",code:c.invalid_string,message:l.message}),u.dirty()):"cidr"===l.kind?(n=e.data,("v4"===(i=l.version)||!i)&&Z.test(n)||("v6"===i||!i)&&F.test(n)||(f(s=this._getOrReturnCtx(e,s),{validation:"cidr",code:c.invalid_string,message:l.message}),u.dirty())):"base64"===l.kind?M.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"base64",code:c.invalid_string,message:l.message}),u.dirty()):"base64url"===l.kind?U.test(e.data)||(f(s=this._getOrReturnCtx(e,s),{validation:"base64url",code:c.invalid_string,message:l.message}),u.dirty()):a.assertNever(l);return{status:u.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:c.invalid_string,...i.errToObj(r)})}_addCheck(e){return new B({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...i.errToObj(e)})}url(e){return this._addCheck({kind:"url",...i.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...i.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...i.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...i.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...i.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...i.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...i.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...i.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...i.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...i.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...i.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...i.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...i.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...i.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...i.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...i.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...i.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...i.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...i.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...i.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...i.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...i.errToObj(t)})}nonempty(e){return this.min(1,i.errToObj(e))}trim(){return new B({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new B({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new B({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}B.create=e=>new B({checks:[],typeName:s.ZodString,coerce:e?.coerce??!1,...S(e)});class V extends I{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==l.number){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.number,received:t.parsedType}),y}let r=new m;for(let n of this._def.checks)"int"===n.kind?a.isInteger(e.data)||(f(t=this._getOrReturnCtx(e,t),{code:c.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(f(t=this._getOrReturnCtx(e,t),{code:c.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(f(t=this._getOrReturnCtx(e,t),{code:c.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a;return Number.parseInt(e.toFixed(n).replace(".",""))%Number.parseInt(t.toFixed(n).replace(".",""))/10**n}(e.data,n.value)&&(f(t=this._getOrReturnCtx(e,t),{code:c.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(f(t=this._getOrReturnCtx(e,t),{code:c.not_finite,message:n.message}),r.dirty()):a.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.toString(t))}setLimit(e,t,r,a){return new V({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.toString(a)}]})}_addCheck(e){return new V({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:i.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:i.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:i.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:i.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:i.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:i.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:i.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:i.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&a.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}V.create=e=>new V({checks:[],typeName:s.ZodNumber,coerce:e?.coerce||!1,...S(e)});class K extends I{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==l.bigint)return this._getInvalidInput(e);let r=new m;for(let n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(f(t=this._getOrReturnCtx(e,t),{code:c.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(f(t=this._getOrReturnCtx(e,t),{code:c.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(f(t=this._getOrReturnCtx(e,t),{code:c.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):a.assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.bigint,received:t.parsedType}),y}gte(e,t){return this.setLimit("min",e,!0,i.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.toString(t))}setLimit(e,t,r,a){return new K({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.toString(a)}]})}_addCheck(e){return new K({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:i.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:i.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:i.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:i.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}K.create=e=>new K({checks:[],typeName:s.ZodBigInt,coerce:e?.coerce??!1,...S(e)});class W extends I{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==l.boolean){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.boolean,received:t.parsedType}),y}return v(e.data)}}W.create=e=>new W({typeName:s.ZodBoolean,coerce:e?.coerce||!1,...S(e)});class G extends I{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==l.date){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.date,received:t.parsedType}),y}if(Number.isNaN(e.data.getTime()))return f(this._getOrReturnCtx(e),{code:c.invalid_date}),y;let r=new m;for(let n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(f(t=this._getOrReturnCtx(e,t),{code:c.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(f(t=this._getOrReturnCtx(e,t),{code:c.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):a.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new G({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:i.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:i.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}G.create=e=>new G({checks:[],coerce:e?.coerce||!1,typeName:s.ZodDate,...S(e)});class J extends I{_parse(e){if(this._getType(e)!==l.symbol){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.symbol,received:t.parsedType}),y}return v(e.data)}}J.create=e=>new J({typeName:s.ZodSymbol,...S(e)});class H extends I{_parse(e){if(this._getType(e)!==l.undefined){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.undefined,received:t.parsedType}),y}return v(e.data)}}H.create=e=>new H({typeName:s.ZodUndefined,...S(e)});class X extends I{_parse(e){if(this._getType(e)!==l.null){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.null,received:t.parsedType}),y}return v(e.data)}}X.create=e=>new X({typeName:s.ZodNull,...S(e)});class Y extends I{constructor(){super(...arguments),this._any=!0}_parse(e){return v(e.data)}}Y.create=e=>new Y({typeName:s.ZodAny,...S(e)});class Q extends I{constructor(){super(...arguments),this._unknown=!0}_parse(e){return v(e.data)}}Q.create=e=>new Q({typeName:s.ZodUnknown,...S(e)});class ee extends I{_parse(e){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.never,received:t.parsedType}),y}}ee.create=e=>new ee({typeName:s.ZodNever,...S(e)});class et extends I{_parse(e){if(this._getType(e)!==l.undefined){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.void,received:t.parsedType}),y}return v(e.data)}}et.create=e=>new et({typeName:s.ZodVoid,...S(e)});class er extends I{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==l.array)return f(t,{code:c.invalid_type,expected:l.array,received:t.parsedType}),y;if(null!==a.exactLength){let e=t.data.length>a.exactLength.value,n=t.data.length<a.exactLength.value;(e||n)&&(f(t,{code:e?c.too_big:c.too_small,minimum:n?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&(f(t,{code:c.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&(f(t,{code:c.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>a.type._parseAsync(new T(t,e,t.path,r)))).then(e=>m.mergeArray(r,e));let n=[...t.data].map((e,r)=>a.type._parseSync(new T(t,e,t.path,r)));return m.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new er({...this._def,minLength:{value:e,message:i.toString(t)}})}max(e,t){return new er({...this._def,maxLength:{value:e,message:i.toString(t)}})}length(e,t){return new er({...this._def,exactLength:{value:e,message:i.toString(t)}})}nonempty(e){return this.min(1,e)}}er.create=(e,t)=>new er({type:e,minLength:null,maxLength:null,exactLength:null,typeName:s.ZodArray,...S(t)});class ea extends I{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=a.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==l.object){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.object,received:t.parsedType}),y}let{status:t,ctx:r}=this._processInputParams(e),{shape:a,keys:n}=this._getCached(),i=[];if(!(this._def.catchall instanceof ee&&"strip"===this._def.unknownKeys))for(let e in r.data)n.includes(e)||i.push(e);let s=[];for(let e of n){let t=a[e],n=r.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new T(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof ee){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of i)s.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)i.length>0&&(f(r,{code:c.unrecognized_keys,keys:i}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of i){let a=r.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new T(r,a,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of s){let r=await t.key,a=await t.value;e.push({key:r,value:a,alwaysSet:t.alwaysSet})}return e}).then(e=>m.mergeObjectSync(t,e)):m.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return i.errToObj,new ea({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let a=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:i.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new ea({...this._def,unknownKeys:"strip"})}passthrough(){return new ea({...this._def,unknownKeys:"passthrough"})}extend(e){return new ea({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ea({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:s.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ea({...this._def,catchall:e})}pick(e){let t={};for(let r of a.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new ea({...this._def,shape:()=>t})}omit(e){let t={};for(let r of a.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new ea({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof ea){let r={};for(let a in t.shape){let n=t.shape[a];r[a]=eb.create(e(n))}return new ea({...t._def,shape:()=>r})}return t instanceof er?new er({...t._def,type:e(t.element)}):t instanceof eb?eb.create(e(t.unwrap())):t instanceof ew?ew.create(e(t.unwrap())):t instanceof el?el.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};for(let r of a.objectKeys(this.shape)){let a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new ea({...this._def,shape:()=>t})}required(e){let t={};for(let r of a.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof eb;)e=e._def.innerType;t[r]=e}return new ea({...this._def,shape:()=>t})}keyof(){return em(a.objectKeys(this.shape))}}ea.create=(e,t)=>new ea({shape:()=>e,unknownKeys:"strip",catchall:ee.create(),typeName:s.ZodObject,...S(t)}),ea.strictCreate=(e,t)=>new ea({shape:()=>e,unknownKeys:"strict",catchall:ee.create(),typeName:s.ZodObject,...S(t)}),ea.lazycreate=(e,t)=>new ea({shape:e,unknownKeys:"strip",catchall:ee.create(),typeName:s.ZodObject,...S(t)});class en extends I{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new d(e.ctx.common.issues));return f(t,{code:c.invalid_union,unionErrors:r}),y});{let e;let a=[];for(let n of r){let r={...t,common:{...t.common,issues:[]},parent:null},i=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&a.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let n=a.map(e=>new d(e));return f(t,{code:c.invalid_union,unionErrors:n}),y}}get options(){return this._def.options}}en.create=(e,t)=>new en({options:e,typeName:s.ZodUnion,...S(t)});let ei=e=>{if(e instanceof ep)return ei(e.schema);if(e instanceof e_)return ei(e.innerType());if(e instanceof ef)return[e.value];if(e instanceof ey)return e.options;if(e instanceof eg)return a.objectValues(e.enum);if(e instanceof ek)return ei(e._def.innerType);if(e instanceof H)return[void 0];else if(e instanceof X)return[null];else if(e instanceof eb)return[void 0,...ei(e.unwrap())];else if(e instanceof ew)return[null,...ei(e.unwrap())];else if(e instanceof eS)return ei(e.unwrap());else if(e instanceof eA)return ei(e.unwrap());else if(e instanceof eT)return ei(e._def.innerType);else return[]};class es extends I{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.object)return f(t,{code:c.invalid_type,expected:l.object,received:t.parsedType}),y;let r=this.discriminator,a=t.data[r],n=this.optionsMap.get(a);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(f(t,{code:c.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),y)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let a=new Map;for(let r of t){let t=ei(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let n of t){if(a.has(n))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);a.set(n,r)}}return new es({typeName:s.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...S(r)})}}class eo extends I{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(_(e)||_(n))return y;let i=function e(t,r){let n=u(t),i=u(r);if(t===r)return{valid:!0,data:t};if(n===l.object&&i===l.object){let n=a.objectKeys(r),i=a.objectKeys(t).filter(e=>-1!==n.indexOf(e)),s={...t,...r};for(let a of i){let n=e(t[a],r[a]);if(!n.valid)return{valid:!1};s[a]=n.data}return{valid:!0,data:s}}if(n===l.array&&i===l.array){if(t.length!==r.length)return{valid:!1};let a=[];for(let n=0;n<t.length;n++){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1};a.push(i.data)}return{valid:!0,data:a}}return n===l.date&&i===l.date&&+t==+r?{valid:!0,data:t}:{valid:!1}}(e.value,n.value);return i.valid?((b(e)||b(n))&&t.dirty(),{status:t.value,value:i.data}):(f(r,{code:c.invalid_intersection_types}),y)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}eo.create=(e,t,r)=>new eo({left:e,right:t,typeName:s.ZodIntersection,...S(r)});class el extends I{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.array)return f(r,{code:c.invalid_type,expected:l.array,received:r.parsedType}),y;if(r.data.length<this._def.items.length)return f(r,{code:c.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),y;!this._def.rest&&r.data.length>this._def.items.length&&(f(r,{code:c.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let a=[...r.data].map((e,t)=>{let a=this._def.items[t]||this._def.rest;return a?a._parse(new T(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(a).then(e=>m.mergeArray(t,e)):m.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new el({...this._def,rest:e})}}el.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new el({items:e,typeName:s.ZodTuple,rest:null,...S(t)})};class eu extends I{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.object)return f(r,{code:c.invalid_type,expected:l.object,received:r.parsedType}),y;let a=[],n=this._def.keyType,i=this._def.valueType;for(let e in r.data)a.push({key:n._parse(new T(r,e,r.path,e)),value:i._parse(new T(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?m.mergeObjectAsync(t,a):m.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return new eu(t instanceof I?{keyType:e,valueType:t,typeName:s.ZodRecord,...S(r)}:{keyType:B.create(),valueType:e,typeName:s.ZodRecord,...S(t)})}}class ec extends I{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.map)return f(r,{code:c.invalid_type,expected:l.map,received:r.parsedType}),y;let a=this._def.keyType,n=this._def.valueType,i=[...r.data.entries()].map(([e,t],i)=>({key:a._parse(new T(r,e,r.path,[i,"key"])),value:n._parse(new T(r,t,r.path,[i,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of i){let a=await r.key,n=await r.value;if("aborted"===a.status||"aborted"===n.status)return y;("dirty"===a.status||"dirty"===n.status)&&t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of i){let a=r.key,n=r.value;if("aborted"===a.status||"aborted"===n.status)return y;("dirty"===a.status||"dirty"===n.status)&&t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}}}}ec.create=(e,t,r)=>new ec({valueType:t,keyType:e,typeName:s.ZodMap,...S(r)});class ed extends I{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.set)return f(r,{code:c.invalid_type,expected:l.set,received:r.parsedType}),y;let a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&(f(r,{code:c.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&(f(r,{code:c.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());let n=this._def.valueType;function i(e){let r=new Set;for(let a of e){if("aborted"===a.status)return y;"dirty"===a.status&&t.dirty(),r.add(a.value)}return{status:t.value,value:r}}let s=[...r.data.values()].map((e,t)=>n._parse(new T(r,e,r.path,t)));return r.common.async?Promise.all(s).then(e=>i(e)):i(s)}min(e,t){return new ed({...this._def,minSize:{value:e,message:i.toString(t)}})}max(e,t){return new ed({...this._def,maxSize:{value:e,message:i.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ed.create=(e,t)=>new ed({valueType:e,minSize:null,maxSize:null,typeName:s.ZodSet,...S(t)});class eh extends I{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.function)return f(t,{code:c.invalid_type,expected:l.function,received:t.parsedType}),y;function r(e,r){return p({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,h,h].filter(e=>!!e),issueData:{code:c.invalid_arguments,argumentsError:r}})}function a(e,r){return p({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,h,h].filter(e=>!!e),issueData:{code:c.invalid_return_type,returnTypeError:r}})}let n={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof ev){let e=this;return v(async function(...t){let s=new d([]),o=await e._def.args.parseAsync(t,n).catch(e=>{throw s.addIssue(r(t,e)),s}),l=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(l,n).catch(e=>{throw s.addIssue(a(l,e)),s})})}{let e=this;return v(function(...t){let s=e._def.args.safeParse(t,n);if(!s.success)throw new d([r(t,s.error)]);let o=Reflect.apply(i,this,s.data),l=e._def.returns.safeParse(o,n);if(!l.success)throw new d([a(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new eh({...this._def,args:el.create(e).rest(Q.create())})}returns(e){return new eh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new eh({args:e||el.create([]).rest(Q.create()),returns:t||Q.create(),typeName:s.ZodFunction,...S(r)})}}class ep extends I{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ep.create=(e,t)=>new ep({getter:e,typeName:s.ZodLazy,...S(t)});class ef extends I{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return f(t,{received:t.data,code:c.invalid_literal,expected:this._def.value}),y}return{status:"valid",value:e.data}}get value(){return this._def.value}}function em(e,t){return new ey({values:e,typeName:s.ZodEnum,...S(t)})}ef.create=(e,t)=>new ef({value:e,typeName:s.ZodLiteral,...S(t)});class ey extends I{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return f(t,{expected:a.joinValues(r),received:t.parsedType,code:c.invalid_type}),y}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return f(t,{received:t.data,code:c.invalid_enum_value,options:r}),y}return v(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ey.create(e,{...this._def,...t})}exclude(e,t=this._def){return ey.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}ey.create=em;class eg extends I{_parse(e){let t=a.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==l.string&&r.parsedType!==l.number){let e=a.objectValues(t);return f(r,{expected:a.joinValues(e),received:r.parsedType,code:c.invalid_type}),y}if(this._cache||(this._cache=new Set(a.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=a.objectValues(t);return f(r,{received:r.data,code:c.invalid_enum_value,options:e}),y}return v(e.data)}get enum(){return this._def.values}}eg.create=(e,t)=>new eg({values:e,typeName:s.ZodNativeEnum,...S(t)});class ev extends I{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==l.promise&&!1===t.common.async?(f(t,{code:c.invalid_type,expected:l.promise,received:t.parsedType}),y):v((t.parsedType===l.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}ev.create=(e,t)=>new ev({type:e,typeName:s.ZodPromise,...S(t)});class e_ extends I{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===s.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:e=>{f(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===n.type){let e=n.transform(r.data,i);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return y;let a=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===a.status?y:"dirty"===a.status||"dirty"===t.value?g(a.value):a});{if("aborted"===t.value)return y;let a=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===a.status?y:"dirty"===a.status||"dirty"===t.value?g(a.value):a}}if("refinement"===n.type){let e=e=>{let t=n.refinement(e,i);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?y:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?y:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}}if("transform"===n.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>w(e)?Promise.resolve(n.transform(e.value,i)).then(e=>({status:t.value,value:e})):y);{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!w(e))return y;let a=n.transform(e.value,i);if(a instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}}a.assertNever(n)}}e_.create=(e,t,r)=>new e_({schema:e,typeName:s.ZodEffects,effect:t,...S(r)}),e_.createWithPreprocess=(e,t,r)=>new e_({schema:t,effect:{type:"preprocess",transform:e},typeName:s.ZodEffects,...S(r)});class eb extends I{_parse(e){return this._getType(e)===l.undefined?v(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eb.create=(e,t)=>new eb({innerType:e,typeName:s.ZodOptional,...S(t)});class ew extends I{_parse(e){return this._getType(e)===l.null?v(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ew.create=(e,t)=>new ew({innerType:e,typeName:s.ZodNullable,...S(t)});class ek extends I{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===l.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ek.create=(e,t)=>new ek({innerType:e,typeName:s.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...S(t)});class eT extends I{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return k(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new d(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new d(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}eT.create=(e,t)=>new eT({innerType:e,typeName:s.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...S(t)});class ex extends I{_parse(e){if(this._getType(e)!==l.nan){let t=this._getOrReturnCtx(e);return f(t,{code:c.invalid_type,expected:l.nan,received:t.parsedType}),y}return{status:"valid",value:e.data}}}ex.create=e=>new ex({typeName:s.ZodNaN,...S(e)}),Symbol("zod_brand");class eS extends I{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class eI extends I{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?y:"dirty"===e.status?(t.dirty(),g(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?y:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new eI({in:e,out:t,typeName:s.ZodPipeline})}}class eA extends I{_parse(e){let t=this._def.innerType._parse(e),r=e=>(w(e)&&(e.value=Object.freeze(e.value)),e);return k(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}eA.create=(e,t)=>new eA({innerType:e,typeName:s.ZodReadonly,...S(t)}),ea.lazycreate,function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(s||(s={}));let eE=B.create,eO=V.create;ex.create,K.create;let eR=W.create;G.create,J.create,H.create,X.create,Y.create,Q.create,ee.create,et.create;let eP=er.create,e$=ea.create;ea.strictCreate;let eC=en.create;es.create,eo.create,el.create,eu.create,ec.create,ed.create,eh.create,ep.create,ef.create;let ej=ey.create;eg.create,ev.create,e_.create,eb.create,ew.create,e_.createWithPreprocess,eI.create},2574:(e,t,r)=>{"use strict";r.d(t,{Qc:()=>l,Vw:()=>u,As:()=>c,X9:()=>d});var a=r(1777),n=r(2478),i=r(4764);let s=(e,t)=>{n.h1.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>n.Z(e,t)},flatten:{value:t=>n.MK(e,t)},addIssue:{value:t=>e.issues.push(t)},addIssues:{value:t=>e.issues.push(...t)},isEmpty:{get:()=>0===e.issues.length}})};i.IF("ZodError",s);let o=i.IF("ZodError",s,{Parent:Error}),l=a.lk(o),u=a.T2(o),c=a.Yn(o),d=a.G(o)},9411:(e,t,r)=>{"use strict";r.d(t,{o4:()=>tv,Yj:()=>tW,IX:()=>tQ,O7:()=>tq,PG:()=>r_,VK:()=>t6,Km:()=>rt,Pp:()=>rb,Vo:()=>rg,i0:()=>ra,Fi:()=>tX,lB:()=>tV,Rx:()=>tM,Ry:()=>t1,IM:()=>t7,cf:()=>t4,Z_:()=>tg,G0:()=>t9,_4:()=>tJ});var a=r(4764);let n=/^[cC][^\s-]{8,}$/,i=/^[0-9a-z]+$/,s=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,o=/^[0-9a-vA-V]{20}$/,l=/^[A-Za-z0-9]{27}$/,u=/^[a-zA-Z0-9_-]{21}$/,c=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,d=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,h=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,p=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,f=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,m=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,y=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,g=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,v=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,_=/^[A-Za-z0-9_-]*$/,b=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,w=/^\+(?:[0-9]){6,14}[0-9]$/,k="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",T=RegExp(`^${k}$`);function x(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}let S=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},I=/^\d+$/,A=/^-?\d+(?:\.\d+)?/i,E=/true|false/i,O=/null/i,R=/^[^A-Z]*$/,P=/^[^a-z]*$/;var $=r(7232);let C=a.IF("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),j={number:"number",bigint:"bigint",object:"date"},N=a.IF("$ZodCheckLessThan",(e,t)=>{C.init(e,t);let r=j[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,a=(t.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<a&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=a=>{(t.inclusive?a.value<=t.value:a.value<t.value)||a.issues.push({origin:r,code:"too_big",maximum:t.value,input:a.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Z=a.IF("$ZodCheckGreaterThan",(e,t)=>{C.init(e,t);let r=j[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,a=(t.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>a&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=a=>{(t.inclusive?a.value>=t.value:a.value>t.value)||a.issues.push({origin:r,code:"too_small",minimum:t.value,input:a.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),z=a.IF("$ZodCheckMultipleOf",(e,t)=>{C.init(e,t),e._zod.onattach.push(e=>{var r;(r=e._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof r.value?r.value%t.value===BigInt(0):0===$.k8(r.value,t.value))||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),F=a.IF("$ZodCheckNumberFormat",(e,t)=>{C.init(e,t),t.format=t.format||"float64";let r=t.format?.includes("int"),a=r?"int":"number",[n,i]=$.Fl[t.format];e._zod.onattach.push(e=>{let a=e._zod.bag;a.format=t.format,a.minimum=n,a.maximum=i,r&&(a.pattern=I)}),e._zod.check=s=>{let o=s.value;if(r){if(!Number.isInteger(o)){s.issues.push({expected:a,format:t.format,code:"invalid_type",input:o,inst:e});return}if(!Number.isSafeInteger(o)){o>0?s.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:a,continue:!t.abort}):s.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:a,continue:!t.abort});return}}o<n&&s.issues.push({origin:"number",input:o,code:"too_small",minimum:n,inclusive:!0,inst:e,continue:!t.abort}),o>i&&s.issues.push({origin:"number",input:o,code:"too_big",maximum:i,inst:e})}}),M=a.IF("$ZodCheckMaxLength",(e,t)=>{var r;C.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!$.NZ(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let a=r.value;if(a.length<=t.maximum)return;let n=$.XU(a);r.issues.push({origin:n,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),U=a.IF("$ZodCheckMinLength",(e,t)=>{var r;C.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!$.NZ(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let a=r.value;if(a.length>=t.minimum)return;let n=$.XU(a);r.issues.push({origin:n,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),L=a.IF("$ZodCheckLengthEquals",(e,t)=>{var r;C.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!$.NZ(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=r=>{let a=r.value,n=a.length;if(n===t.length)return;let i=$.XU(a),s=n>t.length;r.issues.push({origin:i,...s?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),D=a.IF("$ZodCheckStringFormat",(e,t)=>{var r,a;C.init(e,t),e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,t.pattern&&(r.patterns??(r.patterns=new Set),r.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(a=e._zod).check??(a.check=()=>{})}),q=a.IF("$ZodCheckRegex",(e,t)=>{D.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),B=a.IF("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=R),D.init(e,t)}),V=a.IF("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=P),D.init(e,t)}),K=a.IF("$ZodCheckIncludes",(e,t)=>{C.init(e,t);let r=$.yI(t.includes),a=new RegExp("number"==typeof t.position?`^.{${t.position}}${r}`:r);t.pattern=a,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(a)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),W=a.IF("$ZodCheckStartsWith",(e,t)=>{C.init(e,t);let r=RegExp(`^${$.yI(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),G=a.IF("$ZodCheckEndsWith",(e,t)=>{C.init(e,t);let r=RegExp(`.*${$.yI(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),J=a.IF("$ZodCheckOverwrite",(e,t)=>{C.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class H{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),r=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(r)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}var X=r(1777);let Y={major:4,minor:0,patch:0},Q=a.IF("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Y;let n=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&n.unshift(e),n))for(let r of t._zod.onattach)r(e);if(0===n.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let n,i=$.Ko(e);for(let s of t){if(s._zod.def.when){if(!s._zod.def.when(e))continue}else if(i)continue;let t=e.issues.length,o=s._zod.check(e);if(o instanceof Promise&&r?.async===!1)throw new a.TG;if(n||o instanceof Promise)n=(n??Promise.resolve()).then(async()=>{await o,e.issues.length===t||i||(i=$.Ko(e,t))});else{if(e.issues.length===t)continue;i||(i=$.Ko(e,t))}}return n?n.then(()=>e):e};e._zod.run=(r,i)=>{let s=e._zod.parse(r,i);if(s instanceof Promise){if(!1===i.async)throw new a.TG;return s.then(e=>t(e,n,i))}return t(s,n,i)}}e["~standard"]={validate:t=>{try{let r=(0,X.As)(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return(0,X.X9)(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}}),ee=a.IF("$ZodString",(e,t)=>{Q.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??S(e._zod.bag),e._zod.parse=(r,a)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}return"string"==typeof r.value||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),et=a.IF("$ZodStringFormat",(e,t)=>{D.init(e,t),ee.init(e,t)}),er=a.IF("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=d),et.init(e,t)}),ea=a.IF("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=h(e))}else t.pattern??(t.pattern=h());et.init(e,t)}),en=a.IF("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=p),et.init(e,t)}),ei=a.IF("$ZodURL",(e,t)=>{et.init(e,t),e._zod.check=r=>{try{let a=r.value,n=new URL(a),i=n.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(n.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:b.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(n.protocol.endsWith(":")?n.protocol.slice(0,-1):n.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),!a.endsWith("/")&&i.endsWith("/")?r.value=i.slice(0,-1):r.value=i;return}catch(a){r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),es=a.IF("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),et.init(e,t)}),eo=a.IF("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=u),et.init(e,t)}),el=a.IF("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=n),et.init(e,t)}),eu=a.IF("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=i),et.init(e,t)}),ec=a.IF("$ZodULID",(e,t)=>{t.pattern??(t.pattern=s),et.init(e,t)}),ed=a.IF("$ZodXID",(e,t)=>{t.pattern??(t.pattern=o),et.init(e,t)}),eh=a.IF("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=l),et.init(e,t)}),ep=a.IF("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=function(e){let t=x({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-]\\d{2}:\\d{2})");let a=`${t}(?:${r.join("|")})`;return RegExp(`^${k}T(?:${a})$`)}(t)),et.init(e,t)}),ef=a.IF("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=T),et.init(e,t)}),em=a.IF("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=RegExp(`^${x(t)}$`)),et.init(e,t)}),ey=a.IF("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=c),et.init(e,t)}),eg=a.IF("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=f),et.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv4"})}),ev=a.IF("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=m),et.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),e_=a.IF("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=y),et.init(e,t)}),eb=a.IF("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=g),et.init(e,t),e._zod.check=r=>{let[a,n]=r.value.split("/");try{if(!n)throw Error();let e=Number(n);if(`${e}`!==n||e<0||e>128)throw Error();new URL(`http://[${a}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function ew(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}let ek=a.IF("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=v),et.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{ew(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}}),eT=a.IF("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=_),et.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{!function(e){if(!_.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return ew(t.padEnd(4*Math.ceil(t.length/4),"="))}(r.value)&&r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),ex=a.IF("$ZodE164",(e,t)=>{t.pattern??(t.pattern=w),et.init(e,t)}),eS=a.IF("$ZodJWT",(e,t)=>{et.init(e,t),e._zod.check=r=>{!function(e,t=null){try{let r=e.split(".");if(3!==r.length)return!1;let[a]=r;if(!a)return!1;let n=JSON.parse(atob(a));if("typ"in n&&n?.typ!=="JWT"||!n.alg||t&&(!("alg"in n)||n.alg!==t))return!1;return!0}catch{return!1}}(r.value,t.alg)&&r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),eI=a.IF("$ZodNumber",(e,t)=>{Q.init(e,t),e._zod.pattern=e._zod.bag.pattern??A,e._zod.parse=(r,a)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let n=r.value;if("number"==typeof n&&!Number.isNaN(n)&&Number.isFinite(n))return r;let i="number"==typeof n?Number.isNaN(n)?"NaN":Number.isFinite(n)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:n,inst:e,...i?{received:i}:{}}),r}}),eA=a.IF("$ZodNumber",(e,t)=>{F.init(e,t),eI.init(e,t)}),eE=a.IF("$ZodBoolean",(e,t)=>{Q.init(e,t),e._zod.pattern=E,e._zod.parse=(r,a)=>{if(t.coerce)try{r.value=!!r.value}catch(e){}let n=r.value;return"boolean"==typeof n||r.issues.push({expected:"boolean",code:"invalid_type",input:n,inst:e}),r}}),eO=a.IF("$ZodNull",(e,t)=>{Q.init(e,t),e._zod.pattern=O,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let a=t.value;return null===a||t.issues.push({expected:"null",code:"invalid_type",input:a,inst:e}),t}}),eR=a.IF("$ZodAny",(e,t)=>{Q.init(e,t),e._zod.parse=e=>e}),eP=a.IF("$ZodUnknown",(e,t)=>{Q.init(e,t),e._zod.parse=e=>e}),e$=a.IF("$ZodNever",(e,t)=>{Q.init(e,t),e._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)});function eC(e,t,r){e.issues.length&&t.issues.push(...$.Cr(r,e.issues)),t.value[r]=e.value}let ej=a.IF("$ZodArray",(e,t)=>{Q.init(e,t),e._zod.parse=(r,a)=>{let n=r.value;if(!Array.isArray(n))return r.issues.push({expected:"array",code:"invalid_type",input:n,inst:e}),r;r.value=Array(n.length);let i=[];for(let e=0;e<n.length;e++){let s=n[e],o=t.element._zod.run({value:s,issues:[]},a);o instanceof Promise?i.push(o.then(t=>eC(t,r,e))):eC(o,r,e)}return i.length?Promise.all(i).then(()=>r):r}});function eN(e,t,r){e.issues.length&&t.issues.push(...$.Cr(r,e.issues)),t.value[r]=e.value}function eZ(e,t,r,a){e.issues.length?void 0===a[r]?r in a?t.value[r]=void 0:t.value[r]=e.value:t.issues.push(...$.Cr(r,e.issues)):void 0===e.value?r in a&&(t.value[r]=void 0):t.value[r]=e.value}let ez=a.IF("$ZodObject",(e,t)=>{let r,n;Q.init(e,t);let i=$.HX(()=>{let e=Object.keys(t.shape);for(let r of e)if(!(t.shape[r]instanceof Q))throw Error(`Invalid element at key "${r}": expected a Zod schema`);let r=$.bX(t.shape);return{shape:t.shape,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(r)}});$.To(e._zod,"propValues",()=>{let e=t.shape,r={};for(let t in e){let a=e[t]._zod;if(a.values)for(let e of(r[t]??(r[t]=new Set),a.values))r[t].add(e)}return r});let s=e=>{let t=new H(["shape","payload","ctx"]),r=i.value,a=e=>{let t=$.v_(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let n=Object.create(null),s=0;for(let e of r.keys)n[e]=`key_${s++}`;for(let e of(t.write("const newResult = {}"),r.keys))if(r.optionalKeys.has(e)){let r=n[e];t.write(`const ${r} = ${a(e)};`);let i=$.v_(e);t.write(`
        if (${r}.issues.length) {
          if (input[${i}] === undefined) {
            if (${i} in input) {
              newResult[${i}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${r}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${i}, ...iss.path] : [${i}],
              }))
            );
          }
        } else if (${r}.value === undefined) {
          if (${i} in input) newResult[${i}] = undefined;
        } else {
          newResult[${i}] = ${r}.value;
        }
        `)}else{let r=n[e];t.write(`const ${r} = ${a(e)};`),t.write(`
          if (${r}.issues.length) payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${$.v_(e)}, ...iss.path] : [${$.v_(e)}]
          })));`),t.write(`newResult[${$.v_(e)}] = ${r}.value`)}t.write("payload.value = newResult;"),t.write("return payload;");let o=t.compile();return(t,r)=>o(e,t,r)},o=$.Kn,l=!a.w6.jitless,u=$.k1,c=l&&u.value,d=t.catchall;e._zod.parse=(a,u)=>{n??(n=i.value);let h=a.value;if(!o(h))return a.issues.push({expected:"object",code:"invalid_type",input:h,inst:e}),a;let p=[];if(l&&c&&u?.async===!1&&!0!==u.jitless)r||(r=s(t.shape)),a=r(a,u);else{a.value={};let e=n.shape;for(let t of n.keys){let r=e[t],n=r._zod.run({value:h[t],issues:[]},u),i="optional"===r._zod.optin&&"optional"===r._zod.optout;n instanceof Promise?p.push(n.then(e=>i?eZ(e,a,t,h):eN(e,a,t))):i?eZ(n,a,t,h):eN(n,a,t)}}if(!d)return p.length?Promise.all(p).then(()=>a):a;let f=[],m=n.keySet,y=d._zod,g=y.def.type;for(let e of Object.keys(h)){if(m.has(e))continue;if("never"===g){f.push(e);continue}let t=y.run({value:h[e],issues:[]},u);t instanceof Promise?p.push(t.then(t=>eN(t,a,e))):eN(t,a,e)}return(f.length&&a.issues.push({code:"unrecognized_keys",keys:f,input:h,inst:e}),p.length)?Promise.all(p).then(()=>a):a}});function eF(e,t,r,n){for(let r of e)if(0===r.issues.length)return t.value=r.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>$.G$(e,n,a.vc())))}),t}let eM=a.IF("$ZodUnion",(e,t)=>{Q.init(e,t),$.To(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),$.To(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),$.To(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),$.To(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>$.ZA(e.source)).join("|")})$`)}}),e._zod.parse=(r,a)=>{let n=!1,i=[];for(let e of t.options){let t=e._zod.run({value:r.value,issues:[]},a);if(t instanceof Promise)i.push(t),n=!0;else{if(0===t.issues.length)return t;i.push(t)}}return n?Promise.all(i).then(t=>eF(t,r,e,a)):eF(i,r,e,a)}}),eU=a.IF("$ZodDiscriminatedUnion",(e,t)=>{eM.init(e,t);let r=e._zod.parse;$.To(e._zod,"propValues",()=>{let e={};for(let r of t.options){let a=r._zod.propValues;if(!a||0===Object.keys(a).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let[t,r]of Object.entries(a))for(let a of(e[t]||(e[t]=new Set),r))e[t].add(a)}return e});let a=$.HX(()=>{let e=t.options,r=new Map;for(let a of e){let e=a._zod.propValues[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(a)}"`);for(let t of e){if(r.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);r.set(t,a)}}return r});e._zod.parse=(n,i)=>{let s=n.value;if(!$.Kn(s))return n.issues.push({code:"invalid_type",expected:"object",input:s,inst:e}),n;let o=a.value.get(s?.[t.discriminator]);return o?o._zod.run(n,i):t.unionFallback?r(n,i):(n.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:s,path:[t.discriminator],inst:e}),n)}}),eL=a.IF("$ZodIntersection",(e,t)=>{Q.init(e,t),e._zod.parse=(e,r)=>{let a=e.value,n=t.left._zod.run({value:a,issues:[]},r),i=t.right._zod.run({value:a,issues:[]},r);return n instanceof Promise||i instanceof Promise?Promise.all([n,i]).then(([t,r])=>eD(e,t,r)):eD(e,n,i)}});function eD(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),$.Ko(e))return e;let a=function e(t,r){if(t===r||t instanceof Date&&r instanceof Date&&+t==+r)return{valid:!0,data:t};if($.PO(t)&&$.PO(r)){let a=Object.keys(r),n=Object.keys(t).filter(e=>-1!==a.indexOf(e)),i={...t,...r};for(let a of n){let n=e(t[a],r[a]);if(!n.valid)return{valid:!1,mergeErrorPath:[a,...n.mergeErrorPath]};i[a]=n.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return{valid:!1,mergeErrorPath:[]};let a=[];for(let n=0;n<t.length;n++){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};a.push(i.data)}return{valid:!0,data:a}}return{valid:!1,mergeErrorPath:[]}}(t.value,r.value);if(!a.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(a.mergeErrorPath)}`);return e.value=a.data,e}let eq=a.IF("$ZodRecord",(e,t)=>{Q.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!$.PO(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:e}),r;let s=[];if(t.keyType._zod.values){let a;let o=t.keyType._zod.values;for(let e of(r.value={},o))if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){let a=t.valueType._zod.run({value:i[e],issues:[]},n);a instanceof Promise?s.push(a.then(t=>{t.issues.length&&r.issues.push(...$.Cr(e,t.issues)),r.value[e]=t.value})):(a.issues.length&&r.issues.push(...$.Cr(e,a.issues)),r.value[e]=a.value)}for(let e in i)o.has(e)||(a=a??[]).push(e);a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:i,inst:e,keys:a})}else for(let o of(r.value={},Reflect.ownKeys(i))){if("__proto__"===o)continue;let l=t.keyType._zod.run({value:o,issues:[]},n);if(l instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(l.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:l.issues.map(e=>$.G$(e,n,a.vc())),input:o,path:[o],inst:e}),r.value[l.value]=l.value;continue}let u=t.valueType._zod.run({value:i[o],issues:[]},n);u instanceof Promise?s.push(u.then(e=>{e.issues.length&&r.issues.push(...$.Cr(o,e.issues)),r.value[l.value]=e.value})):(u.issues.length&&r.issues.push(...$.Cr(o,u.issues)),r.value[l.value]=u.value)}return s.length?Promise.all(s).then(()=>r):r}}),eB=a.IF("$ZodEnum",(e,t)=>{Q.init(e,t);let r=$.B8(t.entries);e._zod.values=new Set(r),e._zod.pattern=RegExp(`^(${r.filter(e=>$.A0.has(typeof e)).map(e=>"string"==typeof e?$.yI(e):e.toString()).join("|")})$`),e._zod.parse=(t,a)=>{let n=t.value;return e._zod.values.has(n)||t.issues.push({code:"invalid_value",values:r,input:n,inst:e}),t}}),eV=a.IF("$ZodLiteral",(e,t)=>{Q.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?$.yI(e):e?e.toString():String(e)).join("|")})$`),e._zod.parse=(r,a)=>{let n=r.value;return e._zod.values.has(n)||r.issues.push({code:"invalid_value",values:t.values,input:n,inst:e}),r}}),eK=a.IF("$ZodTransform",(e,t)=>{Q.init(e,t),e._zod.parse=(e,r)=>{let n=t.transform(e.value,e);if(r.async)return(n instanceof Promise?n:Promise.resolve(n)).then(t=>(e.value=t,e));if(n instanceof Promise)throw new a.TG;return e.value=n,e}}),eW=a.IF("$ZodOptional",(e,t)=>{Q.init(e,t),e._zod.optin="optional",e._zod.optout="optional",$.To(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),$.To(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${$.ZA(e.source)})?$`):void 0}),e._zod.parse=(e,r)=>"optional"===t.innerType._zod.optin?t.innerType._zod.run(e,r):void 0===e.value?e:t.innerType._zod.run(e,r)}),eG=a.IF("$ZodNullable",(e,t)=>{Q.init(e,t),$.To(e._zod,"optin",()=>t.innerType._zod.optin),$.To(e._zod,"optout",()=>t.innerType._zod.optout),$.To(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${$.ZA(e.source)}|null)$`):void 0}),$.To(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,r)=>null===e.value?e:t.innerType._zod.run(e,r)}),eJ=a.IF("$ZodDefault",(e,t)=>{Q.init(e,t),e._zod.optin="optional",$.To(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if(void 0===e.value)return e.value=t.defaultValue,e;let a=t.innerType._zod.run(e,r);return a instanceof Promise?a.then(e=>eH(e,t)):eH(a,t)}});function eH(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}let eX=a.IF("$ZodPrefault",(e,t)=>{Q.init(e,t),e._zod.optin="optional",$.To(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>(void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),eY=a.IF("$ZodNonOptional",(e,t)=>{Q.init(e,t),$.To(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(r,a)=>{let n=t.innerType._zod.run(r,a);return n instanceof Promise?n.then(t=>eQ(t,e)):eQ(n,e)}});function eQ(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}let e0=a.IF("$ZodCatch",(e,t)=>{Q.init(e,t),e._zod.optin="optional",$.To(e._zod,"optout",()=>t.innerType._zod.optout),$.To(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(n=>(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>$.G$(e,r,a.vc()))},input:e.value}),e.issues=[]),e)):(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>$.G$(e,r,a.vc()))},input:e.value}),e.issues=[]),e)}}),e1=a.IF("$ZodPipe",(e,t)=>{Q.init(e,t),$.To(e._zod,"values",()=>t.in._zod.values),$.To(e._zod,"optin",()=>t.in._zod.optin),$.To(e._zod,"optout",()=>t.out._zod.optout),e._zod.parse=(e,r)=>{let a=t.in._zod.run(e,r);return a instanceof Promise?a.then(e=>e4(e,t,r)):e4(a,t,r)}});function e4(e,t,r){return $.Ko(e)?e:t.out._zod.run({value:e.value,issues:e.issues},r)}let e2=a.IF("$ZodReadonly",(e,t)=>{Q.init(e,t),$.To(e._zod,"propValues",()=>t.innerType._zod.propValues),$.To(e._zod,"values",()=>t.innerType._zod.values),$.To(e._zod,"optin",()=>t.innerType._zod.optin),$.To(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(e,r)=>{let a=t.innerType._zod.run(e,r);return a instanceof Promise?a.then(e9):e9(a)}});function e9(e){return e.value=Object.freeze(e.value),e}let e3=a.IF("$ZodLazy",(e,t)=>{Q.init(e,t),$.To(e._zod,"innerType",()=>t.getter()),$.To(e._zod,"pattern",()=>e._zod.innerType._zod.pattern),$.To(e._zod,"propValues",()=>e._zod.innerType._zod.propValues),$.To(e._zod,"optin",()=>e._zod.innerType._zod.optin),$.To(e._zod,"optout",()=>e._zod.innerType._zod.optout),e._zod.parse=(t,r)=>e._zod.innerType._zod.run(t,r)}),e6=a.IF("$ZodCustom",(e,t)=>{C.init(e,t),Q.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=r=>{let a=r.value,n=t.fn(a);if(n instanceof Promise)return n.then(t=>e5(t,r,a,e));e5(n,r,a,e)}});function e5(e,t,r,a){if(!e){let e={code:"custom",input:r,inst:a,path:[...a._zod.def.path??[]],continue:!a._zod.def.abort};a._zod.def.params&&(e.params=a._zod.def.params),t.issues.push($.Q_(e))}}var e8=r(8325);function e7(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...$.de(t)})}function te(e,t){return new N({check:"less_than",...$.de(t),value:e,inclusive:!1})}function tt(e,t){return new N({check:"less_than",...$.de(t),value:e,inclusive:!0})}function tr(e,t){return new Z({check:"greater_than",...$.de(t),value:e,inclusive:!1})}function ta(e,t){return new Z({check:"greater_than",...$.de(t),value:e,inclusive:!0})}function tn(e,t){return new z({check:"multiple_of",...$.de(t),value:e})}function ti(e,t){return new M({check:"max_length",...$.de(t),maximum:e})}function ts(e,t){return new U({check:"min_length",...$.de(t),minimum:e})}function to(e,t){return new L({check:"length_equals",...$.de(t),length:e})}function tl(e){return new J({check:"overwrite",tx:e})}let tu=a.IF("ZodISODateTime",(e,t)=>{ep.init(e,t),tv.init(e,t)}),tc=a.IF("ZodISODate",(e,t)=>{ef.init(e,t),tv.init(e,t)}),td=a.IF("ZodISOTime",(e,t)=>{em.init(e,t),tv.init(e,t)}),th=a.IF("ZodISODuration",(e,t)=>{ey.init(e,t),tv.init(e,t)});var tp=r(2574);let tf=a.IF("ZodType",(e,t)=>(Q.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]}),e.clone=(t,r)=>$.d9(e,t,r),e.brand=()=>e,e.register=(t,r)=>(t.add(e,r),e),e.parse=(t,r)=>tp.Qc(e,t,r,{callee:e.parse}),e.safeParse=(t,r)=>tp.As(e,t,r),e.parseAsync=async(t,r)=>tp.Vw(e,t,r,{callee:e.parseAsync}),e.safeParseAsync=async(t,r)=>tp.X9(e,t,r),e.spa=e.safeParseAsync,e.refine=(t,r)=>e.check(function(e,t={}){return new rv({type:"custom",check:"custom",fn:e,...$.de(t)})}(t,r)),e.superRefine=t=>e.check(function(e){let t=function(e){let t=new C({check:"custom"});return t._zod.check=e,t}(r=>(r.addIssue=e=>{"string"==typeof e?r.issues.push($.Q_(e,r.value,t._zod.def)):(e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=r.value),e.inst??(e.inst=t),e.continue??(e.continue=!t._zod.def.abort),r.issues.push($.Q_(e)))},e(r.value,r)));return t}(t)),e.overwrite=t=>e.check(tl(t)),e.optional=()=>rs(e),e.nullable=()=>rl(e),e.nullish=()=>rs(rl(e)),e.nonoptional=t=>new rd({type:"nonoptional",innerType:e,...$.de(t)}),e.array=()=>tQ(e),e.or=t=>t9([e,t]),e.and=t=>new t5({type:"intersection",left:e,right:t}),e.transform=t=>rf(e,new rn({type:"transform",transform:t})),e.default=t=>(function(e,t){return new ru({type:"default",innerType:e,get defaultValue(){return"function"==typeof t?t():t}})})(e,t),e.prefault=t=>(function(e,t){return new rc({type:"prefault",innerType:e,get defaultValue(){return"function"==typeof t?t():t}})})(e,t),e.catch=t=>(function(e,t){return new rh({type:"catch",innerType:e,catchValue:"function"==typeof t?t:()=>t})})(e,t),e.pipe=t=>rf(e,t),e.readonly=()=>new rm({type:"readonly",innerType:e}),e.describe=t=>{let r=e.clone();return e8.$Z.add(r,{description:t}),r},Object.defineProperty(e,"description",{get:()=>e8.$Z.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return e8.$Z.get(e);let r=e.clone();return e8.$Z.add(r,t[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),tm=a.IF("_ZodString",(e,t)=>{ee.init(e,t),tf.init(e,t);let r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new q({check:"string_format",format:"regex",...$.de(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new K({check:"string_format",format:"includes",...$.de(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new W({check:"string_format",format:"starts_with",...$.de(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new G({check:"string_format",format:"ends_with",...$.de(t),suffix:e})}(...t)),e.min=(...t)=>e.check(ts(...t)),e.max=(...t)=>e.check(ti(...t)),e.length=(...t)=>e.check(to(...t)),e.nonempty=(...t)=>e.check(ts(1,...t)),e.lowercase=t=>e.check(new B({check:"string_format",format:"lowercase",...$.de(t)})),e.uppercase=t=>e.check(new V({check:"string_format",format:"uppercase",...$.de(t)})),e.trim=()=>e.check(tl(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return tl(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(tl(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(tl(e=>e.toUpperCase()))}),ty=a.IF("ZodString",(e,t)=>{ee.init(e,t),tm.init(e,t),e.email=t=>e.check(new t_({type:"string",format:"email",check:"string_format",abort:!1,...$.de(t)})),e.url=t=>e.check(new tk({type:"string",format:"url",check:"string_format",abort:!1,...$.de(t)})),e.jwt=t=>e.check(new tz({type:"string",format:"jwt",check:"string_format",abort:!1,...$.de(t)})),e.emoji=t=>e.check(new tT({type:"string",format:"emoji",check:"string_format",abort:!1,...$.de(t)})),e.guid=t=>e.check(e7(tb,t)),e.uuid=t=>e.check(new tw({type:"string",format:"uuid",check:"string_format",abort:!1,...$.de(t)})),e.uuidv4=t=>e.check(new tw({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...$.de(t)})),e.uuidv6=t=>e.check(new tw({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...$.de(t)})),e.uuidv7=t=>e.check(new tw({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...$.de(t)})),e.nanoid=t=>e.check(new tx({type:"string",format:"nanoid",check:"string_format",abort:!1,...$.de(t)})),e.guid=t=>e.check(e7(tb,t)),e.cuid=t=>e.check(new tS({type:"string",format:"cuid",check:"string_format",abort:!1,...$.de(t)})),e.cuid2=t=>e.check(new tI({type:"string",format:"cuid2",check:"string_format",abort:!1,...$.de(t)})),e.ulid=t=>e.check(new tA({type:"string",format:"ulid",check:"string_format",abort:!1,...$.de(t)})),e.base64=t=>e.check(new tj({type:"string",format:"base64",check:"string_format",abort:!1,...$.de(t)})),e.base64url=t=>e.check(new tN({type:"string",format:"base64url",check:"string_format",abort:!1,...$.de(t)})),e.xid=t=>e.check(new tE({type:"string",format:"xid",check:"string_format",abort:!1,...$.de(t)})),e.ksuid=t=>e.check(new tO({type:"string",format:"ksuid",check:"string_format",abort:!1,...$.de(t)})),e.ipv4=t=>e.check(new tR({type:"string",format:"ipv4",check:"string_format",abort:!1,...$.de(t)})),e.ipv6=t=>e.check(new tP({type:"string",format:"ipv6",check:"string_format",abort:!1,...$.de(t)})),e.cidrv4=t=>e.check(new t$({type:"string",format:"cidrv4",check:"string_format",abort:!1,...$.de(t)})),e.cidrv6=t=>e.check(new tC({type:"string",format:"cidrv6",check:"string_format",abort:!1,...$.de(t)})),e.e164=t=>e.check(new tZ({type:"string",format:"e164",check:"string_format",abort:!1,...$.de(t)})),e.datetime=t=>{var r;return e.check((r=t,new tu({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...$.de(r)})))},e.date=t=>{var r;return e.check((r=t,new tc({type:"string",format:"date",check:"string_format",...$.de(r)})))},e.time=t=>{var r;return e.check((r=t,new td({type:"string",format:"time",check:"string_format",precision:null,...$.de(r)})))},e.duration=t=>{var r;return e.check((r=t,new th({type:"string",format:"duration",check:"string_format",...$.de(r)})))}});function tg(e){return new ty({type:"string",...$.de(e)})}let tv=a.IF("ZodStringFormat",(e,t)=>{et.init(e,t),tm.init(e,t)}),t_=a.IF("ZodEmail",(e,t)=>{en.init(e,t),tv.init(e,t)}),tb=a.IF("ZodGUID",(e,t)=>{er.init(e,t),tv.init(e,t)}),tw=a.IF("ZodUUID",(e,t)=>{ea.init(e,t),tv.init(e,t)}),tk=a.IF("ZodURL",(e,t)=>{ei.init(e,t),tv.init(e,t)}),tT=a.IF("ZodEmoji",(e,t)=>{es.init(e,t),tv.init(e,t)}),tx=a.IF("ZodNanoID",(e,t)=>{eo.init(e,t),tv.init(e,t)}),tS=a.IF("ZodCUID",(e,t)=>{el.init(e,t),tv.init(e,t)}),tI=a.IF("ZodCUID2",(e,t)=>{eu.init(e,t),tv.init(e,t)}),tA=a.IF("ZodULID",(e,t)=>{ec.init(e,t),tv.init(e,t)}),tE=a.IF("ZodXID",(e,t)=>{ed.init(e,t),tv.init(e,t)}),tO=a.IF("ZodKSUID",(e,t)=>{eh.init(e,t),tv.init(e,t)}),tR=a.IF("ZodIPv4",(e,t)=>{eg.init(e,t),tv.init(e,t)}),tP=a.IF("ZodIPv6",(e,t)=>{ev.init(e,t),tv.init(e,t)}),t$=a.IF("ZodCIDRv4",(e,t)=>{e_.init(e,t),tv.init(e,t)}),tC=a.IF("ZodCIDRv6",(e,t)=>{eb.init(e,t),tv.init(e,t)}),tj=a.IF("ZodBase64",(e,t)=>{ek.init(e,t),tv.init(e,t)}),tN=a.IF("ZodBase64URL",(e,t)=>{eT.init(e,t),tv.init(e,t)}),tZ=a.IF("ZodE164",(e,t)=>{ex.init(e,t),tv.init(e,t)}),tz=a.IF("ZodJWT",(e,t)=>{eS.init(e,t),tv.init(e,t)}),tF=a.IF("ZodNumber",(e,t)=>{eI.init(e,t),tf.init(e,t),e.gt=(t,r)=>e.check(tr(t,r)),e.gte=(t,r)=>e.check(ta(t,r)),e.min=(t,r)=>e.check(ta(t,r)),e.lt=(t,r)=>e.check(te(t,r)),e.lte=(t,r)=>e.check(tt(t,r)),e.max=(t,r)=>e.check(tt(t,r)),e.int=t=>e.check(tL(t)),e.safe=t=>e.check(tL(t)),e.positive=t=>e.check(tr(0,t)),e.nonnegative=t=>e.check(ta(0,t)),e.negative=t=>e.check(te(0,t)),e.nonpositive=t=>e.check(tt(0,t)),e.multipleOf=(t,r)=>e.check(tn(t,r)),e.step=(t,r)=>e.check(tn(t,r)),e.finite=()=>e;let r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function tM(e){return new tF({type:"number",checks:[],...$.de(e)})}let tU=a.IF("ZodNumberFormat",(e,t)=>{eA.init(e,t),tF.init(e,t)});function tL(e){return new tU({type:"number",check:"number_format",abort:!1,format:"safeint",...$.de(e)})}let tD=a.IF("ZodBoolean",(e,t)=>{eE.init(e,t),tf.init(e,t)});function tq(e){return new tD({type:"boolean",...$.de(e)})}let tB=a.IF("ZodNull",(e,t)=>{eO.init(e,t),tf.init(e,t)});function tV(e){return new tB({type:"null",...$.de(e)})}let tK=a.IF("ZodAny",(e,t)=>{eR.init(e,t),tf.init(e,t)});function tW(){return new tK({type:"any"})}let tG=a.IF("ZodUnknown",(e,t)=>{eP.init(e,t),tf.init(e,t)});function tJ(){return new tG({type:"unknown"})}let tH=a.IF("ZodNever",(e,t)=>{e$.init(e,t),tf.init(e,t)});function tX(e){return new tH({type:"never",...$.de(e)})}let tY=a.IF("ZodArray",(e,t)=>{ej.init(e,t),tf.init(e,t),e.element=t.element,e.min=(t,r)=>e.check(ts(t,r)),e.nonempty=t=>e.check(ts(1,t)),e.max=(t,r)=>e.check(ti(t,r)),e.length=(t,r)=>e.check(to(t,r)),e.unwrap=()=>e.element});function tQ(e,t){return new tY({type:"array",element:e,...$.de(t)})}let t0=a.IF("ZodObject",(e,t)=>{ez.init(e,t),tf.init(e,t),$.To(e,"shape",()=>t.shape),e.keyof=()=>rt(Object.keys(e._zod.def.shape)),e.catchall=t=>e.clone({...e._zod.def,catchall:t}),e.passthrough=()=>e.clone({...e._zod.def,catchall:tJ()}),e.loose=()=>e.clone({...e._zod.def,catchall:tJ()}),e.strict=()=>e.clone({...e._zod.def,catchall:tX()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=t=>$.l7(e,t),e.merge=t=>$.TS(e,t),e.pick=t=>$.ei(e,t),e.omit=t=>$.CE(e,t),e.partial=(...t)=>$.r$(ri,e,t[0]),e.required=(...t)=>$.C1(rd,e,t[0])});function t1(e,t){return new t0({type:"object",get shape(){return $.DW(this,"shape",{...e}),this.shape},...$.de(t)})}function t4(e,t){return new t0({type:"object",get shape(){return $.DW(this,"shape",{...e}),this.shape},catchall:tX(),...$.de(t)})}let t2=a.IF("ZodUnion",(e,t)=>{eM.init(e,t),tf.init(e,t),e.options=t.options});function t9(e,t){return new t2({type:"union",options:e,...$.de(t)})}let t3=a.IF("ZodDiscriminatedUnion",(e,t)=>{t2.init(e,t),eU.init(e,t)});function t6(e,t,r){return new t3({type:"union",options:t,discriminator:e,...$.de(r)})}let t5=a.IF("ZodIntersection",(e,t)=>{eL.init(e,t),tf.init(e,t)}),t8=a.IF("ZodRecord",(e,t)=>{eq.init(e,t),tf.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function t7(e,t,r){return new t8({type:"record",keyType:e,valueType:t,...$.de(r)})}let re=a.IF("ZodEnum",(e,t)=>{eB.init(e,t),tf.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);let r=new Set(Object.keys(t.entries));e.extract=(e,a)=>{let n={};for(let a of e)if(r.has(a))n[a]=t.entries[a];else throw Error(`Key ${a} not found in enum`);return new re({...t,checks:[],...$.de(a),entries:n})},e.exclude=(e,a)=>{let n={...t.entries};for(let t of e)if(r.has(t))delete n[t];else throw Error(`Key ${t} not found in enum`);return new re({...t,checks:[],...$.de(a),entries:n})}});function rt(e,t){return new re({type:"enum",entries:Array.isArray(e)?Object.fromEntries(e.map(e=>[e,e])):e,...$.de(t)})}let rr=a.IF("ZodLiteral",(e,t)=>{eV.init(e,t),tf.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function ra(e,t){return new rr({type:"literal",values:Array.isArray(e)?e:[e],...$.de(t)})}let rn=a.IF("ZodTransform",(e,t)=>{eK.init(e,t),tf.init(e,t),e._zod.parse=(r,a)=>{r.addIssue=a=>{"string"==typeof a?r.issues.push($.Q_(a,r.value,t)):(a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=e),a.continue??(a.continue=!0),r.issues.push($.Q_(a)))};let n=t.transform(r.value,r);return n instanceof Promise?n.then(e=>(r.value=e,r)):(r.value=n,r)}}),ri=a.IF("ZodOptional",(e,t)=>{eW.init(e,t),tf.init(e,t),e.unwrap=()=>e._zod.def.innerType});function rs(e){return new ri({type:"optional",innerType:e})}let ro=a.IF("ZodNullable",(e,t)=>{eG.init(e,t),tf.init(e,t),e.unwrap=()=>e._zod.def.innerType});function rl(e){return new ro({type:"nullable",innerType:e})}let ru=a.IF("ZodDefault",(e,t)=>{eJ.init(e,t),tf.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),rc=a.IF("ZodPrefault",(e,t)=>{eX.init(e,t),tf.init(e,t),e.unwrap=()=>e._zod.def.innerType}),rd=a.IF("ZodNonOptional",(e,t)=>{eY.init(e,t),tf.init(e,t),e.unwrap=()=>e._zod.def.innerType}),rh=a.IF("ZodCatch",(e,t)=>{e0.init(e,t),tf.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),rp=a.IF("ZodPipe",(e,t)=>{e1.init(e,t),tf.init(e,t),e.in=t.in,e.out=t.out});function rf(e,t){return new rp({type:"pipe",in:e,out:t})}let rm=a.IF("ZodReadonly",(e,t)=>{e2.init(e,t),tf.init(e,t)}),ry=a.IF("ZodLazy",(e,t)=>{e3.init(e,t),tf.init(e,t),e.unwrap=()=>e._zod.def.getter()});function rg(e){return new ry({type:"lazy",getter:e})}let rv=a.IF("ZodCustom",(e,t)=>{e6.init(e,t),tf.init(e,t)});function r_(e,t){return function(e,t,r){let a=$.de(r);return a.abort??(a.abort=!0),new e({type:"custom",check:"custom",fn:t,...a})}(rv,e??(()=>!0),t)}function rb(e,t={error:`Input not instance of ${e.name}`}){let r=new rv({type:"custom",check:"custom",fn:t=>t instanceof e,abort:!0,...$.de(t)});return r._zod.bag.Class=e,r}},4764:(e,t,r)=>{"use strict";function a(e,t,r){function a(r,a){var n;for(let i in Object.defineProperty(r,"_zod",{value:r._zod??{},enumerable:!1}),(n=r._zod).traits??(n.traits=new Set),r._zod.traits.add(e),t(r,a),s.prototype)i in r||Object.defineProperty(r,i,{value:s.prototype[i].bind(r)});r._zod.constr=s,r._zod.def=a}let n=r?.Parent??Object;class i extends n{}function s(e){var t;let n=r?.Parent?new i:this;for(let r of(a(n,e),(t=n._zod).deferred??(t.deferred=[]),n._zod.deferred))r();return n}return Object.defineProperty(i,"name",{value:e}),Object.defineProperty(s,"init",{value:a}),Object.defineProperty(s,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(s,"name",{value:e}),s}r.d(t,{IF:()=>a,TG:()=>n,vc:()=>s,w6:()=>i}),Object.freeze({status:"aborted"}),Symbol("zod_brand");class n extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let i={};function s(e){return e&&Object.assign(i,e),i}},2478:(e,t,r)=>{"use strict";r.d(t,{MK:()=>l,Z:()=>u,h1:()=>s,qc:()=>o});var a=r(4764),n=r(7232);let i=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get:()=>JSON.stringify(t,n.$W,2),enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},s=(0,a.IF)("$ZodError",i),o=(0,a.IF)("$ZodError",i,{Parent:Error});function l(e,t=e=>e.message){let r={},a=[];for(let n of e.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(t(n))):a.push(t(n));return{formErrors:a,fieldErrors:r}}function u(e,t){let r=t||function(e){return e.message},a={_errors:[]},n=e=>{for(let t of e.issues)if("invalid_union"===t.code&&t.errors.length)t.errors.map(e=>n({issues:e}));else if("invalid_key"===t.code)n({issues:t.issues});else if("invalid_element"===t.code)n({issues:t.issues});else if(0===t.path.length)a._errors.push(r(t));else{let e=a,n=0;for(;n<t.path.length;){let a=t.path[n];n===t.path.length-1?(e[a]=e[a]||{_errors:[]},e[a]._errors.push(r(t))):e[a]=e[a]||{_errors:[]},e=e[a],n++}}};return n(e),a}},1777:(e,t,r)=>{"use strict";r.d(t,{As:()=>u,G:()=>c,T2:()=>o,X9:()=>d,Yn:()=>l,lk:()=>s});var a=r(4764),n=r(2478),i=r(7232);let s=e=>(t,r,n,s)=>{let o=n?Object.assign(n,{async:!1}):{async:!1},l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise)throw new a.TG;if(l.issues.length){let t=new(s?.Err??e)(l.issues.map(e=>i.G$(e,o,a.vc())));throw i.zw(t,s?.callee),t}return l.value};n.qc;let o=e=>async(t,r,n,s)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise&&(l=await l),l.issues.length){let t=new(s?.Err??e)(l.issues.map(e=>i.G$(e,o,a.vc())));throw i.zw(t,s?.callee),t}return l.value};n.qc;let l=e=>(t,r,s)=>{let o=s?{...s,async:!1}:{async:!1},l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise)throw new a.TG;return l.issues.length?{success:!1,error:new(e??n.h1)(l.issues.map(e=>i.G$(e,o,a.vc())))}:{success:!0,data:l.value}},u=l(n.qc),c=e=>async(t,r,n)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},o=t._zod.run({value:r,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(e=>i.G$(e,s,a.vc())))}:{success:!0,data:o.value}},d=c(n.qc)},8325:(e,t,r)=>{"use strict";r.d(t,{$Z:()=>n,EC:()=>a}),Symbol("ZodOutput"),Symbol("ZodInput");class a{constructor(){this._map=new Map,this._idmap=new Map}add(e,...t){let r=t[0];if(this._map.set(e,r),r&&"object"==typeof r&&"id"in r){if(this._idmap.has(r.id))throw Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let r={...this.get(t)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}let n=new a},8436:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});var a=r(8325),n=r(7232);class i{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??a.$Z,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,t={path:[],schemaPath:[]}){var r;let a=e._zod.def,i=this.seen.get(e);if(i)return i.count++,t.schemaPath.includes(e)&&(i.cycle=t.path),i.schema;let s={schema:{},count:1,cycle:void 0,path:t.path};this.seen.set(e,s);let o=e._zod.toJSONSchema?.();if(o)s.schema=o;else{let r={...t,schemaPath:[...t.schemaPath,e],path:t.path},i=e._zod.parent;if(i)s.ref=i,this.process(i,r),this.seen.get(i).isParent=!0;else{let t=s.schema;switch(a.type){case"string":{t.type="string";let{minimum:r,maximum:a,format:n,patterns:i,contentEncoding:o}=e._zod.bag;if("number"==typeof r&&(t.minLength=r),"number"==typeof a&&(t.maxLength=a),n&&(t.format=({guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""})[n]??n,""===t.format&&delete t.format),o&&(t.contentEncoding=o),i&&i.size>0){let e=[...i];1===e.length?t.pattern=e[0].source:e.length>1&&(s.schema.allOf=[...e.map(e=>({..."draft-7"===this.target?{type:"string"}:{},pattern:e.source}))])}break}case"number":{let{minimum:r,maximum:a,format:n,multipleOf:i,exclusiveMaximum:s,exclusiveMinimum:o}=e._zod.bag;"string"==typeof n&&n.includes("int")?t.type="integer":t.type="number","number"==typeof o&&(t.exclusiveMinimum=o),"number"==typeof r&&(t.minimum=r,"number"==typeof o&&(o>=r?delete t.minimum:delete t.exclusiveMinimum)),"number"==typeof s&&(t.exclusiveMaximum=s),"number"==typeof a&&(t.maximum=a,"number"==typeof s&&(s<=a?delete t.maximum:delete t.exclusiveMaximum)),"number"==typeof i&&(t.multipleOf=i);break}case"boolean":case"success":t.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw Error("Symbols cannot be represented in JSON Schema");break;case"null":t.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw Error("Void cannot be represented in JSON Schema");break;case"never":t.not={};break;case"date":if("throw"===this.unrepresentable)throw Error("Date cannot be represented in JSON Schema");break;case"array":{let{minimum:n,maximum:i}=e._zod.bag;"number"==typeof n&&(t.minItems=n),"number"==typeof i&&(t.maxItems=i),t.type="array",t.items=this.process(a.element,{...r,path:[...r.path,"items"]});break}case"object":{t.type="object",t.properties={};let e=a.shape;for(let a in e)t.properties[a]=this.process(e[a],{...r,path:[...r.path,"properties",a]});let n=new Set([...new Set(Object.keys(e))].filter(e=>{let t=a.shape[e]._zod;return"input"===this.io?void 0===t.optin:void 0===t.optout}));n.size>0&&(t.required=Array.from(n)),a.catchall?._zod.def.type==="never"?t.additionalProperties=!1:a.catchall?a.catchall&&(t.additionalProperties=this.process(a.catchall,{...r,path:[...r.path,"additionalProperties"]})):"output"===this.io&&(t.additionalProperties=!1);break}case"union":t.anyOf=a.options.map((e,t)=>this.process(e,{...r,path:[...r.path,"anyOf",t]}));break;case"intersection":{let e=this.process(a.left,{...r,path:[...r.path,"allOf",0]}),n=this.process(a.right,{...r,path:[...r.path,"allOf",1]}),i=[..."allOf"in e&&1===Object.keys(e).length?e.allOf:[e],..."allOf"in n&&1===Object.keys(n).length?n.allOf:[n]];t.allOf=i;break}case"tuple":{t.type="array";let n=a.items.map((e,t)=>this.process(e,{...r,path:[...r.path,"prefixItems",t]}));if("draft-2020-12"===this.target?t.prefixItems=n:t.items=n,a.rest){let e=this.process(a.rest,{...r,path:[...r.path,"items"]});"draft-2020-12"===this.target?t.items=e:t.additionalItems=e}a.rest&&(t.items=this.process(a.rest,{...r,path:[...r.path,"items"]}));let{minimum:i,maximum:s}=e._zod.bag;"number"==typeof i&&(t.minItems=i),"number"==typeof s&&(t.maxItems=s);break}case"record":t.type="object",t.propertyNames=this.process(a.keyType,{...r,path:[...r.path,"propertyNames"]}),t.additionalProperties=this.process(a.valueType,{...r,path:[...r.path,"additionalProperties"]});break;case"map":if("throw"===this.unrepresentable)throw Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw Error("Set cannot be represented in JSON Schema");break;case"enum":{let e=(0,n.B8)(a.entries);e.every(e=>"number"==typeof e)&&(t.type="number"),e.every(e=>"string"==typeof e)&&(t.type="string"),t.enum=e;break}case"literal":{let e=[];for(let t of a.values)if(void 0===t){if("throw"===this.unrepresentable)throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"==typeof t){if("throw"===this.unrepresentable)throw Error("BigInt literals cannot be represented in JSON Schema");e.push(Number(t))}else e.push(t);if(0===e.length);else if(1===e.length){let r=e[0];t.type=null===r?"null":typeof r,t.const=r}else e.every(e=>"number"==typeof e)&&(t.type="number"),e.every(e=>"string"==typeof e)&&(t.type="string"),e.every(e=>"boolean"==typeof e)&&(t.type="string"),e.every(e=>null===e)&&(t.type="null"),t.enum=e;break}case"file":{let r={type:"string",format:"binary",contentEncoding:"binary"},{minimum:a,maximum:n,mime:i}=e._zod.bag;void 0!==a&&(r.minLength=a),void 0!==n&&(r.maxLength=n),i?1===i.length?(r.contentMediaType=i[0],Object.assign(t,r)):t.anyOf=i.map(e=>({...r,contentMediaType:e})):Object.assign(t,r);break}case"transform":if("throw"===this.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema");break;case"nullable":{let e=this.process(a.innerType,r);t.anyOf=[e,{type:"null"}];break}case"nonoptional":case"promise":case"optional":this.process(a.innerType,r),s.ref=a.innerType;break;case"default":this.process(a.innerType,r),s.ref=a.innerType,t.default=JSON.parse(JSON.stringify(a.defaultValue));break;case"prefault":this.process(a.innerType,r),s.ref=a.innerType,"input"===this.io&&(t._prefault=JSON.parse(JSON.stringify(a.defaultValue)));break;case"catch":{let e;this.process(a.innerType,r),s.ref=a.innerType;try{e=a.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}t.default=e;break}case"nan":if("throw"===this.unrepresentable)throw Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{let r=e._zod.pattern;if(!r)throw Error("Pattern not found in template literal");t.type="string",t.pattern=r.source;break}case"pipe":{let e="input"===this.io?"transform"===a.in._zod.def.type?a.out:a.in:a.out;this.process(e,r),s.ref=e;break}case"readonly":this.process(a.innerType,r),s.ref=a.innerType,t.readOnly=!0;break;case"lazy":{let t=e._zod.innerType;this.process(t,r),s.ref=t;break}case"custom":if("throw"===this.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")}}}let l=this.metadataRegistry.get(e);return l&&Object.assign(s.schema,l),"input"===this.io&&function e(t,r){let a=r??{seen:new Set};if(a.seen.has(t))return!1;a.seen.add(t);let n=t._zod.def;switch(n.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return e(n.element,a);case"object":for(let t in n.shape)if(e(n.shape[t],a))return!0;return!1;case"union":for(let t of n.options)if(e(t,a))return!0;return!1;case"intersection":return e(n.left,a)||e(n.right,a);case"tuple":for(let t of n.items)if(e(t,a))return!0;if(n.rest&&e(n.rest,a))return!0;return!1;case"record":case"map":return e(n.keyType,a)||e(n.valueType,a);case"set":return e(n.valueType,a);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return e(n.innerType,a);case"lazy":return e(n.getter(),a);case"transform":return!0;case"pipe":return e(n.in,a)||e(n.out,a)}throw Error(`Unknown schema type: ${n.type}`)}(e)&&(delete s.schema.examples,delete s.schema.default),"input"===this.io&&s.schema._prefault&&((r=s.schema).default??(r.default=s.schema._prefault)),delete s.schema._prefault,this.seen.get(e).schema}emit(e,t){let r={cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0},a=this.seen.get(e);if(!a)throw Error("Unprocessed schema. This is a bug in Zod.");let n=e=>{let t="draft-2020-12"===this.target?"$defs":"definitions";if(r.external){let a=r.external.registry.get(e[0])?.id,n=r.external.uri??(e=>e);if(a)return{ref:n(a)};let i=e[1].defId??e[1].schema.id??`schema${this.counter++}`;return e[1].defId=i,{defId:i,ref:`${n("__shared")}#/${t}/${i}`}}if(e[1]===a)return{ref:"#"};let n=`#/${t}/`,i=e[1].schema.id??`__schema${this.counter++}`;return{defId:i,ref:n+i}},i=e=>{if(e[1].schema.$ref)return;let t=e[1],{ref:r,defId:a}=n(e);t.def={...t.schema},a&&(t.defId=a);let i=t.schema;for(let e in i)delete i[e];i.$ref=r};if("throw"===r.cycles)for(let e of this.seen.entries()){let t=e[1];if(t.cycle)throw Error(`Cycle detected: #/${t.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let t of this.seen.entries()){let a=t[1];if(e===t[0]){i(t);continue}if(r.external){let a=r.external.registry.get(t[0])?.id;if(e!==t[0]&&a){i(t);continue}}if(this.metadataRegistry.get(t[0])?.id||a.cycle||a.count>1&&"ref"===r.reused){i(t);continue}}let s=(e,t)=>{let r=this.seen.get(e),a=r.def??r.schema,n={...a};if(null===r.ref)return;let i=r.ref;if(r.ref=null,i){s(i,t);let e=this.seen.get(i).schema;e.$ref&&"draft-7"===t.target?(a.allOf=a.allOf??[],a.allOf.push(e)):(Object.assign(a,e),Object.assign(a,n))}r.isParent||this.override({zodSchema:e,jsonSchema:a,path:r.path??[]})};for(let e of[...this.seen.entries()].reverse())s(e[0],{target:this.target});let o={};if("draft-2020-12"===this.target?o.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?o.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),r.external?.uri){let t=r.external.registry.get(e)?.id;if(!t)throw Error("Schema is missing an `id` property");o.$id=r.external.uri(t)}Object.assign(o,a.def);let l=r.external?.defs??{};for(let e of this.seen.entries()){let t=e[1];t.def&&t.defId&&(l[t.defId]=t.def)}r.external||Object.keys(l).length>0&&("draft-2020-12"===this.target?o.$defs=l:o.definitions=l);try{return JSON.parse(JSON.stringify(o))}catch(e){throw Error("Error converting schema to JSON.")}}}function s(e,t){if(e instanceof a.EC){let r=new i(t),a={};for(let t of e._idmap.entries()){let[e,a]=t;r.process(a)}let n={},s={registry:e,uri:t?.uri,defs:a};for(let a of e._idmap.entries()){let[e,i]=a;n[e]=r.emit(i,{...t,external:s})}if(Object.keys(a).length>0){let e="draft-2020-12"===r.target?"$defs":"definitions";n.__shared={[e]:a}}return{schemas:n}}let r=new i(t);return r.process(e),r.emit(e,t)}},7232:(e,t,r)=>{"use strict";function a(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function n(e,t){return"bigint"==typeof t?t.toString():t}function i(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function s(e){return null==e}function o(e){let t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function l(e,t){let r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a;return Number.parseInt(e.toFixed(n).replace(".",""))%Number.parseInt(t.toFixed(n).replace(".",""))/10**n}function u(e,t,r){Object.defineProperty(e,t,{get(){{let a=r();return e[t]=a,a}},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function c(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function d(e){return JSON.stringify(e)}r.d(t,{$W:()=>n,A0:()=>y,B8:()=>a,C1:()=>A,CE:()=>T,Cr:()=>O,DW:()=>c,Fl:()=>w,G$:()=>P,HX:()=>i,Kn:()=>p,Ko:()=>E,NZ:()=>s,PO:()=>m,Q_:()=>C,TS:()=>S,To:()=>u,XU:()=>$,ZA:()=>o,bX:()=>b,d9:()=>v,de:()=>_,ei:()=>k,k1:()=>f,k8:()=>l,l7:()=>x,r$:()=>I,v_:()=>d,yI:()=>g,zw:()=>h});let h=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function p(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let f=i(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function m(e){if(!1===p(e))return!1;let t=e.constructor;if(void 0===t)return!0;let r=t.prototype;return!1!==p(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}let y=new Set(["string","number","symbol"]);function g(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(e,t,r){let a=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(a._zod.parent=e),a}function _(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function b(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let w={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function k(e,t){let r={},a=e._zod.def;for(let e in t){if(!(e in a.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&(r[e]=a.shape[e])}return v(e,{...e._zod.def,shape:r,checks:[]})}function T(e,t){let r={...e._zod.def.shape},a=e._zod.def;for(let e in t){if(!(e in a.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete r[e]}return v(e,{...e._zod.def,shape:r,checks:[]})}function x(e,t){if(!m(t))throw Error("Invalid input to extend: expected a plain object");let r={...e._zod.def,get shape(){let r={...e._zod.def.shape,...t};return c(this,"shape",r),r},checks:[]};return v(e,r)}function S(e,t){return v(e,{...e._zod.def,get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return c(this,"shape",r),r},catchall:t._zod.def.catchall,checks:[]})}function I(e,t,r){let a=t._zod.def.shape,n={...a};if(r)for(let t in r){if(!(t in a))throw Error(`Unrecognized key: "${t}"`);r[t]&&(n[t]=e?new e({type:"optional",innerType:a[t]}):a[t])}else for(let t in a)n[t]=e?new e({type:"optional",innerType:a[t]}):a[t];return v(t,{...t._zod.def,shape:n,checks:[]})}function A(e,t,r){let a=t._zod.def.shape,n={...a};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(n[t]=new e({type:"nonoptional",innerType:a[t]}))}else for(let t in a)n[t]=new e({type:"nonoptional",innerType:a[t]});return v(t,{...t._zod.def,shape:n,checks:[]})}function E(e,t=0){for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function O(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function R(e){return"string"==typeof e?e:e?.message}function P(e,t,r){let a={...e,path:e.path??[]};if(!e.message){let n=R(e.inst?._zod.def?.error?.(e))??R(t?.error?.(e))??R(r.customError?.(e))??R(r.localeError?.(e))??"Invalid input";a.message=n}return delete a.inst,delete a.continue,t?.reportInput||delete a.input,a}function $(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function C(...e){let[t,r,a]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:a}:{...t}}}};